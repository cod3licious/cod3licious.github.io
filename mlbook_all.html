<!DOCTYPE html>
<html lang="en">
<head>
<!-- with https://favicon.io/favicon-generator/  : Fira Code font -->
<link rel="apple-touch-icon" sizes="180x180" href="./assets/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./assets/favicon/favicon-16x16.png">
<link rel="manifest" href="./assets/favicon/site.webmanifest">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="author" content="Dr. Franziska Horn">
<meta name="copyright" content="Dr. Franziska Horn">
<title>A Practitioner&#8217;s Guide to Machine Learning</title>
<style>
@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css);

/* source-sans-pro-200 - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: normal;
  font-weight: 200;
  src: url('./assets/fonts/source-sans-pro-v18-latin-200.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-200.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-200.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-200.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-200.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-200.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-200italic - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: italic;
  font-weight: 200;
  src: url('./assets/fonts/source-sans-pro-v18-latin-200italic.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-200italic.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-200italic.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-200italic.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-200italic.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-200italic.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-300 - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: normal;
  font-weight: 300;
  src: url('./assets/fonts/source-sans-pro-v18-latin-300.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-300.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-300.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-300.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-300.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-300.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-300italic - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: italic;
  font-weight: 300;
  src: url('./assets/fonts/source-sans-pro-v18-latin-300italic.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-300italic.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-300italic.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-300italic.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-300italic.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-300italic.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-regular - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: normal;
  font-weight: 400;
  src: url('./assets/fonts/source-sans-pro-v18-latin-regular.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-regular.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-regular.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-regular.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-regular.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-regular.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-italic - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: italic;
  font-weight: 400;
  src: url('./assets/fonts/source-sans-pro-v18-latin-italic.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-italic.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-italic.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-italic.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-italic.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-italic.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-600 - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: normal;
  font-weight: 600;
  src: url('./assets/fonts/source-sans-pro-v18-latin-600.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-600.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-600.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-600.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-600.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-600.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-700 - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: normal;
  font-weight: 700;
  src: url('./assets/fonts/source-sans-pro-v18-latin-700.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-700.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-700.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-700.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-700.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-700.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-600italic - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: italic;
  font-weight: 600;
  src: url('./assets/fonts/source-sans-pro-v18-latin-600italic.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-600italic.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-600italic.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-600italic.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-600italic.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-600italic.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-700italic - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: italic;
  font-weight: 700;
  src: url('./assets/fonts/source-sans-pro-v18-latin-700italic.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-700italic.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-700italic.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-700italic.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-700italic.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-700italic.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-900 - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: normal;
  font-weight: 900;
  src: url('./assets/fonts/source-sans-pro-v18-latin-900.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-900.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-900.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-900.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-900.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-900.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}
/* source-sans-pro-900italic - latin */
@font-face {
  font-family: 'Source Sans Pro';
  font-style: italic;
  font-weight: 900;
  src: url('./assets/fonts/source-sans-pro-v18-latin-900italic.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/source-sans-pro-v18-latin-900italic.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/source-sans-pro-v18-latin-900italic.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-900italic.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/source-sans-pro-v18-latin-900italic.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/source-sans-pro-v18-latin-900italic.svg#SourceSansPro') format('svg'); /* Legacy iOS */
}


/* inconsolata-200 - latin */
@font-face {
  font-family: 'Inconsolata';
  font-style: normal;
  font-weight: 200;
  src: url('./assets/fonts/inconsolata-v21-latin-200.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/inconsolata-v21-latin-200.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/inconsolata-v21-latin-200.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-200.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-200.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/inconsolata-v21-latin-200.svg#Inconsolata') format('svg'); /* Legacy iOS */
}
/* inconsolata-300 - latin */
@font-face {
  font-family: 'Inconsolata';
  font-style: normal;
  font-weight: 300;
  src: url('./assets/fonts/inconsolata-v21-latin-300.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/inconsolata-v21-latin-300.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/inconsolata-v21-latin-300.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-300.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-300.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/inconsolata-v21-latin-300.svg#Inconsolata') format('svg'); /* Legacy iOS */
}
/* inconsolata-regular - latin */
@font-face {
  font-family: 'Inconsolata';
  font-style: normal;
  font-weight: 400;
  src: url('./assets/fonts/inconsolata-v21-latin-regular.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/inconsolata-v21-latin-regular.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/inconsolata-v21-latin-regular.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-regular.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-regular.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/inconsolata-v21-latin-regular.svg#Inconsolata') format('svg'); /* Legacy iOS */
}
/* inconsolata-500 - latin */
@font-face {
  font-family: 'Inconsolata';
  font-style: normal;
  font-weight: 500;
  src: url('./assets/fonts/inconsolata-v21-latin-500.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/inconsolata-v21-latin-500.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/inconsolata-v21-latin-500.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-500.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-500.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/inconsolata-v21-latin-500.svg#Inconsolata') format('svg'); /* Legacy iOS */
}
/* inconsolata-600 - latin */
@font-face {
  font-family: 'Inconsolata';
  font-style: normal;
  font-weight: 600;
  src: url('./assets/fonts/inconsolata-v21-latin-600.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/inconsolata-v21-latin-600.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/inconsolata-v21-latin-600.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-600.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-600.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/inconsolata-v21-latin-600.svg#Inconsolata') format('svg'); /* Legacy iOS */
}
/* inconsolata-700 - latin */
@font-face {
  font-family: 'Inconsolata';
  font-style: normal;
  font-weight: 700;
  src: url('./assets/fonts/inconsolata-v21-latin-700.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/inconsolata-v21-latin-700.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/inconsolata-v21-latin-700.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-700.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-700.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/inconsolata-v21-latin-700.svg#Inconsolata') format('svg'); /* Legacy iOS */
}
/* inconsolata-800 - latin */
@font-face {
  font-family: 'Inconsolata';
  font-style: normal;
  font-weight: 800;
  src: url('./assets/fonts/inconsolata-v21-latin-800.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/inconsolata-v21-latin-800.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/inconsolata-v21-latin-800.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-800.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-800.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/inconsolata-v21-latin-800.svg#Inconsolata') format('svg'); /* Legacy iOS */
}
/* inconsolata-900 - latin */
@font-face {
  font-family: 'Inconsolata';
  font-style: normal;
  font-weight: 900;
  src: url('./assets/fonts/inconsolata-v21-latin-900.eot'); /* IE9 Compat Modes */
  src: local(''),
       url('./assets/fonts/inconsolata-v21-latin-900.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
       url('./assets/fonts/inconsolata-v21-latin-900.woff2') format('woff2'), /* Super Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-900.woff') format('woff'), /* Modern Browsers */
       url('./assets/fonts/inconsolata-v21-latin-900.ttf') format('truetype'), /* Safari, Android, iOS */
       url('./assets/fonts/inconsolata-v21-latin-900.svg#Inconsolata') format('svg'); /* Legacy iOS */
}


/* normalize.css v2.1.1 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address styling not present in IE 8/9. */
[hidden] { display: none; }

/* ========================================================================== Base ========================================================================== */
/** 1. Prevent system color scheme's background color being used in Firefox, IE, and Opera. 2. Prevent system color scheme's text color being used in Firefox, IE, and Opera. 3. Set default font family to sans-serif. 4. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { background: #fff; /* 1 */ color: #000; /* 2 */ font-family: "Source Sans Pro", sans-serif; /* 3 */ -ms-text-size-adjust: 100%; /* 4 */ -webkit-text-size-adjust: 100%; /* 4 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: "Inconsolata", monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Source Sans Pro", sans-serif; font-weight: normal; font-style: normal; line-height: 1.4; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

a:focus { outline: none; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; text-align-last: center; padding: 0em 2em 0; line-height: 1.15;}

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.4; }

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title { text-align: inherit; }, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1; color: #6f6f6f; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #2ba6cb; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #2795b6; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.4; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.4; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Source Sans Pro", sans-serif; font-weight: bold; font-style: normal; color: #222222; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.4; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #6f6f6f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Inconsolata", Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #7f0a0c; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.4; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }

blockquote, blockquote p { line-height: 1.4; color: #6f6f6f; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Print styles.  Inlined to avoid required HTTP connection: www.phpied.com/delay-loading-your-print-css/ Credit to Paul Irish and HTML5 Boilerplate (html5boilerplate.com)
*/
.print-only { display: none !important; }

@media print { * { background: transparent !important; color: #000 !important; /* Black prints faster: h5bp.com/s */ box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; /* h5bp.com/t */ }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; padding: 0; white-space: nowrap; background-color: inherit; border: 0 solid #dddddd; -webkit-border-radius: 0; border-radius: 0; text-shadow: none; }

pre, pre > code { line-height: 1.4; color: black; font-family: "Inconsolata", monospace, serif; font-weight: normal; }

kbd.keyseq { color: #555555; }

kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }

kbd kbd:first-child { margin-left: 0; }

kbd kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: #090909; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: bold; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }

#toc { border-bottom: 1px solid #dddddd; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }

#toctitle { color: #6f6f6f; }

@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #dddddd; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }

#content #toctitle { font-weight: bold; font-family: "Source Sans Pro", sans-serif; font-size: 1em; padding-left: 0.125em; }

#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }

#footer-text { color: #dddddd; line-height: 1.4; }

.sect1 { padding-bottom: 1.25em; }

.sect1 + .sect1 { border-top: 1px solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #222222; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #151515; }

.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }

.imageblock.bordered img { border: 0px solid black; box-shadow: 5px 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19); }

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title { text-align: inherit; }, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }

.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1.4; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }

.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1.4; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #6f6f6f; margin-top: 0; line-height: 1.4; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock > .content pre, .listingblock > .content pre { background: #eeeeee; border-width: 1px; border-style: solid; border-color: #cccccc; -webkit-border-radius: 0; border-radius: 0; padding: 0.8em 0.8em 0.65em 0.8em; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.72em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.81em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }

.listingblock > .content { position: relative; }

.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }

.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }

table.pyhltable { border: 0; margin-bottom: 0; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }

.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: 0.8125em; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }

table thead th, table tfoot th { font-weight: bold; }

table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 0; border-radius: 0; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }

table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }

table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }

table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }

th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }

th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }

th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }

th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }

th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }

th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }

p.tableblock.header { color: #222222; font-weight: bold; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.6em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1 { padding-right: .8em; font-weight: bold; }

td.hdlist1, td.hdlist2 { vertical-align: top; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1.4; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.qanda > ol > li > p > em:only-child { color: #2795b6; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; text-align: justify; text-align-last: center; padding: 0.5em 2em 0; line-height: 1.15;}
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; }

span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.4; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }

#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; line-height: 1;}

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }

.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #2ba6cb; color: #207c98; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: "Source Sans Pro", Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }


.video-container {
  position: relative;
  width: 100%;
  padding-bottom: 56.25%;
}
.video {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: 0;
}

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>A Practitioner&#8217;s Guide to Machine Learning</h1>
<div class="details">
<span id="author" class="author">Dr. Franziska Horn</span><br>
<span id="email" class="email"><a href="mailto:hey@franziskahorn.de">hey@franziskahorn.de</a></span><br>
<span id="revnumber">version 1.9,</span>
<span id="revdate">2024-01-01</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_ml_is_everywhere">ML is everywhere!</a></li>
<li><a href="#_ml_history_why_now">ML history: Why now?</a></li>
</ul>
</li>
<li><a href="#_the_basics">The Basics</a>
<ul class="sectlevel2">
<li><a href="#_data_is_the_new_oil">Data is the new oil!?</a></li>
<li><a href="#_what_is_ml">What is ML?</a></li>
<li><a href="#_how_do_machines_learn">How do machines &#8220;learn&#8221;?</a></li>
<li><a href="#_ml_use_cases">ML use cases</a></li>
<li><a href="#_solving_problems_with_ml">Solving problems with ML</a></li>
</ul>
</li>
<li><a href="#_ml_with_python">ML with Python</a></li>
<li><a href="#_data_analysis_preprocessing">Data Analysis &amp; Preprocessing</a>
<ul class="sectlevel2">
<li><a href="#_data_analysis">Data Analysis</a></li>
<li><a href="#_garbage_in_garbage_out">Garbage in, garbage out!</a></li>
<li><a href="#_data_preprocessing">Data Preprocessing</a></li>
</ul>
</li>
<li><a href="#_unsupervised_learning">Unsupervised Learning</a>
<ul class="sectlevel2">
<li><a href="#_dimensionality_reduction_2">Dimensionality Reduction</a></li>
<li><a href="#_outlier_anomaly_detection">Outlier / Anomaly Detection</a></li>
<li><a href="#_clustering_2">Clustering</a></li>
</ul>
</li>
<li><a href="#_supervised_learning_basics">Supervised Learning Basics</a>
<ul class="sectlevel2">
<li><a href="#_different_types_of_models">Different types of models</a></li>
<li><a href="#_model_evaluation">Model Evaluation</a></li>
</ul>
</li>
<li><a href="#_supervised_learning_models">Supervised Learning Models</a>
<ul class="sectlevel2">
<li><a href="#_linear_models">Linear Models</a></li>
<li><a href="#_neural_networks">Neural Networks</a></li>
<li><a href="#_decision_trees">Decision Trees</a></li>
<li><a href="#_ensemble_methods">Ensemble Methods</a></li>
<li><a href="#_k_nearest_neighbors_knn">k-Nearest Neighbors (kNN)</a></li>
<li><a href="#_kernel_methods">Kernel Methods</a></li>
</ul>
</li>
<li><a href="#_avoiding_common_pitfalls">Avoiding Common Pitfalls</a>
<ul class="sectlevel2">
<li><a href="#_model_does_not_generalize">Model does not generalize</a></li>
<li><a href="#_model_abuses_spurious_correlations">Model abuses spurious correlations</a></li>
<li><a href="#_model_discriminates">Model discriminates</a></li>
<li><a href="#_explainability_interpretable_ml">Explainability &amp; Interpretable ML</a></li>
<li><a href="#_data_concept_drifts">Data &amp; Concept Drifts</a></li>
</ul>
</li>
<li><a href="#_advanced_topics">Advanced Topics</a>
<ul class="sectlevel2">
<li><a href="#_deep_learning_2">Deep Learning</a></li>
<li><a href="#_information_retrieval_similarity_search">Information Retrieval (Similarity Search)</a></li>
<li><a href="#_recommender_systems_pairwise_data">Recommender Systems (Pairwise Data)</a></li>
<li><a href="#_time_series_forecasting">Time Series Forecasting</a></li>
<li><a href="#_reinforcement_learning_2">Reinforcement Learning</a></li>
</ul>
</li>
<li><a href="#_conclusion">Conclusion</a>
<ul class="sectlevel2">
<li><a href="#_ai_transformation_of_a_company">AI Transformation of a Company</a></li>
<li><a href="#_additional_resources">Additional Resources</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>Why read this book?</strong></p>
</div>
<div class="paragraph">
<p>There are a lot of machine learning (ML) resources out there. Many of them either targeted at students or researchers and rather heavy on the mathematical theory, or others in the form of tutorials, focusing on the concrete implementation and application of some ML algorithm to a specific problem. This book tries to find a middle ground between both the theoretical background, which I have studied in depth while completing my PhD in machine learning at the TU Berlin, Germany, and the practical applications of these algorithms to solve different problems, as I have been doing in the last few years as an independent data science consultant for various firms. This book originated from my experience holding dozens of machine learning seminars and workshops in front of audiences with varying levels of technical and mathematical background.</p>
</div>
<div class="imageblock text-center bordered">
<div class="content">
<img src="images/cover/ML_2021.jpeg" alt="cover" width="340">
</div>
<div class="title"><span class="small">Book cover, featuring a drawing of part of a Siphonophorae (a kind of jellyfish) by Ernst Haeckel from his book &#8220;Kunstformen der Natur&#8221; (1900, Tafel 37; source: www.BioLib.de).</span></div>
</div>
<div class="paragraph">
<p><strong>Questions this book answers:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Which problems can machine learning (ML) solve?</p>
</li>
<li>
<p>How does ML solve these problems, i.e., how do the algorithms work (in theory)?</p>
</li>
<li>
<p>How do you actually get this to work in practice and avoid common pitfalls?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This book does <strong>not</strong> explain the latest fancy neural network model that achieves state-of-the-art performance on some specific task. Instead it provides a general intuition for the ideas behind different machine learning algorithms to establish a solid framework that helps you better understand and integrate into a bigger picture what you later read about these specific approaches.</p>
</div>
<div class="paragraph">
<p>This book and the associated courses exist in two versions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the full version, targeted at (about to be) data scientists: [<a href="https://franziskahorn.de/mlbook/">book</a>][<a href="https://franziskahorn.de/mlws_scientist.html">course</a>]</p>
</li>
<li>
<p>the condensed version, targeted at a more general audience: [<a href="https://franziskahorn.de/mlbook_abstract/">book</a>][<a href="https://franziskahorn.de/mlws_strategist.html">course</a>] (also available in German: [<a href="https://franziskahorn.de/mlbuch_auszug/">book</a>][<a href="https://franziskahorn.de/mlws_strategist_de.html">course</a>])</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The condensed version is written for all audiences, i.e., readers generally interested in ML, who want to understand what is behind the hype and where ML can&#8201;&#8212;&#8201;or should not&#8201;&#8212;&#8201;be used. The full version is mainly written for ML practitioners and assumes the reader is familiar with elementary concepts of linear algebra (see also this <a href="https://franziskahorn.de/mlws_resources/math_basics.pdf" target="\_blank">overview on the mathematical notation</a> used in the book).</p>
</div>
<div class="paragraph">
<p>While the book focuses on the general principles behind the different models, there are also references included to specific Python libraries (mostly scikit-learn) where the respective algorithms are implemented and tips for how to use them. To get an even deeper understanding of how to apply the different algorithms, I recommend that you try to solve some <a href="https://github.com/cod3licious/ml_exercises" target="\_blank">exercises</a> covering different ML use cases.</p>
</div>
<div class="paragraph">
<p><em><strong>This is still a draft version!</strong></em> Please write me an email or <a href="https://forms.gle/Ccv5h5zQxwPjWtCS7" target="\_blank">fill out the feedback survey</a>, if you have any suggestions for how this book could be improved!</p>
</div>
<div class="paragraph">
<p>Enjoy! :-)</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Acknowledgments</dt>
<dd>
<p>I would like to thank: <a href="https://www.linkedin.com/in/antje-relitz-3680a9107/" target="\_blank">Antje Relitz</a> for her feedback &amp; contributions to the original workshop materials, Robin Horn for his feedback &amp; help with the German translation of the book, and Karin Zink for her help with some of the graphics (incl. the book cover).</p>
</dd>
<dt class="hdlist1">How to cite</dt>
</dl>
</div>
<div class="literalblock">
<div class="content">
<pre>@misc{horn2021mlpractitioner,
  author = {Horn, Franziska},
  title = {A Practitioner's Guide to Machine Learning},
  year = {2021},
  url = {https://franziskahorn.de/mlbook/},
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter provides some motivating examples illustrating the rise of machine learning (ML).</p>
</div>
<div class="sect2">
<h3 id="_ml_is_everywhere">ML is everywhere!</h3>
<div class="paragraph">
<p>Machine learning is already used all around us to make our lives more convenient:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Face recognition</strong></p>
</div>
<div class="paragraph">
<p>Face recognition technology is one of the earliest notable examples of machine learning and computer vision that can nowadays be found in every digital camera and smartphone.</p>
</div>
<div class="paragraph">
<p>While the algorithms implemented in a camera application are fairly simple and only detect the presence of faces in general to make sure you look your best when the picture is taken, more sophisticated algorithms are also being used by governments and law enforcement in more and more countries to match a detected face to a known person in their biometric databases, for example, to identify criminals. So&#8230;&#8203;smile!?</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_facerec.jpg" alt="face recognition" width="540">
</div>
<div class="title"><span class="small">Source: https://thesocietypages.org/socimages/2008/12/15/nikon-s60-auto-focuses-on-voyeurs-savages-ghosts/ (15.12.2008)</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Object recognition (e.g., for self-driving cars)</strong></p>
</div>
<div class="paragraph">
<p>Another example from the area of computer vision is object recognition or image segmentation in general. This is, for example, used in self-driving cars to make sure they are aware of street signs and pedestrians.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_cars.jpg" alt="object recognition" width="640">
</div>
<div class="title"><span class="small">Source: https://medium.com/intro-to-artificial-intelligence/c01eb6eaf9d (16.06.2018)</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Analysis of medical images</strong></p>
</div>
<div class="paragraph">
<p>The last example on image data comes from the application area of medicine: Below you see two images of retinas, i.e., photos taken of the back of someone&#8217;s eye, based on which it is possible to diagnose a common complication of diabetes that can result in blindness if left untreated.</p>
</div>
<div class="paragraph">
<p>The diagnostic algorithm to identify the markers of the disease in these images was developed by researchers at Google and achieves the same level of accuracy as human experts in the field. Google had even assembled a team of top specialists to discuss the hardest cases again to get consistent labels for all images, which gave their model an additional performance boost.</p>
</div>
<div class="paragraph">
<p>Since the equipment to take these images is fairly cheap, this means that with this ML model, expert diagnostic decisions can now be made available to those that might otherwise not have had the means to consult a top specialist.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_medical.png" alt="medical images" width="640">
</div>
<div class="title"><span class="small">Source: https://ai.googleblog.com/2016/11/deep-learning-for-detection-of-diabetic.html (29.11.2016)</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Conversational agents (i.e., speech recognition&#8230;&#8203;)</strong></p>
</div>
<div class="paragraph">
<p>Leaving the field of computer vision, now an example from the area of natural language processing (NLP): Conversational agents, like Siri or Alexa, are waiting for commands in many people&#8217;s homes. While many of the answers they give are still scripted by humans (as in the screenshot below), the real challenge is to understand what the person had actually said in the first place. Speech recognition, i.e., automatically transcribing spoken language into text, is a rather difficult problem, for example, since people speak with different accents and there can be additional background noises.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_siri.png" alt="speech recogniton" width="640">
</div>
<div class="title"><span class="small">Screenshot: Siri on macOS (13.12.2018)</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Machine translation</strong></p>
</div>
<div class="paragraph">
<p>Again from the field of NLP: machine translation, i.e., automatically translating text from one language into another.</p>
</div>
<div class="paragraph">
<p>If you have used Google Translate (shown as an example in the screenshot below) after it was first released in 2006, you were probably often quite disappointed with the results, as the translated sentences read more like the words were just looked up one after another in a dictionary (= statistical machine translation). However, this changed when Google made the switch to a neural network model to generate the translations 10 years later in 2016: now the translated texts are actually readable and usually require only minor manual corrections, if any.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_translation.png" alt="translation" width="640">
</div>
<div class="title"><span class="small">Screenshot: https://translate.google.com/ (13.12.2018)</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Recommender systems</strong></p>
</div>
<div class="paragraph">
<p>Another application area are recommender systems, for example, on e-commerce platforms (like Amazon in the screenshot below) to provide the user with helpful search results and suggestions, and thereby generate revenue for the respective companies. They are also used on social media platforms and by Netflix, YouTube &amp; co to keep you glued to your screen.</p>
</div>
<div class="paragraph">
<p>Sometimes the provided suggestions might help you find exactly what you were looking for. But especially platforms with uncurated content such as YouTube have also been criticized for fostering, e.g., conspiracy theories through these personalized recommendations. Since this kind of content kept users especially engaged, it was recommended a lot and thereby drove the users further down some rabbit hole instead of also providing perspectives outside one&#8217;s own information bubble.</p>
</div>
<div class="paragraph">
<p>But on the upside, the research on recommender systems has also sparked developments in other areas of science, such as methods that recommend drug molecules that fit to the proteins playing a key role in certain diseases to accelerate the search for a cure.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_recsys1.png" alt="recommender systems 1" width="640">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_recsys2.png" alt="recommender systems 2" width="640">
</div>
<div class="title"><span class="small">Screenshot: https://www.amazon.com/ (12.12.2018)</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Better than humans: AlphaGo</strong></p>
</div>
<div class="paragraph">
<p>In 2016, DeepMind, a startup subsequently acquired by Google, presented AlphaGo, the first computer program to beat a human Go master.</p>
</div>
<div class="paragraph">
<p>This was a huge milestone for the AI research community, as Go, with a 19 x 19 playing field, is a lot more complex than chess (8 x 8 tiles and more restrictive movement patterns), and even the most optimistic AI researchers had not expected that a computer could win against a Go master before 2020.</p>
</div>
<div class="paragraph">
<p>The algorithms used in AlphaGo are from the subfield of reinforcement learning, which we will discuss in more detail later.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_alphago.jpg" alt="alpha go" width="440">
</div>
<div class="title"><span class="small">Source: https://www.nature.com/nature/volumes/529/issues/7587 (28.01.2016)</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Protein folding - solving a 50-year-old challenge</strong></p>
</div>
<div class="paragraph">
<p>DeepMind presented another major success story in 2020: Their AlphaFold model now estimates the 3D structure of a protein from its raw amino acid sequence as accurately as traditional simulation models.</p>
</div>
<div class="paragraph">
<p>Proteins often play a key role in diseases. If we know a protein&#8217;s 3D structure, we can determine which drug molecules can bind to it and thereby identify target structures that should be investigated further to find a cure for the disease.</p>
</div>
<div class="paragraph">
<p>While exact simulation models to estimate a protein&#8217;s 3D structure existed for a long time, these were very slow and it often took several days to compute the folding for a single protein. With the new neural network model, the same computation can now be done in a matter of minutes or even seconds, thereby vastly accelerating drug development.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_alphafold.png" alt="alpha fold" width="640">
</div>
<div class="title"><span class="small">Source: https://deepmind.google/discover/blog/alphafold-using-ai-for-scientific-discovery-2020/ (15.01.2020)</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Neural networks getting creative</strong></p>
</div>
<div class="paragraph">
<p>Lots of fun applications use neural networks to create new content, i.e., perform creative tasks that were previously thought exclusive to humans.</p>
</div>
<div class="paragraph">
<p>For example, an AI has written a slightly confusing yet hilarious <a href="https://arstechnica.com/gaming/2021/05/an-ai-wrote-this-movie-and-its-strangely-moving/" target="\_blank">script for a movie</a>, which was then actually produced.</p>
</div>
<div class="paragraph">
<p>Neural networks are also used to visualize music by combining and transforming images, like in the video below:</p>
</div>
<div class="video-container">
    <iframe class="video" src="https://www.youtube.com/embed/85l961MmY8Y" allowfullscreen></iframe>
</div>
<div class="paragraph">
<p></p>
</div>
<div class="paragraph">
<p>And you&#8217;ve probably also seen some examples of <a href="https://pytorch.org/tutorials/advanced/neural_style_tutorial.html" target="\_blank">&#8220;Neural Style Transfer&#8221;</a> before, a technique that can, for example, be used to make your social media profile picture look like a van Gogh painting:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://pytorch.org/tutorials/_images/neuralstyle.png" alt="styletransfer" width="940">
</div>
<div class="title"><span class="small">Source: https://pytorch.org</span></div>
</div>
<div class="paragraph">
<p>Even stock photos are now basically obsolete, since we can use neural networks to <a href="https://imagen.research.google/" target="\_blank">generate images given a textual description</a>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_imagen_examples.png" alt="imagen" width="940">
</div>
<div class="title"><span class="small">Screenshot: https://imagen.research.google/ (28.05.2022)</span></div>
</div>
<div class="paragraph">
<p>And <a href="https://chat.openai.com/" target="\_blank">chatbots</a> can hold conversations and provide information in a variety of styles:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_chatgpt.png" alt="imagen" width="640">
</div>
<div class="title"><span class="small">Screenshot: https://chat.openai.com/chat (04.01.2023)</span></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ml_history_why_now">ML history: Why now?</h3>
<div class="paragraph">
<p>Why is there such a rise in ML applications?
Not only in our everyday lives has ML become omnipresent, but also the number of research paper published each year has increased exponentially:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/ML_history2.png" alt="history1" width="740">
</div>
<div class="title"><span class="small">Data Source: https://www.webofknowledge.com/</span></div>
</div>
<div class="paragraph">
<p>Interestingly, this is not due to an abundance of groundbreaking theoretical accomplishments in the last few years (indicated as purple diamonds in the plot), but rather many of the algorithms used today were actually developed as far back as the late 50s / early 60s. For example, the perceptron is a precursor of neural networks, which are behind all the examples shown in the last section. Indeed, the most important neural network architectures, recurrent neural networks (RNN) and convolutional neural networks (CNN), which provide the foundation for state-of-the-art language and image processing respectively, were developed in the early 80s and 90s. But back then we lacked the computational resources to use them on anything more than small toy datasets.</p>
</div>
<div class="paragraph">
<p>This is why the rise in ML publications correlates more closely with the number of transistors on CPUs (i.e., the regular processors in normal computers) and GPUs (graphics cards, which parallelize the kinds of computations needed to train neural network models efficiently):</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/ML_history4.png" alt="history2" width="740">
</div>
<div class="title"><span class="small">Data Source: https://en.wikipedia.org/wiki/Transistor_count</span></div>
</div>
<div class="paragraph">
<p>Additionally, the release of many open source libraries, such as scikit-learn (for traditional ML models) and theano, tensorflow, and (py)torch (for the implementation of neural networks), has further facilitated the use of ML algorithms in many different fields.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While these libraries democratize the use of ML, unfortunately, this also brings with it the downside that ML is now often applied without a sound understanding of the theoretical underpinnings of these algorithms or their assumptions about the data. This can result in models that don&#8217;t show the expected performance and subsequently some (misplaced) disappointment in ML. In the worst case, it can lead to models that discriminate against certain parts of the population, e.g., credit scoring algorithms used by banks that systematically give women loans at higher interest rates than men due to biases encoded in the historical data used to train the models. We&#8217;ll discuss these kinds of issues in the chapter on avoiding common pitfalls.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Another factor driving the spread of ML is the availability of (digital) data. Companies like Google, Amazon, and Meta have had a head start here, as their business model was built around data from the start, but other companies are starting to catch up. While traditional ML models do not benefit much from all this available data, large neural network models with many degrees of freedom can now show their full potential by learning from all the texts and images posted every day on the Internet:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/ML_why_now_data5.png" alt="datagrowth" width="640">
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>But we&#8217;re still far from Artificial <strong>General</strong> Intelligence (AGI)!</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01a_intro/01_killer_robot_style.jpg" alt="agi" width="240">
</div>
</div>
<div class="paragraph">
<p>An AGI is a hypothetical computer system with human-like cognitive abilities capable of understanding, learning, and performing a <strong>wide range of tasks across diverse domains</strong>. Specifically, an AGI would not only perform specific tasks but also understand and learn from its environment, make decisions autonomously, and <strong>generalize its knowledge to completely new situations</strong>.</p>
</div>
<div class="paragraph">
<p>Instead, what is used in practice today is <strong>Artificial <em>Narrow</em> Intelligence</strong> (ANI): models <strong>explicitly programmed to solve a specific task(s)</strong>, e.g., translate texts from one language to another. But they <strong>can&#8217;t generalize (on their own) to handle novel tasks</strong>, i.e., a machine translation model will not tomorrow decide that it now also wants to recognize faces in images. Of course, one can combine several individual ANIs into one big program trained to <a href="https://deepmind.google/discover/blog/a-generalist-agent/" target="\_blank">solve multiple different tasks</a>, but this collection of ANIs is still not able to learn (on its own) any new skills beyond these capabilities.</p>
</div>
<div class="paragraph">
<p>Many AI researchers believe that at least with the currently used approaches to AI (e.g., models created by OpenAI like ChatGPT), we might never produce a true human-like AGI. Specifically, these AI systems still <strong>lack a general understanding of causality and physical laws like object permanence</strong>&#8201;&#8212;&#8201;something that even many pets understand.<br>
If you&#8217;re interested to learn more about the faults of current AI systems, the <a href="https://garymarcus.substack.com/" target="\_blank">blog articles by Gary Marcus</a> are highly recommended!</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_basics">The Basics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter provides a general introduction into what machine learning (ML) actually is and where it can&#8201;&#8212;&#8201;or should not&#8201;&#8212;&#8201;be used.</p>
</div>
<div class="sect2">
<h3 id="_data_is_the_new_oil">Data is the new oil!?</h3>
<div class="paragraph">
<p>Let&#8217;s take a step back. Because it all begins with data.
You&#8217;ve probably heard this claim before: &#8220;Data is the new oil!&#8221;. This suggests that data is valuable. But is it?<br>
The reason why oil is considered valuable is because we have important use cases for it: powering our cars, heating our homes, and producing plastics or fertilizers.
Similarly, our data is only as valuable as what we make of it. So what can we use data for?</p>
</div>
<div class="paragraph">
<p>The main use cases belong to one of two categories:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/data_value.png" alt="image" width="440">
</div>
</div>
<div class="sect3">
<h4 id="_insights">Insights</h4>
<div class="paragraph">
<p>We can generate insights either through continuous monitoring (&#8220;Are we on track?&#8221;) or a deeper analysis (&#8220;What&#8217;s wrong?&#8221;).</p>
</div>
<div class="paragraph">
<p>By visualizing important variables or <em>Key Performance Indicators</em> (KPIs) in <strong>reports</strong> or <strong>dashboards</strong>, we increase transparency of the status quo and quantify our progress towards some goal.
When a KPI is far from its target value, we can dig deeper into the data with an exploratory data analysis to identify the root cause of the problem and answer questions such as</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Why are we not reaching our goal?</p>
</li>
<li>
<p>What should we do next?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, as we&#8217;ll discuss in more detail in the section on <a href="#_data_analysis">data analysis</a>, arriving at satisfactory answers is often more art than science 😉.</p>
</div>
</div>
<div class="sect3">
<h4 id="_automation">Automation</h4>
<div class="paragraph">
<p>As described in the following sections, machine learning models can be used to <strong>automate &#8216;input &#8594; output&#8217; tasks</strong> otherwise requiring a human (expert). These tasks are usually easy for an (appropriately trained) human, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Translating texts from one language into another</p>
</li>
<li>
<p>Sorting out products with scratches when they pass a checkpoint on the assembly line</p>
</li>
<li>
<p>Recommending movies to a friend</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For this to work, the ML models need to be <strong>trained on a lot of historical data</strong> (e.g., texts in both languages, images of products with and without scratches, information about different users and which movies they watched).</p>
</div>
<div class="paragraph">
<p>The resulting software can then either be used to <strong>automate the task completely</strong> or we can keep a <strong>human in the loop</strong> that can intervene and correct the suggestions made by the model.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_what_is_ml">What is ML?</h3>
<div class="paragraph">
<p>OK, now what exactly is this machine learning that is already transforming all of our lives?</p>
</div>
<div class="paragraph">
<p>First of all, ML is an area of research in the field of theoretical computer science, i.e., at the intersection of mathematics and computer science:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/venn1.png" alt="image" width="340">
</div>
</div>
<div class="paragraph">
<p>More specifically, <strong>machine learning</strong> is an <strong>umbrella term for algorithms that recognize patterns and learn rules from data</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Simply speaking, an <strong>algorithm</strong> can be thought of as a <strong>strategy or recipe for solving a certain kind of problem</strong>. For example, there exist effective algorithms to find the shortest paths between two cities (e.g., used in Google Maps to give directions) or to solve scheduling problems, such as: &#8220;Which task should be done first and which task after that to finish all tasks before their respective deadlines and satisfy dependencies between the tasks.&#8221; Machine learning deals with the subset of algorithms that detect and make use of statistical regularities in a dataset to obtain specific results.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Analogous to the tools used in a traditional manufacturing process to build something, you can think of <strong>ML algorithms as tools to generate value from data</strong>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/ml_carpentry_analogy2.png" alt="image" width="840">
</div>
</div>
<div class="paragraph">
<p>In order to successfully apply ML, you should ask yourself some important questions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><em>What could be valuable?</em></strong> For example, this could be a new feature for an existing product, like Face ID as a new way to unlock your phone.</p>
</li>
<li>
<p><strong><em>What raw inputs are needed?</em></strong> We can&#8217;t build a wooden chair using only fabric and metal or a few twigs we found in the woods. Similarly, depending on what we want to achieve with ML, we also need the right data (quality &amp; quantity) to apply the algorithms in the first place. This can be especially tricky since in most cases we can&#8217;t just buy the data we need like wood at a hardware store, but we have to collect it ourselves, i.e., grow our own trees, which can take some time.</p>
</li>
<li>
<p><strong><em>Which ML algorithm is the right tool for the task?</em></strong> (I.e., which category of ML algorithms produces the type of output we want?)</p>
</li>
<li>
<p>Do I or my employees have the <strong><em>necessary skills and enough compute power</em></strong> to accomplish this in practice?</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>We can think of the different ML algorithms as our <strong>ML toolbox</strong>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/ml_toolset6.png" alt="image" width="640">
</div>
<div class="title"><span class="small">ML itself is a subfield of AI, which is currently the more frequently used buzzword, but all the cool applications (e.g., the examples we&#8217;ve seen in the beginning) actually use ML. Besides ML, AI includes, for example, some search algorithms that were used for building the first chess computers. ML can be divided into three main subfields, unsupervised, supervised, and reinforcement learning. Additionally, the subfield &#8220;deep learning&#8221; is a buzzword for neural network models. Some of the simplest algorithms used in ML, like linear regression or PCA (very similar to factor analysis), are also used by statisticians, who additionally use other tools, like hypothesis tests, which do not learn rules or patterns from data. Finally, most data scientists use many tools from ML and statistics, but they as well use some additional tools like A/B tests, e.g., for collecting data on whether a red or green &#8220;buy&#8221; button on a website generates more sales, which do not fall into any of the other categories.</span></div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">ML algorithms solve &#8220;input &#8594; output&#8221; problems</dt>
<dd>
<p>What all of these ML algorithms have in common, is that they solve &#8220;input &#8594; output&#8221; problems like these:</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/input_output5.png" alt="image" width="500">
</div>
<div class="title"><span class="small">Example &#8220;input &#8594; output&#8221; ML problems: recognizing objects in images; translating text from one language to another; determining a good next move given the current state of a Go board; grouping similar users/customers together based on some information about them like questionnaire answers (known as customer segmentation in marketing, this is used, for example, to target different groups of customers with specific advertisement campaigns on social media).</span></div>
</div>
<div class="paragraph">
<p>In the above examples, while a human (expert) could easily produce the correct output given the input (e.g., even a small child can recognize the cat in the first image), humans have a hard time describing <em>how</em> they arrived at the correct answer (e.g., how did you know that this is a cat (and not a small dog)? because of the pointy ears? the whiskers?). ML algorithms can <strong>learn such rules from the given data samples</strong>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>ML vs. traditional software</strong></p>
</div>
<div class="paragraph">
<p>While <strong>traditional software</strong> solutions are used to automate tasks that can be formulated as a fixed, predefined sequence of actions, executed according to some <strong>hard-coded rules</strong> (e.g., &#8220;a gate should open <em>if</em> an object passes through a photoelectric barrier and 20 seconds later the gate should close again&#8221;), machine learning can be used to <strong>automate &#8220;input &#8594; output&#8221; tasks</strong> for which it would otherwise be <strong>difficult to come up with such rules</strong>.</p>
</div>
<div class="paragraph">
<p>For example, the quality control in a cookie factory is such an &#8220;input (cookie) &#8594; output (ok/defective)&#8221; task: While some broken cookies could be sorted out automatically by checking that each cookie weights around 15g, it would be difficult to formulate rules that reliably catch all possible defects. So either a human could watch the production line to additionally recognize, e.g., over-baked cookies, or one could take pictures of the cookies and use them as input for a machine learning model to recognize the defective cookies:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/input_output_solving_cookie3.png" alt="image" width="780">
</div>
</div>
<div class="paragraph">
<p>To solve this problem with ML, first a large dataset needs to be compiled with photos of many good, but also all kinds of defective cookies, including the corresponding annotations, i.e., a label for each picture whether it displays a good or defective cookie (not necessarily specifying the kind of defect). An ML algorithm can then learn to distinguish between good and defective cookies from these examples.</p>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><span class="underline">When (not) to use ML:</span></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">ML is overkill if: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>a manually defined set of rules or mechanistic (white box) model can solve the problem. For example, if in our example cookie factory broken cookies were the only quality problem that ever occurred, then the rule &#8220;cookie weight needs to be between 14-16g&#8221; would suffice to detect defective cookies. And such a rule is easier to implement as there is no need to collect a large dataset.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">ML has great potential when: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>an exact simulation with a mechanistic model takes too long (but can be used to generate a high quality dataset). For example, the AlphaFold model shown in the introduction, which is used to predict the 3D structure of a protein from its amino acid sequence, can be trained on the data generated by the original simulation model used to solve this task before, which is too slow to be applied to a large number of proteins.</p>
</li>
<li>
<p>solving a &#8220;simple&#8221; but hard to explain task that takes a human ~1 second, like recognizing something in an image.<br>
&#8658; Use ML to automate repetitive tasks &amp; make expert knowledge available to everyone, e.g., Google&#8217;s diabetic retinopathy diagnostic model shown in the first section.<br>
<span class="underline">But:</span> success depends on data quality &amp; quantity!<br>
&#8594; Humans are much better at generalizing from a few examples. For example, a doctor can still easily recognize the disease even if the pictures were taken with a slightly different setup that might result, for example, in noisier images. The ML model, on the other hand, needs to be specifically trained for these cases, which means that in the worst case we might need to collect a lot of additional data for this new setup.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">ML is your best chance when: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>humans are overwhelmed by very complex, high dimensional data. For example, given an excel spreadsheet with hundreds of columns, a human can&#8217;t easily recognize any patterns in this sea of numbers. In the worst case, there actually aren&#8217;t any relationships in the data that could be discovered (maybe we didn&#8217;t measure all the relevant factors), but if there are, ML will most likely find them.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Use ML only when occasional errors are acceptable. ML models are typically trained on human-generated data, which is prone to noise since even experts may disagree on certain cases. Additionally, ML models may need to extrapolate, predicting outcomes for new data points that differ from the training data, leading to potential inaccuracies. To minimize errors, keeping a human in the loop to periodically review the predictions made by the ML model can be beneficial.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Steps to identify a potential ML project</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a process map: which steps are executed in the business process (flow of materials &amp; information) and what data is collected where. For example, in a production process where some of the produced parts are defective:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/automate_insights7a.png" alt="image" width="700">
</div>
</div>
</li>
<li>
<p>Identify parts of the process that could either be automated with ML (e.g., straightforward, repetitive tasks otherwise done by humans) or in other ways improved by analyzing data (e.g., to understand root causes of a problem, to improve planning with what-if simulations, or to optimize the use of resources):</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/automate_insights7b.png" alt="image" width="840">
</div>
<div class="title"><span class="small">The first idea is to automate the quality check that was so far done by a human: since the human can easily recognize the defects in the pictures taken of the products, an ML model should be able to do this, too. The next idea is to try to predict in advance whether a product will be faulty or not based on the composition of raw materials and the proposed process conditions: success here is unclear, since the human experts are not sure whether all of the information necessary to determine if the product will be fine is contained in this data&#8201;&#8212;&#8201;but nevertheless it&#8217;s worth a try since this could save lots of resources. While the final ML model that solves the input-output problem can be deployed as software in the ongoing process, when a data scientist analyzes the results and interprets the model, she can additionally generate insights that can be translated into action recommendations.</span></div>
</div>
</li>
<li>
<p>Prioritize: which project will have a high impact, but at the same time also a good chance of success, i.e., should yield a high return on investment (ROI)? For example, using ML to automate a simple task is a comparatively low risk investment, but might cause some assembly-line workers to loose their jobs. In contrast, identifying the root causes of why a production process results in 10% scrap could save millions, but it is not clear from the start that such an analysis will yield useful results, since the collected data on the process conditions might not contain all the needed information.</p>
</li>
</ol>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_how_do_machines_learn">How do machines &#8220;learn&#8221;?</h3>
<div class="paragraph">
<p>How do ML algorithms solve these &#8220;input &#8594; output&#8221; problems, i.e., how do they recognize patterns and learn rules from data?</p>
</div>
<div class="paragraph">
<p>The set of ML algorithms can be subdivided according to their learning strategy. This is inspired by how humans learn:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/ml_algorithms_short_human4.png" alt="image" width="740">
</div>
<div class="title"><span class="small"><strong>Unsupervised Learning:</strong> Humans are very good at picking up on statistical regularities in the world without being explicitly instructed to do so. For example, have you ever noticed that we don&#8217;t &#8230;&#8203; make &#8230;&#8203; pauses &#8230;&#8203; between &#8230;&#8203; words when we speak? Yet kids still intuitively learn which syllables make up a word and where this word ends and the next one begins. This is possible, because the syllables in a single word always occur in this specific combination, while this word can then be followed by many different words, starting with many different syllables. This means, simply by hearing lots of spoken text, we pick up on the conditional probability distributions of syllables. <strong>Supervised Learning:</strong> This type of learning requires a teacher that tells us what the right answers are and corrects us, if we get something wrong. For example, when teaching a kid the meaning of a word, we explicitly tell them what this word means, and if they mislabel something, e.g., call a small dog a cat, we correct them. <strong>Reinforcement Learning:</strong> This kind of learning-by-doing again happens naturally when humans learn from the consequences of their actions. For example, through experimentation and practice, we can figure out a complex sequence of hand movements to elicit beautiful sounds from a violin instead of producing painful screeches. While no single hand movement by itself is inherently good or bad, only the right combination will bring music to our ears.</span></div>
</div>
<div class="paragraph">
<p>Analogously, machines can also learn by following these three strategies:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/ml_algorithms_short4.png" alt="image" width="740">
</div>
<div class="title"><span class="small"><strong>Unsupervised Learning:</strong> These algorithms pick up on statistical regularities in the data, for example, they can find groups of similar items (like in the customer segmentation task) or identify individual points that stand out (i.e., anomaly detection), e.g., unusual behavior of a machine due to a broken part or suspicious credit card transactions. <strong>Supervised Learning:</strong> These algorithms learn from many input-output examples, e.g., images and what is shown on these images or production conditions and whether the product that was produced under these conditions is faulty or okay. The learned model can then be used to predict the output for some new input. <strong>Reinforcement Learning:</strong> This type of learning is a bit more involved: Here the learning algorithm is also called an agent, which operates within an environment, e.g., a robot moving around in the real world or a virtual agent inside a simulation environment like a video game (which is usually much cheaper ;-)). The environment lets the agent know in which state or situation it currently is, then the agent can select how to react in this state, i.e., which (predefined) action to take, and then the environment determines the consequences of this action (e.g., kill a monster in a video game or fall off a cliff) and returns a reward depending on the outcome (e.g., extra points for collecting coins). Then the cycle repeats as the agent is in the next state. Based on the received reward, the agent learns over time which actions are beneficial in which situations and how to navigate the environment. The hard part here is that the reward signals often come much later after the action was executed, for example, in a video game, an agent collects a key at the beginning of a level, but the door that can be opened with this key comes many frames later, which means the reward will be delayed and the agent has a hard time associating this reward with the appropriate action. Since humans have a lot of background knowledge, figuring out what works and what doesn&#8217;t in a game is much easier for us.</span></div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Data requirements for learning according to these strategies: </dt>
<dd>
<div class="ulist none">
<ul class="none">
<li>
<p><span class="underline">Unsupervised Learning:</span> a dataset with examples</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/requirements_learning_unsupervised.png" alt="image" width="500">
</div>
</div>
</li>
<li>
<p><span class="underline">Supervised Learning:</span> a dataset with <strong><em>labeled</em></strong> examples</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/requirements_learning_supervised.png" alt="image" width="500">
</div>
</div>
</li>
<li>
<p><span class="underline">Reinforcement Learning:</span> a (simulation) environment that generates data (i.e., reward + new state) in response to the agent&#8217;s actions</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/requirements_learning_reinforce.png" alt="image" width="460">
</div>
</div>
<div class="paragraph">
<p>With its reliance on a data-generating environment, reinforcement learning is a bit of a special case. Furthermore, as of now it&#8217;s still really hard to get reinforcement learning algorithms to work correctly, which means they&#8217;re currently mostly used in research and not so much for practical applications.</p>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="_supervised_learning">Supervised Learning</h4>
<div class="paragraph">
<p>Supervised learning is the most common type of machine learning used in today&#8217;s applications.<br>
The goal here is to learn a <strong>model (= a mathematical function)</strong> \(f(x)\) that describes the relationship between some <strong>input(s)</strong> \(x\) (e.g., different process conditions like temperature, type of material, etc.) and <strong>output</strong> \(y\) (e.g., resulting product quality).<br>
This model can then be used to <strong>make predictions for new data points</strong>, i.e., compute \(f(x') = y'\) for some new \(x'\) (e.g., predict for a new set of process conditions whether the produced product will be of high quality or if the process should be stopped to not waste resources).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Supervised Learning in a nutshell: </dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/04_supervised_intro/sl_steps5.png" alt="image" width="440">
</div>
<div class="title"><span class="small">Before we start, we need to be very clear on what we want, i.e., what should be predicted, how will predicting this variable help us achieve our overall goals and create value, and how do we measure success, i.e., what is the Key Performance Indicator (KPI) of our process. Then, we need to collect data&#8201;&#8212;&#8201;and since we&#8217;re using supervised learning, this needs to be <em>labeled</em> data, with the labels corresponding to the target variable that we want to predict. Next, we &#8220;learn&#8221; (or &#8220;train&#8221; or &#8220;fit&#8221;) a model on this data and finally use it to generate predictions for new data points.</span></div>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Features &amp; Labels</strong></p>
</div>
<div class="paragraph">
<p>A production process, where we want to predict whether a produced part is scrap given certain production conditions, is an example of a typical supervised learning problem. Here, the collected data for each produced part includes the process conditions under which it was produced, as well as the outcome, i.e., whether the product was okay or scrap:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/toy_data3.png" alt="image" width="740">
</div>
<div class="title"><span class="small">The data collected for this use case is structured data in a tabular form (e.g., in an excel sheet). One data point / sample / observation is always in one row of this table.</span></div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/toy_data6.png" alt="image" width="740">
</div>
<div class="title"><span class="small">The columns of the table contain the different measurements / variables that were collected for each sample. Here we distinguish between <em>features</em> (in this case the production conditions) and <em>labels</em> (whether the product produced under these conditions is okay or scrap). Features, also denoted as a matrix \(X\), are typically those measurements that we get basically for free, as they are often collected during the process for other purposes anyways. For example, when the operator of the machine sets the temperature for the production to a certain value, this is recorded as the signal is passed along to the heating unit. The corresponding labels, denoted as a vector \(\mathbf{y}\), are often more expensive to collect. For example, in the production process, to collect a data point with the label <em>"scrap"</em>, we have to (intentionally) produce a broken product, costing us valuable resources. Another example: Google had to pay a team of specialist doctors to discuss and re-label some of the diabetic retinopathy images about which there existed conflicting opinions.</span></div>
</div>
<div class="paragraph">
<p>In the supervised learning setup, the features are used as the input to the model, while the labels constitute the target variable, i.e., the predicted output. Generally, features should be independent variables (e.g., settings that the operator can choose as he wishes), while the target value should be dependent on these inputs&#8201;&#8212;&#8201;otherwise we can&#8217;t predict it from these inputs alone.</p>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>&#8220;Learning&#8221; a model from the data</strong></p>
</div>
<div class="paragraph">
<p><span class="underline">Goal:</span>
Describe the relationship between input(s) \(x\) and output \(y\) with a model, i.e., a mathematical function \(f(x)\)</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/learning_model_handout.png" alt="image" width="940">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Select a model class (= structure of the function):</strong> Assumption: relationship is linear<br>
&#8594; linear regression model: \(y = f(x) = b + w\cdot x\)</p>
</li>
<li>
<p><strong>Define an objective:</strong> Minimize error between true &amp; predicted \(y\):<br>
&#8594; \(\min_{b,w} \sum_i (y_i - f(x_i))^2\)</p>
</li>
<li>
<p><strong>Find best model parameters given the data:</strong> i.e., solve the optimization problem defined in step 2<br>
&#8658; \(f(x) = -2.7 + 5.2x\)</p>
</li>
</ol>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Video Recommendation: <strong>If you&#8217;re not familiar with linear regression</strong>, the most basic supervised learning algorithm, please watch the explanation from Google decision scientist Cassie Kozyrkov on how linear regression works: [<a href="https://youtu.be/j8VjRnaHRBM" target="\_blank">Part 1</a>] [<a href="https://youtu.be/VqhafjGTDI8" target="\_blank">Part 2</a>] [<a href="https://youtu.be/sxZDZVN0JAg" target="\_blank">Part 3</a>]
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The available supervised learning algorithms differ in the <strong>type of \(x \to y\) relationship</strong> they can describe (e.g., linear or nonlinear) and what kind of <strong>objective</strong> they minimize (also called loss function; an error computed on the training data, quantifying the mismatch between true and predicted labels). The task of a data scientist is to select a type of model that can optimally fit the given data. The rest is then taken care of by an <strong>optimization method, which finds the parameters of the model that minimize the model&#8217;s objective</strong>, i.e., such that the model&#8217;s prediction error on the given data is as small as possible.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In most of the book, the terms &#8220;ML algorithm&#8221; and &#8220;ML model&#8221; will be used interchangeably. To be more precise, however, in general the algorithm processes the data and learns some parameter values. These parameter settings define the final model. For example, a linear regression <em>model</em> is defined by its coefficients (i.e., the model&#8217;s parameters), which are found by executing the steps outlined in the linear regression <em>algorithm</em>, which includes solving an optimization problem.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Don&#8217;t stop there!</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/04_supervised_intro/supervised_more4.png" alt="image" width="540">
</div>
<div class="title"><span class="small">In many use cases, it is not enough to &#8220;only&#8221; predict the target for a new data point, e.g., predict whether a product produced under certain conditions will be of high quality or not. Instead, it is often necessary to additionally be able to explain <em>why</em> this prediction was made, e.g., which input feature values were the deciding factors, both to better understand possible root causes of a problem, but also to be assured that the model is basing its predictions on reasonable assumptions. Furthermore, a learned model can also be used within an outer optimization loop, i.e., in the simplest case one could systematically check what product quality the model predicts for different process conditions and then select the settings with the highest predicted quality to produce new products. But keep in mind that ML models are only built to interpolate, not extrapolate, i.e., make sure the settings that are tested are withing the training domain.</span></div>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Predictive Analytics</dt>
<dd>
<p>By feeding historical data to a supervised learning algorithm, we can generate a <strong>predictive model</strong> that makes predictions about future scenarios to aid with planning.<br>
<span class="underline">Example:</span> <em>Use sales forecasts to better plan inventory levels.</em></p>
</dd>
<dt class="hdlist1">Interpreting Predictive Models</dt>
<dd>
<p>Given a model that makes accurate predictions for new data points, we can <a href="https://franziskahorn.de/mlbook/_explainability_interpretable_ml.html" target="\_blank">interpret this model</a> and explain its predictions to <strong>understand root causes</strong> in a process.<br>
<span class="underline">Example:</span> <em>Given a model that predicts the quality of a product from the process conditions, identify which conditions result in lower quality products.</em></p>
</dd>
<dt class="hdlist1">What-if Analysis &amp; Optimization</dt>
<dd>
<p>Given a model that makes accurate predictions for new data points, we can use this model in a <strong>&#8220;what-if&#8221; forecast</strong> to explore how a system might react to different conditions to make better decisions
(but use with <a href="#_model_abuses_spurious_correlations">caution</a>!).<br>
<span class="underline">Example:</span> <em>Given a model that predicts the remaining lifetime of a machine component under some process conditions, simulate how quickly this component would deteriorate if we changed the process conditions.</em></p>
<div class="paragraph">
<p>Going one step further, this model can also be used inside an optimization loop to automatically evaluate different inputs with the model systematically to <strong>find optimal settings</strong>.<br>
<span class="underline">Example:</span> <em>Given a model that predicts the quality of a product from the process conditions, automatically determine the best production settings for a new type of raw material.</em></p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ml_use_cases">ML use cases</h3>
<div class="paragraph">
<p>The inputs that the ML algorithms operate on can come in many forms&#8230;&#8203;</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Structured vs. unstructured data</dt>
<dd>
<p>Data can come in various forms and while some data types require additional preprocessing steps, in principle ML algorithms can be used with all kinds of data.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/data_types2.png" alt="image" width="640">
</div>
<div class="title"><span class="small">The main distinction when characterizing data is made between <em>structured</em> data, which is any dataset that contains individual measurements / variables / attributes / features that represent unique quantities, and <em>unstructured</em> data, which can not be subdivided into meaningful variables. For example, in images &#8220;first pixel from the left&#8221; or in texts &#8220;10th word in the second paragraph&#8221; is not what we would call a variable, while &#8220;size in square meters&#8221; and &#8220;number of bedrooms&#8221; are useful quantities to describe an apartment. Structured data is often <em>heterogeneous</em>, since the different variables in a dataset typically stand for very different things. For example, when working with sensor data, a dataset normally does not consist of only temperature measurements, but additionally it could contain, e.g., pressure and flow values, which have different units and measurement scales. Unstructured data, on the other hand, is <em>homogeneous</em>, e.g., there is no qualitative difference between the 10th and the 100th pixel in an image.</span></div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;but our goal, i.e., the desired outputs, determines the <strong>type of algorithm</strong> we should use for the task:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/ml_goals3.png" alt="image" width="840">
</div>
<div class="title"><span class="small">If our goal is to simply understand the dataset a bit better and get an overview of it, then a dimensionality reduction algorithm from the area of unsupervised learning can be used to visualize it. If we want to discover patterns in the data, then we would also choose an algorithm from the field of unsupervised learning, but here it depends on which kinds of patterns we want to find: Anomaly detection algorithms identify individual data points that deviate from the rest (e.g., a malfunctioning machine or a fraudulent credit card transaction). Clustering algorithms identify groups of similar data points (e.g., for customer segmentation). If our goal is to make specific predictions, i.e., given an input get a corresponding output (e.g., predict whether a product will be faulty if it is produced under certain conditions), then we need to use an algorithm from the area of supervised learning. Here the main distinction is between regression and classification models: in regression tasks, the target variable that should be predicted is continuous (e.g., number of users, price, etc.), while in classification tasks the target variable is discrete, i.e., can only take on one distinct value and there is no continuum between the different values (e.g., an animal in a picture can either be a cat or a dog, but not something in between). While unsupervised and supervised learning cover most general use cases, other algorithms exist for more specific applications, e.g., recommender systems.</span></div>
</div>
<div class="paragraph">
<p>Some example input &#8594; output tasks and what type of ML algorithm solves them:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Input \(X\)</th>
<th class="tableblock halign-left valign-top">Output \(Y\)</th>
<th class="tableblock halign-left valign-top">ML Algorithm Category</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">questionnaire answers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">customer segmentation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">clustering</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sensor measurements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">everything normal?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">anomaly detection</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">past usage of a machine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">remaining lifetime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">regression</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spam (yes/no)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">classification (binary)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">which animal?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">classification (multi-class)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">user&#8217;s purchases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">products to show</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">recommender systems</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">search query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relevant documents</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">information retrieval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">audio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">speech recognition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">text in English</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text in French</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">machine translation</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To summarize (see also: <a href="https://franziskahorn.de/mlws_resources/algorithm_cheatsheet.pdf" target="\_blank">overview table as PDF</a>):</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Existing ML solutions &amp; corresponding output (for one data point): </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><span class="underline">Dimensionality Reduction:</span> (usually) <strong>2D coordinates</strong> (to create a visualization of the dataset)</p>
</li>
<li>
<p><span class="underline">Outlier/Anomaly Detection:</span> <strong>anomaly score</strong> (usually a value between 0 and 1 indicating how likely it is that this point is an outlier)</p>
</li>
<li>
<p><span class="underline">Clustering:</span> <strong>cluster index</strong> (a number between 0 and <em>k-1</em> indicating to which of the <em>k</em> clusters a data point belongs (or -1 for outliers))</p>
</li>
<li>
<p><span class="underline">Regression:</span> a <strong>continuous value</strong> (any kind of numeric quantity that should be predicted)</p>
</li>
<li>
<p><span class="underline">Classification:</span> a <strong>discrete value</strong> (one of several mutually exclusive categories)</p>
</li>
<li>
<p><span class="underline">Deep Learning:</span> <strong>unstructured output like a text or image</strong> (e.g., speech recognition, machine translation, image generation, or neural style transfer)</p>
</li>
<li>
<p><span class="underline">Recommender Systems &amp; Information Retrieval:</span> <strong>ranking of a set of items</strong> (recommender systems, for example, rank the products that a specific user might be most interested in; information retrieval systems rank other items based on their similarity to a given query item)</p>
</li>
<li>
<p><span class="underline">Reinforcement Learning:</span> a sequence of <strong>actions</strong> (specific to the state the agent is in)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Let&#8217;s start with a more detailed look at the different unsupervised &amp; supervised learning algorithms and what they are good for:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01c_ml_overview/ml_algorithms_12.png" alt="image" width="840">
</div>
<div class="title"><span class="small">To apply unsupervised learning algorithms, we only need a feature matrix \(X\), while learning a prediction model with supervised learning algorithms additionally requires the corresponding labels \(\mathbf{y}\).</span></div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Even if our ultimate goal is to predict something (i.e., use supervised learning), it can still be helpful to first use unsupervised learning to get a better understanding of the dataset, for example, by visualizing the data with dimensionality reduction methods to see all samples and their diversity at a glance, by identifying outliers to clean the dataset, or, for classification problems, by first clustering the samples to check whether the given class labels match the naturally occurring groups in the data or if, e.g., two very similar classes could be combined to simplify the problem.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Same dataset, different use cases</dt>
<dd>
<p>To illustrate the usefulness of the five different types of unsupervised and supervised learning algorithms, lets apply them to this example dataset:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">m<sup>2</sup></th>
<th class="tableblock halign-center valign-top"># Bedr</th>
<th class="tableblock halign-center valign-top"># Bath</th>
<th class="tableblock halign-center valign-top">Renovated</th>
<th class="tableblock halign-center valign-top">&#8230;&#8203;</th>
<th class="tableblock halign-center valign-top">Price</th>
<th class="tableblock halign-center valign-top">Sold</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">125</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">500k</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">75</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1990</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">350k</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">150</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2010</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">750k</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">35</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1999</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">620k</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">65</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2015</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">220k</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2003</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">450k</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
<div class="paragraph text-justify text-justify">
<p><span class="small">This is a small toy dataset with structured data about different apartments, which someone might have gathered from a real estate website. It includes the size of the apartment in square meters, the number of bedrooms, the number of bathrooms, the year it was last renovated, and finally the price of the listing and whether it was sold for this price (1) or not (0).</span></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dimensionality_reduction">Dimensionality Reduction</h4>
<div class="ulist">
<div class="title"><span class="underline">Use Cases:</span></div>
<ul>
<li>
<p>create a 2D visualization to explore the dataset as a whole, where we can often already visually identify patterns like samples that can be grouped together (clusters) or that don&#8217;t belong (outliers)</p>
</li>
<li>
<p>noise reduction and/or feature engineering as a data preprocessing step to improve the performance in the following prediction task</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Example Unsupervised Learning: Dimensionality Reduction</dt>
<dd>
<p><strong>Goal:</strong> Visualize the dataset</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_housing_example/dimred.png" alt="image" width="840">
</div>
<div class="title"><span class="small">The first step when working with a new dataset is usually to visualize it, to get a better overview of all the samples and their diversity. This is done with a dimensionality reduction algorithm, which takes the original high dimensional data as input, where each column (= feature) in the table is one dimension, and outputs a lower dimensional representation of the samples, i.e., a new matrix with fewer columns (usually two for a visualization). With these two new features, here called \(z_1\) and \(z_2\), we can create a scatter plot of the dataset, where each sample / row (in this case each apartment) is represented as one point in this new 2D coordinate system. We can think of this plot as a map of our dataset that enables us to view all data points at a glance. This plot often shows interesting patterns, for example, groups of similar points, which would be located close to each other in this 2D map. Please note that for most dimensionality reduction methods, it is not possible to describe what is behind this new coordinate system. Specifically, these are not just the two most informative original features, but completely new dimensions that summarize the information of the original inputs. To better interpret these plots, it is helpful to color the dots afterwards by some variable, which can then reveal the driving factors behind the most salient patterns in the dataset. In this example, we could have used the price of each apartment to color the respective dot in the map, which might then reveal that similarly priced apartments are arranged next to each other.</span></div>
</div>
</div>
</div>
<div class="ulist">
<div class="title"><span class="underline">Possible challenges:</span></div>
<ul>
<li>
<p>transforming the data with dimensionality reduction methods constructs new features as a (non)linear combination of the original features, which decreases the interpretability of the subsequent analysis results</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_anomaly_detection">Anomaly Detection</h4>
<div class="ulist">
<div class="title"><span class="underline">Use Cases:</span></div>
<ul>
<li>
<p>clean up the data, e.g., by removing samples with wrongly entered values, as a data preprocessing step to improve the performance in the following prediction task</p>
</li>
<li>
<p>create alerts for anomalies, for example:</p>
<div class="ulist">
<ul>
<li>
<p>fraud detection: identify fraudulent credit card transaction in e-commerce</p>
</li>
<li>
<p>monitor a machine to see when something out of the ordinary happens or the machine might require maintenance</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Example Unsupervised Learning: Anomaly Detection</dt>
<dd>
<p><strong>Goal:</strong> Find outliers in the dataset</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_housing_example/anomaly.png" alt="image" width="840">
</div>
<div class="title"><span class="small">Next, we can check the dataset for outliers and then subsequently correct or remove these samples. An outlier detection algorithm outputs for each sample an anomaly score, which indicates whether this data point deviates from the norm. We can use these scores to colorize the 2D map of the dataset generated in the previous step to see the anomalies in context. One drawback is that an anomaly detection algorithm does not tell us <em>why</em> it considers an individual point an outlier. A data scientist needs to examine the points identified as outlier to see, e.g., if these should be removed due to flawed measurements or if they constitute some interesting edge cases. In this example, the sample identified as an anomaly is an apartment that supposedly has a size of only 35 \(m^2\), but at the same time 5 bedrooms, i.e., most likely the person that originally entered the data made a mistake and the size of the listing should actually be 135 \(m^2\).</span></div>
</div>
</div>
</div>
<div class="ulist">
<div class="title"><span class="underline">Possible challenges:</span></div>
<ul>
<li>
<p>you should always have a good reason for throwing away data points&#8201;&#8212;&#8201;outliers are seldom random, sometimes they reveal interesting edge cases that should not be ignored</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_clustering">Clustering</h4>
<div class="ulist">
<div class="title"><span class="underline">Use Cases:</span></div>
<ul>
<li>
<p>identify groups of related data points, for example:</p>
<div class="ulist">
<ul>
<li>
<p>customer segmentation for targeted marketing campaign</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Example Unsupervised Learning: Clustering</dt>
<dd>
<p><strong>Goal:</strong> Find naturally occurring groups in the dataset</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_housing_example/clustering.png" alt="image" width="840">
</div>
<div class="title"><span class="small">We can also check if the dataset contains naturally occurring groups. This is accomplished with a clustering algorithm, which returns a cluster index for each sample, where points with the same index are in the same cluster. Please note that these cluster indices are not ordered and when running the algorithm again, the samples might be assigned different numbers, however, the groups of samples that were assigned the same number should still be in a cluster together, i.e., this cluster might now just be called &#8216;5&#8217; instead of &#8216;3&#8217;. These cluster indices can again be used to colorize the 2D map of the dataset to see the clusters in context. While a clustering algorithm groups similar points together, it does not tell us <em>why</em> the points were assigned to a cluster and what this cluster means. Therefore, the data scientist again needs to examine the results to try to describe the different clusters. In our example, the clusters might be &#8220;cheap studio apartments&#8221;, &#8220;large family apartments&#8221;, and &#8220;luxurious penthouses&#8221;. In unsupervised learning, there is no correct solution and a different algorithm might return different results. Just use the solution that is most helpful for your use case.</span></div>
</div>
</div>
</div>
<div class="ulist">
<div class="title"><span class="underline">Possible challenges:</span></div>
<ul>
<li>
<p>no ground truth: difficult to choose between different models and parameter settings &#8594; the algorithms will always find something, but whether this is useful (i.e., what the identified patterns mean) can only be determined by a human in a post-processing step</p>
</li>
<li>
<p>many of the algorithms rely on similarities or distances between data points, and it can be difficult to define an appropriate measure for this or know in advance which features should be compared (e.g., what makes two customers similar?)</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Unsupervised learning has no ground truth</strong></p>
</div>
<div class="paragraph">
<p>It is important to keep in mind that unsupervised learning problems have no right or wrong answers. Unsupervised learning algorithms simply recognize patterns in the data, which may or may not be meaningful for us humans.</p>
</div>
<div class="paragraph">
<p>For example, there exist a bunch of different unsupervised learning algorithms that group data points into clusters, each with a slightly different strategy and definition of what it means for two samples to be similar enough that they can be put into the same cluster.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/clustering_ambiguous3.png" alt="image" width="640">
</div>
<div class="title"><span class="small">The first instinct of a human is to group these images according to the fruit displayed on them, however, there is nothing inherently wrong with clustering the images based on a different characteristic, such as their background color, whether or not the fruit has a leaf attached, in which direction the stem is pointing, etc.</span></div>
</div>
<div class="paragraph">
<p>It is up to the data scientist to examine the results of an unsupervised learning algorithm and make sense of them. And if they don&#8217;t match our expectations, we can simply try a different algorithm.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_regression_classification">Regression &amp; Classification</h4>
<div class="ulist">
<div class="title"><span class="underline">Use Cases:</span></div>
<ul>
<li>
<p>Learn a model to describe an input-output relationship and make predictions for new data points, for example:</p>
<div class="ulist">
<ul>
<li>
<p>predict in advance whether a product produced under the proposed process conditions will be of high quality or would be a waste of resources</p>
</li>
<li>
<p>churn prediction: identify customers that are about to cancel their contract (or employees that are about to quit) so you can reach out to them and convince them to stay</p>
</li>
<li>
<p>price optimization: determine the optimal price for a product (often used for dynamic pricing, e.g., to adapt prices based on the device a customer uses (e.g., new iPhone vs old Android phone) when accessing a website)</p>
</li>
<li>
<p>predictive maintenance: predict how long a machine component will last</p>
</li>
<li>
<p>sales forecasts: predict revenue in the coming weeks and how much inventory will be required to satisfy the demand</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Example Supervised Learning: Classification</dt>
<dd>
<p><strong>Goal:</strong> Predict a discrete value for each data point</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_housing_example/classification.png" alt="image" width="840">
</div>
<div class="title"><span class="small">Next, we can predict whether an apartment will be sold for the listed price. Since the variable &#8220;sold&#8221; only takes on the discrete values &#8216;yes&#8217; (1) or &#8216;no&#8217; (0), this is a binary classification problem. A classification model uses the attributes of an apartment together with the listing&#8217;s price as inputs and predicts whether the apartment will be sold for this price. Since we have the true labels available for the initially collected dataset, we can evaluate how well the model performed by computing the number of wrong predictions it generated. This is the nice thing about supervised learning: We can objectively determine how good a solution is and benchmark different models against each other, while in unsupervised learning the data scientist needs to manually examine the results to make sense of them.</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Example Supervised Learning: Regression</dt>
<dd>
<p><strong>Goal:</strong> Predict a continuous value for each data point</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_housing_example/regression.png" alt="image" width="760">
</div>
<div class="title"><span class="small">Finally, we can predict a reasonable price for a listing. Since prices are continuous values, this is a regression problem, where the model uses as inputs the attributes of the apartments and predicts a suitable price. Again we have the true prices available and can compute the deviation of the regression model&#8217;s estimates from the original price set by a real estate agent.</span></div>
</div>
</div>
</div>
<div class="ulist">
<div class="title"><span class="underline">Possible challenges:</span></div>
<ul>
<li>
<p>success is uncertain: while it is fairly straightforward to apply the models, it is difficult to determine in advance whether there even exists any relation between the measured inputs and targets (&#8594; beware of garbage in, garbage out!)</p>
</li>
<li>
<p>appropriate definition of the output/target/KPI that should be modeled, i.e., what does it actually mean for a process to run well and how might external factors influence this definition (e.g., can we expect the same performance on an exceptionally hot summer day?)</p>
</li>
<li>
<p>missing important input variables, e.g., if there exist other influencing factors that we haven&#8217;t considered or couldn&#8217;t measure, which means not all of the target variable&#8217;s variance can be explained</p>
</li>
<li>
<p>lots of possibly irrelevant input variables that require careful feature selection to avoid <a href="https://www.tylervigen.com/spurious-correlations" target="\_blank">spurious correlations</a>, which would result in incorrect &#8216;what-if&#8217; forecasts since the true causal relationship between the inputs and outputs isn&#8217;t captured</p>
</li>
<li>
<p>often very time intensive data preprocessing necessary, e.g., when combining data from different sources and engineering additional features</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_deep_learning">Deep Learning</h4>
<div class="ulist">
<div class="title"><span class="underline">Use Cases:</span></div>
<ul>
<li>
<p>automate tedious, repetitive tasks otherwise done by humans, for example (see also <a href="#_ml_is_everywhere">ML is everywhere!</a>):</p>
<div class="ulist">
<ul>
<li>
<p>text classification (e.g., identify spam / hate speech / fake news; forward customer support request to the appropriate department)</p>
</li>
<li>
<p>sentiment analysis (subtask of text classification: identify if text is positive or negative, e.g., to monitor product reviews or what social media users are saying about your company)</p>
</li>
<li>
<p>speech recognition (e.g., transcribe dictated notes or add subtitles to videos)</p>
</li>
<li>
<p>machine translation (translate texts from one language into another)</p>
</li>
<li>
<p>image classification / object recognition (e.g., identify problematic content (like child pornography) or detect street signs and pedestrians in autonomous driving)</p>
</li>
<li>
<p>image captioning (generate text that describes what&#8217;s shown in an image, e.g., to improve the online experience for for people with visual impairment)</p>
</li>
<li>
<p>predictive typing (e.g., suggest possible next words when typing on a smartphone)</p>
</li>
<li>
<p>data generation (e.g., generate new photos/images of specific objects or scenes)</p>
</li>
<li>
<p>style transfer (transform a given image into another style, e.g., make photos look like van Gogh paintings)</p>
</li>
<li>
<p>separate individual sources of an audio signal (e.g., unmix a song, i.e., separate vocals and instruments into individual tracks)</p>
</li>
</ul>
</div>
</li>
<li>
<p>replace classical simulation models with ML models: since exact simulation models are often slow, the estimation for new samples can be speed up by instead predicting the results with an ML model, for example:</p>
<div class="ulist">
<ul>
<li>
<p>AlphaFold: generate 3D protein structure from amino acid sequence (to facilitate drug development)</p>
</li>
<li>
<p>SchNet: predict energy and other properties of molecules given their configuration of atoms (to speed up materials research)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title"><span class="underline">Possible challenges:</span></div>
<ul>
<li>
<p>selecting a suitable neural network architecture &amp; getting it to work properly; especially when replacing traditional simulation models it is often necessary to develop a completely new type of neural network architecture specifically designed for this task and inputs / outputs, which requires a lot of ML &amp; domain knowledge, intuition, and creativity</p>
</li>
<li>
<p>computational resources (don&#8217;t train a neural network without a GPU!)</p>
</li>
<li>
<p>data quality and quantity: need a lot of <em>consistently</em> labeled data, i.e., many training instances labeled by human annotators who have to follow the same guidelines (but can be mitigated in some cases by pre-training the network using self-supervised learning)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_information_retrieval">Information Retrieval</h4>
<div class="ulist">
<div class="title"><span class="underline">Use Cases:</span></div>
<ul>
<li>
<p>improve search results by identifying similar items: given a query, rank results, for example:</p>
<div class="ulist">
<ul>
<li>
<p>return matching documents / websites given a search query</p>
</li>
<li>
<p>show similar movies given the movie a user is currently looking at (e.g., same genre, director, etc.)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title"><span class="underline">Possible challenges:</span></div>
<ul>
<li>
<p>quality of results depends heavily on the chosen similarity metric; identifying semantically related items is currently more difficult for some data types (e.g., images) than others (e.g., text)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_recommender_systems">Recommender Systems</h4>
<div class="ulist">
<div class="title"><span class="underline">Use Cases:</span></div>
<ul>
<li>
<p>personalized suggestions: given a sample from one type of data (e.g., user, protein structure), identify the most relevant samples from another type of data (e.g., movie, drug composition), for example:</p>
<div class="ulist">
<ul>
<li>
<p>show a user movies that other users with a similar taste also liked</p>
</li>
<li>
<p>recommend molecule structures that could fit into a protein structure involved in a certain disease</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title"><span class="underline">Possible challenges:</span></div>
<ul>
<li>
<p>little / incomplete data, for example, different users might like the same item for different reasons and it is unclear whether, e.g., a user didn&#8217;t watch a movie because he&#8217;s not interested in it or because he just didn&#8217;t notice it yet</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_reinforcement_learning">Reinforcement Learning</h4>
<div class="ulist">
<div class="title"><span class="underline">Use Cases:</span></div>
<ul>
<li>
<p>Determine an optimal sequence of actions given changing environmental conditions, for example:</p>
<div class="ulist">
<ul>
<li>
<p>virtual agent playing a (video) game</p>
</li>
<li>
<p>robot with complex movement patterns, e.g., picking up differently shaped objects from a box</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#8658; Unlike in regular optimization, where the optimal inputs given a single specific external condition are determined, here an &#8220;agent&#8221; (= the RL algorithm) tries to learn an optimal <em>sequence</em> of inputs to maximize the cumulative reward received over multiple time steps, where there can be a significant time delay between the inputs and the rewards that they generate (e.g., in a video game we might need to pick up a key in the beginning of a level, but the door that can be opened with it only comes several frames later).</p>
</div>
<div class="ulist">
<div class="title"><span class="underline">Possible challenges:</span></div>
<ul>
<li>
<p>usually requires a simulation environment for the agent to learn in before it starts acting in the real world, but developing an accurate simulation model isn&#8217;t easy and the agent will exploit any bugs if that results in higher rewards</p>
</li>
<li>
<p>can be tricky to define a clear reward function that should be optimized (imitation learning is often a better option, where the agent instead tries to mimic the decisions made by a human in some situation)</p>
</li>
<li>
<p>difficult to learn correct associations when there are long delays between critical actions and the received rewards</p>
</li>
<li>
<p>agent generates its own data: if it starts off with a bad policy, it will be tricky to escape from this (e.g., in a video game, if the agent always falls down a gap instead of jumping over it, it never sees the rewards that await on the other side and therefore can&#8217;t learn that it would be beneficial to jump over the gap)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_other">Other</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
ML algorithms are categorized by the output they generate for each input. If you want to solve an &#8216;input &#8594; output&#8217; problem with a different output than the ones listed above, you&#8217;ll likely have to settle in for a multi-year research project&#8201;&#8212;&#8201;if the problem can be solved with ML at all!
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">To solve complex problems, we might need multiple algorithms</dt>
<dd>
<p>Example: virtual assistant (e.g., Siri or Alexa): &#8220;<em>Hey &lt;smart speaker&gt;, tell me a joke!</em>&#8221; &#8594; a random joke</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title"><span class="small">This might look like an input-output problem, but it would be very difficult and inefficient to solve it directly. Instead, we break the problem down into smaller subtasks that can be solved with existing algorithms:</span></div>
<p></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Trigger word detection:</strong><br>
audio &#8594; &#8220;Hey &lt;smart speaker&gt;&#8221; (yes/no)?</p>
</li>
<li>
<p><strong>Speech recognition:</strong><br>
audio &#8594; text</p>
</li>
<li>
<p><strong>Intent classification:</strong><br>
text &#8594; (joke/timer/weather/&#8230;&#8203;)?</p>
</li>
<li>
<p><strong>Request-specific program (e.g., select random joke)</strong></p>
</li>
<li>
<p><strong>Speech generation:</strong><br>
text &#8594; audio</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title"><span class="small">First, the smart speaker needs to know whether it was activated with a specific trigger word (e.g., &#8220;Hey Siri&#8221;). This is a simple binary classification task (trigger word: yes/no), which is usually performed on the device itself, since we don&#8217;t want that everything we say is continuously streamed into the cloud. Next, the spoken words that follow the trigger word are transcribed into text. Text is easier to handle, because, for example, variations due to different accents are removed. Based on this text, the intent is recognized, i.e., which of the different functionalities of the virtual assistant should be used (e.g., tell a joke, play music, set an alarm, etc.). This is a multi-class classification problem. The next step is to execute the request, which is not done with ML, but instead some task-specific program is run, e.g., to select a joke from a database or set a timer, etc., based on the apps installed on the device. Finally, the output of the program needs to be converted back into an audio signal. For this again an ML model can help to get smoothly spoken text&#8201;&#8212;&#8201;and in the near future maybe with the voice of Morgan Freeman or some other famous person like in "Deep Fake" applications.</span></div>
<p><br>
&#8658; It is generally advisable to first think about how a problem could be decomposed into easier-to-solve subproblems, especially since there might already be a large dataset or pre-trained ML model available for one of these subtasks. For example, speech recognition models can be trained on audio books and transcribed political speeches in addition to the data collected from the smart speaker users.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
When one ML model receives as input the output of another ML model, this means as soon as we roll out a new version of the ML model at the beginning of the chain, we should also retrain the models following this one, since they might now receive slightly different inputs, i.e., experience a
<a href="#_data_concept_drifts">data drift</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_solving_problems_with_ml">Solving problems with ML</h3>
<div class="paragraph">
<p>Solving &#8220;input &#8594; output&#8221; problems with ML requires three main steps:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/input_output_solving_abstract6.png" alt="image" width="680">
</div>
</div>
<div class="sect3">
<h4 id="_1_identify_a_suitable_problem">1. Identify a suitable problem</h4>
<div class="paragraph">
<p>The first (and arguably most important) step is to <strong>identify where machine learning can (and should) be used</strong> in the first place.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph lead">
<p>ML project checklist</p>
</div>
<div class="paragraph">
<p><span class="underline">Motivation</span></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>What problem do you want to solve?</strong><br>
Machine learning can help you in various ways by generating insights from large amounts of (possibly unstructured) data, improving decision making and planning processes by providing predictions about future events, or automating tedious tasks otherwise requiring human experts.<br>
Where do you see a lot of inefficiencies around you that could be mitigated by a better use of data? For example, you could look for opportunities to decrease wasted resources / time / costs or increase revenue / customer satisfaction / etc.<br>
To systematically identify problems or opportunities, it can be helpful to create a process map or customer journey map.</p>
</li>
<li>
<p><strong>In what way(s) would this generate value for your organization?</strong><br>
How could your organization make money on this or reduce costs?<br></p>
<div class="ulist">
<ul>
<li>
<p>Could this <em>improve an internal process</em> (e.g., maybe a process can be run more efficiently with the insights from an analysis or a tedious task that would otherwise require a human worker can be automated using an ML model)?</p>
</li>
<li>
<p>Could the ML model be integrated as a <em>new feature within an existing product</em> and thereby, e.g., make this product more appealing to customers?</p>
</li>
<li>
<p>Could the ML solution be sold as an entirely <em>new product</em>, e.g., offered as a <em>Software-as-a-Service (SaaS) solution</em>?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="small">Please note that how the ML solution will be used in the end might also be a strategic decision that can be different for every organization. For example, an ML solution that recognizes scratches in produced products might be used by one company to improve their internal production process, while another company that produces the machines that make the products could integrate this as a new feature in their machines, and a third company might offer this as a SaaS solution compatible with different production lines.</span></p>
</div>
</li>
<li>
<p><strong>How do you know you&#8217;ve accomplished your goal?</strong><br>
What would success look like, i.e., what&#8217;s your definition of &#8216;done&#8217;? Can you quantify the progress towards your goal with a KPI?<br>
What is the status quo, i.e., how far are your from your goal right now?</p>
</li>
<li>
<p><strong>What impact would this project have?</strong><br>
Think of the impact in terms of</p>
<div class="ulist">
<ul>
<li>
<p><em>Magnitude:</em> Small improvement or revolution? Will the solution result in a <a href="#_ai_transformation_of_a_company">strategic advantage</a>?</p>
</li>
<li>
<p><em>Scale:</em> How often will this be used? How many users/customers/employees will benefit?<br></p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Small process optimization, <em>but</em> since this process is used everyday in the whole organization it saves countless hours<br></p>
</li>
<li>
<p>New feature that revolutionizes the product and sets you apart from the competition, <em>but</em> the market for it is tiny</p>
</li>
</ul>
</div>
</li>
<li>
<p>Would this have any <em>valuable side effects</em>? What will be different? Any additional opportunities that could arise from this? Can you create synergies between departments that work with similar data?</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="underline">Solution Outline</span></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>What are the deliverables?</strong><br>
Does the solution consist of a piece of <strong>software</strong> that is deployed somewhere to continuously make predictions for new data points, or are you more interested in the <strong>insights</strong> gained from an one-off analysis?</p>
</li>
<li>
<p><strong>Is there a simpler solution, i.e., without <a href="#_what_is_ml">using ML</a>?</strong><br>
Use ML to learn <em>unknown, complex</em> rules from data.</p>
</li>
<li>
<p><strong>Can the problem be solved with an <a href="#_ml_use_cases">existing ML algorithm</a>?</strong><br>
Ask an ML expert whether a similar problem has already been solved before. Instead of spending years on research to come up with a novel algorithm, it might also be possible to break the input-output problem down into simpler subproblems with known solutions.</p>
</li>
<li>
<p><strong>What is the input data?</strong></p>
<div class="ulist">
<ul>
<li>
<p>What is one data point / sample / observation?</p>
</li>
<li>
<p>What kind of inputs does the ML model receive (e.g., image / text / sensor measurements / etc.)?</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>In case of a software solution, how will the ML model be integrated with the existing setup?</strong><br></p>
<div class="ulist">
<ul>
<li>
<p>From which system are the inputs for the ML model coming from? What happens to the outputs of the ML model?</p>
</li>
<li>
<p>How will the ML model be deployed (e.g., cloud or edge device&#8201;&#8212;&#8201;see step 3 below)? Does this require any special hardware?</p>
</li>
<li>
<p>What are the plans w.r.t. pipelines for future data collection, model monitoring, and automated retraining?</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Should you <span class="underline">build</span> this yourself or can you <span class="underline">buy</span> it?</strong><br>
Does the solution require unique subject matter expertise only available at your organization, e.g., because you&#8217;re analyzing data generated by your own specific processes/machines and/or will the solution be a key part of your business, e.g., a new feature that makes your product more attractive?<br>
Or is this a common (but complex) problem, for which a solution already exists (e.g., offered as a Software-as-a-Service (SaaS) product), that you could buy off the shelf? For example, extracting the relevant information from scanned invoices to automate bookkeeping processes is a relatively complex task for which many good solutions already exist, so unless you are working in a company building bookkeeping software and plan to sell a better alternative to these existing solutions, it probably doesn&#8217;t make sense to implement this yourself.</p>
<div class="paragraph">
<p>Some general points you might want to consider when deciding whether to buy an ML solution or build it yourself:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How much effort would be required in terms of preprocessing your data before you could use the off-the-shelf ML solution?</p>
</li>
<li>
<p>How difficult would it be to integrate the output from the off-the-shelf ML solution into your general workflow? Does it do exactly what you need or would additional post-processing steps be required?</p>
</li>
<li>
<p>How reliable is the off-the-shelf ML solution? Are there any benchmarks available and/or can you test it with some common examples and edge cases yourself?</p>
</li>
<li>
<p>How difficult would it be to implement the ML solution yourself? For example, what kind of open source libraries exist that solve such a task? Do you have the necessary ML talent or would you need to hire, e.g., freelancers?</p>
</li>
<li>
<p>Can the off-the-shelf ML solution be deployed in-house or does it run on an external server and would this bring with it any data privacy issues?</p>
</li>
<li>
<p>How high are the on-going licensing fees and what is included in terms of maintenance (e.g., how frequently are the models retrained)?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unless the ML solution will be an integral part of your business, in the end it will probably come down to comparing costs for developing, implementing, running, and maintaining the system yourself vs. costs for integrating the off-the-shelf solution into your existing workflow (incl. necessary data preprocessing) and on-going licensing fees.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="underline">Challenges &amp; Risks</span></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Is there <a href="#_garbage_in_garbage_out">enough high-quality data</a> available?</strong><br>
ML models need the right inputs and learn best from unambiguous targets.</p>
<div class="ulist">
<ul>
<li>
<p>How much data was already collected (including rare events)? Is this the right data or do you need, e.g., additional labels?<br>
&#8594; Ask a subject matter expert whether she thinks all the relevant input data is available to compute the desired output. This is usually easy to determine for unstructured data such as images&#8201;&#8212;&#8201;if a human can see the thing in the image, ML should too. But for structured data, such as a spreadsheet with hundreds of columns of sensor measurements, this might be impossible to tell before doing any analysis on the data.</p>
</li>
<li>
<p>How difficult is it to get access to all of the data and combine it neatly in one place? Who would you talk to, to set up / improve the data infrastructure?</p>
</li>
<li>
<p>How much preprocessing is necessary (e.g., feature engineering, i.e., computing new variables from the existing measurements)? What should be the next steps to improve data quality and quantity?</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>What would be the worst case scenario when the model is wrong?</strong><br>
Your ML system (like humans) will make mistakes. This is especially true since your input data will probably change over time and users might even try to intentionally deceive the system (e.g., spammers come up with more sophisticated messages if their original ones are caught by the spam filter).<br>
What would be the worst case scenario and how much risk are you willing to take?<br>
Instead of going all in with ML from day 1, is there a way your system can be monitored in the beginning while still providing added value (i.e., human-in-the-loop solution)?</p>
</li>
<li>
<p><strong>What else could go wrong (e.g., legal issues / ethical concerns)?</strong><br>
Are there any concerns w.r.t. data privacy? What about accountability, i.e., do the decisions of the machine learning model need to be transparent, for example, if someone is denied credit because of an algorithmically generated credit score? Why might users get frustrated with the solution?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more details check out <a href="https://towardsdatascience.com/the-ultimate-guide-to-starting-ai-d506255d7ea" target="\_blank">this blog article</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_2_devise_a_working_solution">2. Devise a working solution</h4>
<div class="paragraph">
<p>Once a suitable &#8220;input &#8594; output&#8221; problem as been identified, <strong>historical data needs to be gathered and the right ML algorithm needs to be selected and applied</strong> to obtain a working solution. This is what the next chapters are all about.</p>
</div>
<div class="paragraph">
<p>To solve a concrete problem using ML, we follow a workflow like this:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01c_ds_workflow/data_science_workflow_17.png" alt="image" width="840">
</div>
<div class="title"><span class="small">We always start with some kind of question or problem that should be solved with ML. And to solve it, we need data, which we most likely have to clean before we can work with it (e.g., merge different excel files, fix missing values, etc.). Then it&#8217;s time for an exploratory analysis to better understand what we&#8217;re dealing with. Depending on the type of data, we also need to extract appropriate features or engineer additional ones, for which domain knowledge / subject matter expertise is invaluable. All these steps are grouped under "preprocessing" <em>(red box)</em> and the steps are not linear, as we often find ourselves jumping back and forth between them. For example, by visualizing the dataset, we realize that the data contains some outliers that need to be removed, or after engineering new features, we go back and visualize the dataset again. Next comes the ML part <em>(green box)</em>: we normally start with some simple model, evaluate it, try a more complex model, experiment with different hyperparameters, &#8230;&#8203; and at some point realize, that we&#8217;ve exhausted our ML toolbox and are still not happy with the performance. This means we need to go back and either engineer better features or, if this also doesn&#8217;t help, collect more and/or better data (e.g., more samples, data from additional sensors, cleaner labels, etc.). Finally, when we&#8217;re confident in the model&#8217;s predictions, there are two routes we can take: Either the data science route, where we communicate our findings to the stakeholders (which most likely results in further questions). Or the ML software route, where the final model is deployed in production. Here it is important to continuously monitor the model&#8217;s performance and collect new data such that the model can be retrained, especially as the inevitable data or concept drifts occur. Above all, working on a machine learning project is a very iterative process.</span></div>
</div>
<div class="paragraph">
<p>Unfortunately, due to a lack of standardized data infrastructure in many companies, the sad truth is that usually (at least) about 90% of a Data Scientist&#8217;s time is spent collecting, cleaning, and otherwise preprocessing the data to get it into a format where the ML algorithms can be applied:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01c_ds_workflow/data_science_workflow_19.png" alt="image" width="840">
</div>
</div>
<div class="paragraph">
<p>While sometimes frustrating, the time spent cleaning and preprocessing the data is never wasted, as only with a solid data foundation the ML algorithms can achieve decent results.</p>
</div>
</div>
<div class="sect3">
<h4 id="_3_get_it_ready_for_production">3. Get it ready for production</h4>
<div class="paragraph">
<p>When the prototypical solution has been implemented and meets the required performance level, this solution then has to be deployed, i.e., <strong>integrated into the general workflow and infrastructure</strong> so that it can actually be used to improve the respective process in practice (as a piece of software that continuously makes predictions for new data points). There are generally two strategies for how to do this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>The ML model runs on an &#8220;edge&#8221; device</strong>, i.e., on each individual machine (e.g., mobile phone) where the respective data is generated and the output of the model is used in subsequent process steps. This is often the best strategy when results need to be computed in real time and / or a continuous Internet connection can not be guaranteed, e.g., in self-driving cars. However, the downside of this is that, depending on the type of ML model, comparatively expensive computing equipment needs to be installed in each machine, e.g., GPUs for neural network models.</p>
</li>
<li>
<p><strong>The ML model runs in the &#8220;cloud&#8221;</strong>, i.e., on a central server, e.g., in the form of a web application that receives data from individual users, processes it, and sends back the results. This is often the more efficient solution, if a response within a few seconds is sufficient for the use case. However, processing personal information in the cloud also raises privacy concerns. One of the major benefits of this solution is that it is easier to update the ML model, for example, when more historical data becomes available or if the process changes and the model now has to deal with slightly different inputs (we&#8217;ll discuss this further in later chapters).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>&#8594; As these decisions heavily depend on your specific use case, they go beyond the scope of this book. Search online for &#8220;MLOps&#8221; or read the book <a href="https://www.oreilly.com/library/view/designing-machine-learning/9781098107956/">Designing Machine Learning Systems</a> to find out more about these topics and hire a machine learning or data engineer to set up the required infrastructure in your company.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ml_with_python">ML with Python</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://github.com/cod3licious/ml_exercises" target="\_blank">exercises</a> accompanying this book use the programming language Python.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Why Python?</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>free &amp; open source (unlike, e.g., MatLab)</p>
</li>
<li>
<p>easy; fast prototyping</p>
</li>
<li>
<p>general purpose language (unlike, e.g., R): easy to incorporate ML into regular applications or web apps</p>
</li>
<li>
<p>fast: many numerical operations are backed with C libraries</p>
</li>
<li>
<p>a lot of <strong>open source ML libraries</strong> with a very active community!!</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">How?</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>regular scripts (i.e., normal text files ending in <code>.py</code>), especially useful for function definitions that can be reused in different projects</p>
</li>
<li>
<p><a href="https://ipython.readthedocs.io/en/stable/">iPython shell</a>: interactive console to execute code</p>
</li>
<li>
<p><a href="https://jupyter.org/">Jupyter Notebooks</a> (i.e., special files ending in <code>.ipynb</code>): great for experimenting &amp; sharing work with others (also works with other programming languages: Jupyter stands for Julia, Python, and R; you can even mix languages in the same notebook)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If you&#8217;re unfamiliar with Python, have a look at <a href="https://github.com/cod3licious/python_tutorial" target="\_blank"><strong>this Python tutorial</strong></a> specifically written to teach you the basics needed for the examples in this book. This <a href="https://franziskahorn.de/mlws_resources/cheatsheet.pdf" target="\_blank">cheat sheet</a> additionally provides a summary of the most important steps when developing a machine learning solution, incl. code snippets using the libraries introduced below.</p>
</div>
<div class="paragraph lead">
<p><strong>Overview of Python Libraries for ML</strong></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The libraries are always imported with specific abbreviations (e.g., <code>np</code> or <code>pd</code>). It is highly recommended that you stick to these conventions and you will also see this in many code examples online (e.g., on StackOverflow).
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://numpy.org/" target="\_blank"><code><strong>numpy</strong></code></a> (&amp; <a href="https://www.scipy.org/" target="\_blank"><code><strong>scipy</strong></code></a>)</dt>
<dd>
<p>everything needed for scientific computing, incl. random numbers, linear algebra, basic statistics, and optimization. The main data structure to represent vectors and matrices is the numpy array (e.g., <code>np.array([1,2])</code>).</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">  <span class="keyword">import</span> <span class="include">numpy</span> <span class="keyword">as</span> np</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://pandas.pydata.org/" target="\_blank"><code><strong>pandas</strong></code></a></dt>
<dd>
<p>higher level data manipulation with data stored in a <code>DataFrame</code> table similar to R; very useful for loading data, cleaning, and some exploration with different plots</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">  <span class="keyword">import</span> <span class="include">pandas</span> <span class="keyword">as</span> pd</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://matplotlib.org/" target="\_blank"><code><strong>matplotlib</strong></code></a> (&amp; <a href="https://seaborn.pydata.org/" target="\_blank"><code><strong>seaborn</strong></code></a>)</dt>
<dd>
<p>create plots (e.g., <code>plt.plot()</code>, <code>plt.scatter()</code>, <code>plt.imshow()</code>).</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">  <span class="keyword">import</span> <span class="include">matplotlib.pyplot</span> <span class="keyword">as</span> plt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://plotly.com/python/" target="\_blank"><code><strong>plotly</strong></code></a></dt>
<dd>
<p>create interactive plots (e.g., <code>px.parallel_coordinates()</code>)</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">  <span class="keyword">import</span> <span class="include">plotly.express</span> <span class="keyword">as</span> px</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://scikit-learn.org/stable/" target="\_blank"><code><strong>scikit-learn</strong></code></a></dt>
<dd>
<p>includes a lot of (non-deep learning) machine learning algorithms, preprocessing tools, and evaluation functions with an <em>unified interface</em>, i.e., all models (depending on their type) have these <code>.fit()</code>, <code>.transform()</code>, and/or <code>.predict()</code> methods, which makes it very easy to switch out models in the code by just changing the line where the model was initialized</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">  <span class="comment"># import the model class from the specific submodule</span>
  <span class="keyword">from</span> <span class="include">sklearn.xxx</span> <span class="keyword">import</span> <span class="include">Model</span>
  <span class="keyword">from</span> <span class="include">sklearn.metrics</span> <span class="keyword">import</span> <span class="include">accuracy_score</span>

  <span class="comment"># initialize the model (usually we also set some parameters here)</span>
  model = Model()

  <span class="comment"># preprocessing/unsupervised learning methods:</span>
  model.fit(X)  <span class="comment"># only pass feature matrix X</span>
  X_transformed = model.transform(X)  <span class="comment"># e.g., the StandardScaler would return a scaled feature matrix</span>

  <span class="comment"># supervised learning methods:</span>
  model.fit(X, y)  <span class="comment"># pass features and labels for training</span>
  y_pred = model.predict(X_test)  <span class="comment"># generate predictions for new points</span>
  <span class="comment"># evaluate the model (the internal score function uses the model's prefered evaluation metric)</span>
  print(<span class="string"><span class="delimiter">&quot;</span><span class="content">The model is this good:</span><span class="delimiter">&quot;</span></span>, model.score(X_test, y_test))  <span class="comment"># .score() internally calls .predict()</span>
  print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Equivalently:</span><span class="delimiter">&quot;</span></span>, accuracy_score(y_test, y_pred))</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://pytorch.org/" target="\_blank"><code><strong>torch</strong></code></a> (or <a href="https://keras.io/" target="\_blank"><code><strong>keras</strong></code></a>)</dt>
<dd>
<p>neural network models (more details on these libraries in the section on neural networks)</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">   <span class="keyword">import</span> <span class="include">torch</span>
  (<span class="keyword">from</span> <span class="include">tensorflow</span> <span class="keyword">import</span> <span class="include">keras</span>)</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Additional useful libraries to publish and share your work: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://fastapi.tiangolo.com/" target="\_blank"><code>FastAPI</code></a> (easy way to create APIs, e.g., so that your models can be queried through an endpoint on the web)</p>
</li>
<li>
<p><a href="https://streamlit.io/" target="\_blank"><code>streamlit</code></a> (create interactive dashboards and web apps from simple Python scripts)</p>
</li>
<li>
<p><a href="https://papermill.readthedocs.io/en/latest/" target="\_blank"><code>papermill</code></a> (parametrize Jupyter notebooks, e.g., to create reports from templates)</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Additional useful Natural Language Processing (NLP) libraries: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://huggingface.co/" target="\_blank"><code>transformers</code></a> (Hugging Face: pre-trained neural network models for different tasks)</p>
</li>
<li>
<p><a href="https://spacy.io/" target="\_blank"><code>spacy</code></a> (modern &amp; fast NLP tools)</p>
</li>
<li>
<p><a href="https://www.nltk.org/" target="\_blank"><code>nltk</code></a> (traditional NLP tools)</p>
</li>
<li>
<p><a href="https://radimrehurek.com/gensim/" target="\_blank"><code>gensim</code></a> (topic modeling)</p>
</li>
<li>
<p><a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" target="\_blank"><code>beautifulsoup</code></a> (for parsing websites)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_analysis_preprocessing">Data Analysis &amp; Preprocessing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As we&#8217;ve seen, ML algorithms solve input-output tasks. And to solve an ML problem, we first need to collect data, understand it, and then transform (&#8220;preprocess&#8221;) it in such a way that ML algorithms can be applied:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01c_ds_workflow/data_science_workflow_prepr.png" alt="image" width="840">
</div>
</div>
<div class="sect2">
<h3 id="_data_analysis">Data Analysis</h3>
<div class="paragraph">
<p>Analyzing data is not only an important step before using this data for a machine learning project, but can also generate valuable insights that result in better (data-driven) decisions.
We usually analyze data for one of two reasons:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We need some specific information to make a (better) decision (<em>reactive analysis</em>, e.g., when something went wrong and we don&#8217;t know why).</p>
</li>
<li>
<p>We&#8217;re curious about the data and don&#8217;t know yet what the analysis will bring (<em>proactive analysis</em>, e.g., to better understand the data at the beginning of an ML project).</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Data analysis results can be obtained and communicated in different formats</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>A <strong>custom analysis</strong> with results presented, e.g., in a power point <strong>presentation</strong></p>
</li>
<li>
<p>A <strong>standardized report</strong>, e.g., in form of a PDF document, showing static data visualizations of historical data</p>
</li>
<li>
<p>A <strong>dashboard</strong>, i.e., a web app showing (near) real-time data, usually with some interactive elements (e.g., options to filter the data)</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/analysis_methods.png" alt="image" width="450">
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>While the data story that is told in a presentation is usually fixed, users have more opportunities to interpret the data and analyze it for themselves in an interactive dashboard.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>What all forms of data analyses have in common is that we&#8217;re after &#8220;(actionable) insights&#8221;.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">What is an insight?</dt>
<dd>
<p>Psychologist Gary Klein defines an insight as &#8220;an unexpected shift in the way we understand things&#8221;.</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/insight.png" alt="image" width="400">
</div>
<div class="title"><span class="small">Things get interesting when we find something in the data that we didn&#8217;t expect. [Adapted from: <em>Effective Data Storytelling</em> by Brent Dykes]</span></div>
</div>
<div class="paragraph">
<p>Arriving at an insight requires two steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Notice something unexpected</strong>, e.g., a sudden drop or increase in some metric.</p>
</li>
<li>
<p><strong>Understand why this happened</strong>, i.e., dig deeper into the data to identify the root cause.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When we understand why something happened, we can often also <strong>identify a potential action that could get us back on track</strong>, thereby making this an <em>actionable insight</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Knowing which values are unexpected and where it might pay off to dig deeper often requires some domain knowledge, so you might want to examine the results <strong>together with a subject matter expert</strong>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>Ideally, we should continuously <strong>monitor important metrics in dashboards or reports</strong> to spot deviations from the norm as quickly as possible, while <strong>identifying the root cause often requires a custom analysis</strong>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/analysis_monitoring.png" alt="image" width="450">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
As a data analyst you are sometimes approached with <strong>more specific questions or requests</strong> such as &#8220;We&#8217;re deciding where to launch a new marketing campaign. Can you show me the number of users for all European countries?&#8221;. In these cases it can be helpful to <strong>ask &#8220;why?&#8221; to understand where the person noticed something unexpected</strong> that prompted this analysis request. If the answer is &#8220;Oh, we just have some marketing budget left over and need to spend the money somewhere&#8221; then just give them the results. But if the answer is &#8220;Our revenue for this quarter was lower than expected&#8221; it might be worth <strong>exploring other possible root causes</strong> for this, as maybe the problem is not the number of users that visit the website, but that many users drop out before they reach the checkout page and the money might be better invested in a usability study to understand why users don&#8217;t complete the sale.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_data_driven_decisions">Data-driven Decisions</h4>
<div class="paragraph">
<p>While learning something about the data and its context is often interesting and can feel rewarding by itself, it is not yet valuable.
Insights become valuable when they influence a decision and inspire a different course of action, better than the default that would have been taken without the analysis.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/analysis_process.png" alt="image" width="650">
</div>
</div>
<div class="paragraph">
<p>This means we need to understand <strong>which decision(s)</strong> the insights from our data analysis should influence.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Not all decisions need to be made in a data-driven way. But decision makers should be transparent and upfront about whether a decision can be influenced by analysis results, i.e., what data would make them change their mind and choose a different course of action. If data is only requested to support a decision that in reality has already been made, save the analysts the time and effort!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before we conduct a data analysis we need to be clear on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Who are the <strong>relevant stakeholders</strong>, i.e., who will consume the data analysis results (= our audience / dashboard users)?</p>
</li>
<li>
<p>What is <strong>their goal</strong>?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In business contexts, the users' goals are usually in some way related to making a profit for the company, i.e., increasing revenue (e.g., by solving a customer problem more effectively than the competition) or reducing costs.</p>
</div>
<div class="paragraph">
<p>The progress towards these goals is tracked with so called <strong><em>Key Performance Indicators</em> (KPIs)</strong>, i.e., custom metrics that tell us how well things are going. For example, if we&#8217;re working on a web application, one KPI we might want to track could be &#8220;user happiness&#8221;. Unfortunately, true user happiness is difficult to measure, but we can instead check the number of users returning to our site and how long they stay and then somehow combine these and other measurements into a proxy variable that we then call &#8220;user happiness&#8221;.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
A KPI is only a reliable measure, if it is not simultaneously used to control people&#8217;s behavior, as they will otherwise try to game the system (<a href="https://en.wikipedia.org/wiki/Goodhart%27s_law" target="\_blank">Goodhart&#8217;s Law</a>). For example, if our goal is high quality software, counting the number of bugs in our software is not a reliable measure for quality, if we simultaneously <a href="https://dilbert.com/strip/1995-11-13" target="\_blank">reward programmers for every bug they find and fix</a>.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Lagging vs. Leading KPIs</dt>
<dd>
<p>Unfortunately, the things we really care about can often only be <strong>measured after the fact, i.e., when it is too late to take corrective action</strong>. For example, in sales we care about &#8220;realized revenue&#8221;, i.e., money in the bank, but if the revenue at the end of the quarter is less than what we hoped for, we can only try to do better next quarter. These metrics are called <strong>lagging KPIs</strong>.<br>
<strong>Leading KPIs</strong> instead tell us when we should <strong>act before it&#8217;s too late</strong>. For example, in sales this could be the volume of deals in the sales pipeline, i.e., while not all of these deals might eventually go through and result in realized revenue, if the pipeline is empty we know for certain that we wont reach our revenue goals.</p>
<div class="paragraph">
<p>If the causal relationships between variables are too complex to identify leading KPIs directly, we can instead try to <strong>use a machine learning model to predict lagging KPIs</strong>. For example, in a polymer production process, an important quality metric may be the tensile strength measured 24 hours after the polymer hardens. Waiting for these results could lead to discarding the last 24 hours of production if the quality is subpar.
If the relationships between the process parameters (such as production temperature) and the resulting quality are too complex to identify a leading KPI, we could instead train an ML model on the past process parameters (inputs) and corresponding quality measurements (outputs) to then continuously predict the quality during production. When the model predicts that the quality is off-target, the operators can intervene and fix issues before significant production time is wasted.<br>
However, relying on an ML model introduces the need to monitor its predictions for trustworthiness. In our example, the <strong>prediction accuracy on new data serves as a lagging KPI</strong>, as we only know whether the predictions are correct after real measurements arrive 24 hours later. As a <strong>leading KPI</strong>, we can measure the discrepancy between process parameter values used in model training and those received in production to identify <strong>dataset drifts</strong>. These drifts, such as changes in values due to sensor malfunctions, can lead to inaccurate predictions for affected samples.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The first step when making a data-driven decision is to <strong>realize that we should act by monitoring our KPIs</strong> to see whether we&#8217;re on track to achieve our goals.</p>
</div>
<div class="paragraph">
<p>Ideally, this is achieved by combining these metrics with <strong>thresholds for alerts</strong> to automatically notify us if things go south and a corrective action becomes necessary. For example, we could establish some alert on the health of a system or machine to notify a technician when maintenance is necessary. To <strong>avoid alert fatigue</strong>, it is important to reduce false alarms, i.e., configure the alert such that the responsible person tells you &#8220;when this threshold is reached, I will drop everything else and go fix the problem&#8221; (<em>not</em> &#8220;at this point we should probably keep an eye on it&#8221;).</p>
</div>
<div class="paragraph">
<p>Depending on how frequently the value of the KPI changes and how quickly corrective actions show effects, we want to check for the alert condition either every few minutes to alert someone in real time or, for example, every morning, every Monday, or once per month if the values change more slowly.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Is this significant?</dt>
<dd>
<p>Small variations in KPIs are normal and we should not overreact to noise. Statistics can tell us <strong>whether the observed deviation from what we expected is significant</strong>.</p>
<div class="paragraph">
<p>Statistical inference enables us to <strong>draw conclusions that reach beyond the data at hand</strong>. Often we would like to make a statement about a whole <em>population</em> (e.g., all humans currently living on this earth), but we only have access to a few (hopefully representative) observations to draw our conclusion from. Statistical inference is about changing our mind under uncertainty: We start with a null hypothesis (i.e., what we expected before looking at the data) and then check if what we see in the sample dataset makes this null hypothesis look ridiculous, at which point we reject it and go with our alternative hypothesis instead.<br>
<span class="underline">Example:</span> <em>Your company has an online store and wants to roll out a new recommendation system, but you are unsure whether customers will find these recommendations helpful and buy more. Therefore, before going live with the new system, you perform an A/B test, where a percentage of randomly selected users see the new recommendations, while the others are routed to the original version of the online store. The null hypothesis is that the new version is no better than the original. But it turns out that the average sales volume of customers seeing the new recommendations is a lot higher than that of the customers browsing the original site. This difference is so large that in a world where the null hypothesis was true, it would be extremely unlikely that a random sample would give us these results. We therefore reject the null hypothesis and go with the alternative hypothesis, that the new recommendations generate higher sales.</em></p>
</div>
<div class="paragraph">
<p>In addition to rigorous statistical tests, there are also some rules of thumb to determine whether changes in the data warrant our attention: If a single sample lies three standard deviations (\(\sigma\)) above or below the mean or seven consecutive points fall above or below the average value, this is cause for further investigation.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/control_chart.png" alt="image" width="550">
</div>
<div class="title"><span class="small">A control chart showing measurements taken over time that fluctuate around their mean value with points of interest marked in red.</span></div>
</div>
<div class="paragraph">
<p><span class="small">Read <a href="https://towardsdatascience.com/whats-the-difference-between-analytics-and-statistics-cd35d457e17" target="\_blank">this article</a> to learn more about the difference between analysts and statisticians and why they should work on distinct splits of your dataset.</span></p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For every alert that is created, i.e., every time it is clear that a corrective action is needed, it is worth considering whether this action can be automated and to directly <strong>trigger this automated action together with the alert</strong> (e.g., if the performance of an ML model drops below a certain threshold, instead of just notifying the data scientist we could automatically trigger a retraining with the most recent data). If this is not possible, e.g., because it is not clear what exactly happened and therefore which action should be taken, we need a deeper analysis.</p>
</div>
<div class="paragraph">
<p>Digging deeper into the data can help us answer questions such as &#8220;Why did we not reach this goal and how can we do better?&#8221; (or, in rarer cases, &#8220;Why did we exceeded this goal and how can we do it again?&#8221;) to <strong>decide on the specific action</strong> to take.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Don&#8217;t just look for data that confirms the story you want to tell and supports the action you wanted to take from the start (i.e., beware of confirmation bias)! Instead be open and actively try to disprove your hypothesis.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Such an exploratory analysis is often a quick and dirty process where we <strong>generate lots of plots to better understand the data</strong> and where the difference between what we expected and what we saw in the data is coming from, e.g., by examining other correlated variables. However, arriving at satisfactory answers is often more art than science.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When using an ML model to predict a KPI, we can interpret this model and its predictions to better understand which variables might influence the KPI. <strong>Focusing on the features deemed important by the ML model</strong> can be helpful if our dataset contains hundreds of variables and we don&#8217;t have time to look at all of them in detail. But use with caution&#8201;&#8212;&#8201;the model only learned from correlations in the data; these do not necessarily represent true causal relationships between the variables.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Analysis questions to answer before an ML project</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Examine the raw data:</p>
<div class="ulist">
<ul>
<li>
<p>Is the dataset complete, i.e., does it contain all the variables and samples we expected to get?</p>
</li>
</ul>
</div>
</li>
<li>
<p>Examine summary statistics (e.g., mean, standard deviation (std), min/max values, missing value count, etc.), for example, by calling <code>df.describe()</code> on a pandas data frame:</p>
<div class="ulist">
<ul>
<li>
<p>What does each variable mean? Given our understanding of the variable, are its values in a reasonable range?</p>
</li>
<li>
<p>Are missing values encoded as NaN (Not a Number) or as &#8216;unrealistic&#8217; numeric values (e.g., -1 while normal values are between 0 and 100)?</p>
</li>
<li>
<p>Are missing values random or systematic (e.g., in a survey rich people are less likely to answer questions about their income or specific measurements are only collected under certain conditions)? &#8594; This can influence how missing values should be handled during preprocessing, e.g., whether it makes sense to impute them with the mean or some other specific value (e.g., zero).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Examine the distributions of individual variables (e.g., using histograms):</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/exploratory_dist.png" alt="image" width="400">
</div>
<div class="title"><span class="small">Histogram, strip plot, violin plot, box plot, and summary statistics of the same data.</span></div>
</div>
<div class="ulist">
<ul>
<li>
<p>Are there any outliers? Are these genuine edge cases or can they be ignored (e.g., due to measurement errors or wrongly encoded data)?</p>
</li>
<li>
<p>Is the data normally distributed (otherwise we may have to transform the variable later)?</p>
</li>
</ul>
</div>
</li>
<li>
<p>Examine trends over time (by plotting variables over time):</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/exploratory_lines.png" alt="image" width="550">
</div>
<div class="title"><span class="small">What caused these trends and what are their implications for the future? [Adapted from: <em>Data Visualization: A successful design process</em> by Andy Kirk]</span></div>
</div>
<div class="ulist">
<ul>
<li>
<p>Are there time periods where the data was sampled irregularly or samples are missing? Why?</p>
</li>
<li>
<p>Are there any (gradual or sudden) <a href="#_data_concept_drifts">data drifts</a> over time? Are these genuine changes (e.g., due to changes in the raw materials used for production) or artifacts (e.g., due to a malfunctioning sensor recording wrong values)?</p>
</li>
</ul>
</div>
</li>
<li>
<p>Examine relationships between variables (using scatter plots):</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/exploratory_scatter.png" alt="image" width="350">
</div>
<div class="title"><span class="small">Not all interesting relations between two variables can be detected through a high <a href="https://en.wikipedia.org/wiki/Correlation" target="\_blank">correlation coefficient</a>. Always check the scatter plot for details. [Adapted from: <em>Data Visualization: A successful design process</em> by Andy Kirk]</span></div>
</div>
<div class="ulist">
<ul>
<li>
<p>Are the observed correlations between variables expected?</p>
</li>
</ul>
</div>
</li>
<li>
<p>Examine patterns in multidimensional data (using parallel coordinate plots):</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/exploratory_parcoord.png" alt="image" width="750">
</div>
<div class="title"><span class="small">Each line in a parallel coordinate plot represents one data point, with the corresponding values for the different variables marked at the respective y-axis. The screenshot here shows an interactive plot created using the <code>plotly</code> library. By selecting value ranges for the different dimensions (indicated by the pink stripes), it is possible to spot interesting patterns resulting from a combination of values across multiple variables.</span></div>
</div>
<div class="ulist">
<ul>
<li>
<p>Do the observed patterns in the data match our understanding of the problem and dataset?</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The data should not only be examined at the outset of an ML project, but also monitored continuously throughout the lifetime of the application, e.g., by regularly checking how many samples we received per hour, that the values for each variable are in the expected range, and that there are no unexpected missing values.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_communicating_insights">Communicating Insights</h4>
<div class="paragraph">
<p>The plots that were created during an exploratory analysis should not be the plots we show our audience when we&#8217;re trying to communicate our findings. Since our audience is far less familiar with the data than us and probably also not interested / doesn&#8217;t have the time to dive deeper into the data, we need to make the results more accessible, a process often called <em>explanatory analysis</em>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Don&#8217;t &#8220;just show all the data&#8221; and hope that your audience will make something of it&#8201;&#8212;&#8201;this is the downfall of many dashboards. It is essential, that you understand what goal your audience is trying to achieve and what questions they need answers to.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_step_1_choose_the_right_plot_type">Step 1: Choose the right plot type</h5>
<div class="ulist">
<ul>
<li>
<p>get inspired by visualization libraries (e.g., <a href="https://github.com/Financial-Times/chart-doctor/blob/main/visual-vocabulary/Visual-vocabulary-en.pdf" target="\_blank">here</a> or <a href="https://datavizcatalogue.com/" target="\_blank">here</a>), but avoid the urge to create fancy graphics; sticking with common visualizations makes it easier for the audience to correctly decode the presented information</p>
</li>
<li>
<p>don&#8217;t use 3D effects!</p>
</li>
<li>
<p>avoid pie or donut charts (angles are hard to interpret)</p>
</li>
<li>
<p>use line plots for time series data</p>
</li>
<li>
<p>use horizontal instead of vertical bar charts for audiences that read left to right</p>
</li>
<li>
<p>start the y-axis at 0 for area &amp; bar charts</p>
</li>
<li>
<p>consider using <a href="https://en.wikipedia.org/wiki/Small_multiple" target="\_blank">small multiples</a> or sparklines instead of cramming too much into a single chart</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/explanatory1.png" alt="image" width="900">
</div>
<div class="title"><span class="small"><em>Left:</em> Bar charts (especially in 3D) make it hard to compare numbers over a longer period of time. <em>Right:</em> Trends over time can be more easily detected in line charts. [Example adapted from: <em>Storytelling with Data</em> by Cole Nussbaum Knaflic]</span></div>
</div>
</div>
<div class="sect4">
<h5 id="_step_2_cut_clutter_maximize_data_to_ink_ratio">Step 2: Cut clutter / maximize data-to-ink ratio</h5>
<div class="ulist">
<ul>
<li>
<p>remove border</p>
</li>
<li>
<p>remove gridlines</p>
</li>
<li>
<p>remove data markers</p>
</li>
<li>
<p>clean up axis labels</p>
</li>
<li>
<p>label data directly</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/explanatory2.gif" alt="image" width="550">
</div>
<div class="title"><span class="small">Cut clutter! [Example adapted from: <em>Storytelling with Data</em> by Cole Nussbaum Knaflic]</span></div>
</div>
</div>
<div class="sect4">
<h5 id="_step_3_focus_attention">Step 3: Focus attention</h5>
<div class="ulist">
<ul>
<li>
<p>start with gray, i.e., push everything in the background</p>
</li>
<li>
<p>use pre-attentive attributes like color strategically to highlight what&#8217;s most important</p>
</li>
<li>
<p>use data labels sparingly</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/explanatory3.gif" alt="image" width="550">
</div>
<div class="title"><span class="small">Start with gray and use pre-attentive attributes strategically to focus the audience&#8217;s attention. [Example adapted from: <em>Storytelling with Data</em> by Cole Nussbaum Knaflic]</span></div>
</div>
</div>
<div class="sect4">
<h5 id="_step_4_make_data_accessible">Step 4: Make data accessible</h5>
<div class="ulist">
<ul>
<li>
<p>add context: Which values are good (goal state), which are bad (alert threshold)? Should the value be compared to another variable (e.g., actual vs. forecast)?</p>
</li>
<li>
<p>leverage consistent colors when information is spread across multiple plots (e.g., data from a certain country is always drawn in the same color)</p>
</li>
<li>
<p>annotate the plot with text explaining the main takeaways (if this is not possible, e.g., in dashboards where the data keeps changing, the title can instead include the question that the plot should answer, e.g., &#8220;Does our revenue follow the projections?&#8221;)</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/explanatory4.png" alt="image" width="550">
</div>
<div class="title"><span class="small">Tell a story. [Example adapted from: <em>Storytelling with Data</em> by Cole Nussbaum Knaflic]</span></div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Further reading</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><em>Show Me the Numbers: Designing Tables and Graphs to Enlighten</em> by Stephen Few</p>
</li>
<li>
<p><em>Better Data Visualizations: A Guide for Scholars, Researchers, and Wonks</em> by Jonathan Schwabish</p>
</li>
<li>
<p><em>Effective Data Storytelling: How to drive change with data, narrative, and visuals</em> by Brent Dykes</p>
</li>
<li>
<p><em>Storytelling with Data: A data visualization guide for business professionals</em> by Cole Nussbaum Knaflic</p>
</li>
<li>
<p><em>Data Visualization: A successful design process</em> by Andy Kirk</p>
</li>
<li>
<p>Various <a href="https://kozyrkov.medium.com/" target="\_blank">blog posts</a> by Cassie Kozyrkov</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_garbage_in_garbage_out">Garbage in, garbage out!</h3>
<div class="paragraph">
<p>Remember: data is our raw material when producing something valuable with ML. If the quality or quantity of the data is insufficient, we are facing a &#8220;garbage in, garbage out&#8221; scenario and no matter what kind of fancy ML algorithm we try, we wont get a satisfactory result. In fact, the fancier the algorithm (e.g., deep learning), the more data we need.</p>
</div>
<div class="paragraph">
<p>Below you find a summary of some common risks associated with data that can make it complicated or even impossible to apply ML:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Raw data can be very messy: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Relevant data is spread across multiple databases / excel sheets that need to be joined. <em>Worst case:</em> Data points don&#8217;t have a unique ID based on which the different entries can be linked. Instead one has to fall back on some error prone strategy like matching data based on time stamps.</p>
</li>
<li>
<p>Manually entered values contains errors, e.g., misplaced decimal points.</p>
</li>
<li>
<p>It is not possible to correct missing values. <em>Worst case:</em> Missing values are not random. For example, sensors fail only right before something goes wrong during the production process. Or in surveys, rich people more often decline to answer questions regarding their income compared to poor or middle class people. This introduces a systematic bias in the dataset.</p>
</li>
<li>
<p>The dataset consists of different data types (structured and/or unstructured) with different scales.</p>
</li>
<li>
<p>The process setup changes over time, e.g., due to some external conditions like replacing a sensor or some other maintenance event, which means the data collected from different time periods are incompatible. <em>Worst case:</em> These external changes were not recorded anywhere and we only notice at the end of the analysis that the data we were working with violated our assumptions.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>&#8594; Data preprocessing takes a very long time.<br>
&#8594; Resulting dataset (after cleaning) is a lot smaller than expected&#8201;&#8212;&#8201;possibly too small to do any meaningful analysis.</p>
</div>
<div class="paragraph">
<p>&#8658; Before wanting to do ML, first think about how your data collection pipeline &amp; infrastructure could be improved!</p>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Not enough / not the right data to do ML: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Small dataset and/or too little variation, e.g., we produced only a few defective products or a process runs in a steady state most of the time, i.e., there is little or no variation in the inputs.<br>
&#8594; Effect of different input variables on the target can&#8217;t be estimated reliably from only a few observations.<br>
&#8658; Do some experiments where you systematically vary different inputs to collect a more diverse dataset.</p>
</li>
<li>
<p>Data is inconsistent / incomplete, i.e., same inputs with different outputs, e.g., two products were produced under the same (measured) conditions, one is fine, the other is faulty.<br>
This can have two reasons:</p>
<div class="ulist">
<ul>
<li>
<p>The labels are very noisy, for example, because the human annotators didn&#8217;t follow the same set of clear rules or some examples were ambiguous, e.g., one QA-expert deems a product with a small scratch as still OK, while another labels it as defective.<br>
&#8658; Clean up the data by relabeling, which can take some time but will pay off! See also this great <a href="https://youtu.be/06-AZXmwHjo" target="\_blank">MLOps / data-centric AI talk by Andrew Ng</a> on how a small high-quality dataset can be more valuable than a larger noisy dataset.</p>
</li>
<li>
<p>Relevant input features are missing: While it is relatively easy for humans to assess if all the relevant information is present in unstructured data (e.g., images: either we see a cat or we don&#8217;t), structured data often has too many different variables and complex interactions to know right away whether all the relevant features were included.<br>
&#8658; Talk to a subject matter expert about which additional input features might be helpful and include these in the dataset. <em>Worst case:</em> Need to install a new sensor in the machine and collect this data, i.e., all the data collected in the past is basically useless. BUT: using the right sensor can simplify the problem immensely and installing it will be worth it!<br>
<span class="small">In many applications, our first instinct is to use a camera to generate the input data, since we humans rely primarily on our visual system to solve many tasks. However, even though image recognition algorithms have come a long way, using such a setup instead of a more specialized sensor can make the solution more error prone.<br>
Trying to detect mushy strawberries? Use a near infrared (NIR) sensor instead of a regular camera like <a href="https://www.aboutamazon.co.uk/innovation/machine-learning-using-algorithms-to-sort-fruit" target="\_blank">Amazon Fresh</a> did. They still use machine learning to analyze the resulting data, but in the NIR images the rotting parts of fruits are more easily visible than in normal photos.<br>
Trying to detect if a door is closed? With a simple <a href="https://www.deeplearning.ai/the-batch/issue-92/" target="\_blank">magnet</a> and detector, this task can be solved without any complex analysis or training data! (You probably know the saying: &#8220;When you have a hammer, everything looks like a nail&#8221;. &#8594; Don&#8217;t forget to also consider solutions outside your ML toolbox! ;-))</span></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>&#8594; Unless the dataset is amended accordingly, any ML model has a poor performance!</p>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you can, observe how the data is collected. As in: actually physically stand there and watch how someone enters the values in some program or how the machine operates as the sensors measure something. You will probably notice some things that can be optimized in the data collection process directly, which will save you lots of preprocessing work in the future.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Best Practice: Data Catalog</dt>
<dd>
<p>To make datasets more accessible, especially in larger organizations, they should be documented. For example, in structured datasets, there should be information available on each variable like:</p>
<div class="ulist">
<ul>
<li>
<p>Name of the variable</p>
</li>
<li>
<p>Description</p>
</li>
<li>
<p>Units</p>
</li>
<li>
<p>Data type (e.g., numerical or categorical values)</p>
</li>
<li>
<p>Date of first measurement (e.g., in case a sensor was installed later than the others)</p>
</li>
<li>
<p>Normal/expected range of values (&#8594; &#8220;If this variable is below this threshold, then the machine is off and the data points can be ignored.&#8221;)</p>
</li>
<li>
<p>How missing values are recorded, i.e., whether they are recorded as missing values or substituted with some unrealistic value instead, which can happen since some sensors are not able to send a signal for &#8220;Not a Number&#8221; (NaN) directly or the database does not allow for the field to be empty.</p>
</li>
<li>
<p>Notes on anything else you should be aware of, e.g., a sensor malfunctioning during a certain period of time or some other glitch that resulted in incorrect data. This can otherwise be difficult to spot, for example, if someone instead manually entered or copy &amp; pasted values from somewhere, which look normal at first glance.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>You can find further recommendations on what is particularly important when documenting datasets for machine learning applications in the <a href="https://pair-code.github.io/datacardsplaybook/" target="\_blank">Data Cards Playbook</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In addition to documenting datasets as a whole, it is also helpful to store metadata for individual samples. For example, for image data, this could include the time stamp of when the image was taken, the geolocation (or if the camera is built into a manufacturing machine then the ID of this machine), information about the camera settings, etc.. This can greatly help when analyzing model prediction errors, as it might turn out that, for example, images taken with a particular camera setting are especially difficult to classify, which in turn gives us some hints on how to improve the data collection process.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Data as an Asset</dt>
<dd>
<p>With the right processes (e.g., roles such as &#8220;Data Owner&#8221; and &#8220;Data Controller&#8221; that are accountable for the data quality, and a consistent data infrastructure that includes a monitoring pipeline to validate new data), it is possible for an organization to get from &#8220;garbage in, garbage out&#8221; to &#8220;data is the new oil&#8221;:<br></p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/02_data/data_asset.png" alt="image" width="600">
</div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">With (big) data comes great responsibility!</dt>
<dd>
<p>Some data might not seem very valuable to you, but can be a huge asset for others, i.e., with a different use case!</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/09_ml_in_practice/data_responsibility.png" alt="image" width="540">
</div>
<div class="title"><span class="small">A fitness tracker startup thought it would be a cool idea to publish popular jogging routes based on the data they&#8217;ve collected from their users. However, since many US soldiers also happened to use the tracker and frequently jogged around their army bases, this startup thereby accidentally outed a secret army base in Afghanistan, which appeared as a bright spot on their interactive map in an area where they otherwise had only few users. So even if your data looks harmless at first glance, please do think about what could go wrong in case you publish it (even in an aggregated, anonymized form)!</span></div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_preprocessing">Data Preprocessing</h3>
<div class="paragraph">
<p>Now that we better understand our data and verified that it is (hopefully) of good quality, we can get it ready for our machine learning algorithms.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Raw Data</dt>
<dd>
<p>can come in many different forms, e.g., sensor measurements, pixel values, text (e.g., HTML page), SAP database, &#8230;&#8203;<br>
&#8594; <em>n</em> data points, stored as rows in an excel sheet, as individual files, etc.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<strong>What constitutes one data point?</strong> It&#8217;s always important to be really clear about what one data point actually is, i.e., what the inputs look like and what we want back as a result from the model for each sample / observation. Think of this in terms of how you plan to integrate the ML model with the rest of your workflow: what data is generated in the previous step and can be used as input for the ML part, and what is needed as an output for the following step?
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Preprocessing</dt>
<dd>
<p>transforming and enriching the raw data before applying ML, for example:</p>
<div class="ulist">
<ul>
<li>
<p>remove / correct missing or wrongly entered data (e.g., misplaced decimal point)</p>
</li>
<li>
<p>exclude zero variance features (i.e., variables with always the same value) and nonsensical variables (e.g., IDs)</p>
</li>
<li>
<p>feature extraction: transform into numerical values (e.g., unstructured data like text)</p>
</li>
<li>
<p>feature engineering: compute additional/better features from the original variables</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#8658; <strong><em>feature matrix</em></strong> \(\,X \in \mathbb{R}^{n\times d}\): <em>n</em> data points; each represented as a <em>d</em>-dimensional vector (i.e., with <em>d</em> features)<br>
<span class="small">Please note that, in general, it is important that all samples in a dataset are represented as the same kind of fixed-length vectors. E.g., if the first position (i.e., feature) in the vector of one sample represents the temperature at which a product was produced, then the first position in the feature vector of another sample can not be this product&#8217;s height. This is critical, because most ML models learn some kind of weights that act on the individual features and if these are always at different positions (or missing for some data points), then the algorithm would not be able to apply the correct weight to the respective feature.</span></p>
</div>
</dd>
<dt class="hdlist1">Prediction Targets?</dt>
<dd>
<p>&#8594; <strong><em>label vector</em></strong> \(\,\mathbf{y}\) : <em>n</em>-dimensional vector with one target value per data point</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_what_constitutes_one_data_point">What constitutes one data point?</h4>
<div class="paragraph">
<p>Even given the same raw data, depending on what problem we want to solve, the <strong>definition of &#8216;one data point&#8217;</strong> can be quite different.
For example, when dealing with time series data, <strong>the raw data is in the form &#8216;<em>n</em> time points with measurements from <em>d</em> sensors&#8217;</strong>, but depending on the type of question we are trying to answer, the actual feature matrix can look quite different:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">1 Data Point = 1 Time Point</dt>
<dd>
<p>e.g., anomaly detection &#8658; determine for each time point if everything is normal or if there is something strange going on:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_timeseries/timeseries1.png" alt="image" width="660">
</div>
</div>
<div class="paragraph">
<p>&#8594; \(X\): <em>n</em> time points \(\times\) <em>d</em> sensors, i.e., <em>n</em> data points represented as <em>d</em>-dimensional feature vectors</p>
</div>
</dd>
<dt class="hdlist1">1 Data Point = 1 Time Series</dt>
<dd>
<p>e.g., cluster sensors &#8658; see if some sensors measure related things:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_timeseries/timeseries3.png" alt="image" width="660">
</div>
</div>
<div class="paragraph">
<p>&#8594; \(X\): <em>d</em> sensors \(\times\) <em>n</em> time points, i.e., <em>d</em> data points represented as <em>n</em>-dimensional feature vectors</p>
</div>
</dd>
<dt class="hdlist1">1 Data Point = 1 Time Interval</dt>
<dd>
<p>e.g., classify time segments &#8658; products are being produced one after another, some take longer to produce than others, and the task is to predict whether a product produced during one time window at the end meets the quality standards, i.e., we&#8217;re not interested in the process over time per se, but instead regard each produced product (and therefore each interval) as an independent data point:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_timeseries/timeseries2.png" alt="image" width="660">
</div>
</div>
<div class="paragraph">
<p>&#8594; Data points always need to be represented as fixed-length feature vectors, where each dimension stands for a specific input variable. Since the intervals here have different lengths, we can&#8217;t just represent one product as the concatenation of all the sensor measurements collected during its production time interval, since these vectors would not be comparable for the different products. Instead, we compute features for each time segment by aggregating the sensor measurements over the interval (e.g., min, max, mean, slope, &#8230;&#8203;).<br>
&#8594; \(X\): <em>k</em> intervals \(\times\) <em>q</em> features (derived from the <em>d</em> sensors), i.e., <em>k</em> data points represented as <em>q</em>-dimensional feature vectors</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_feature_extraction">Feature Extraction</h4>
<div class="paragraph">
<p>Machine learning algorithms only work with numbers. But some data <em>does not consist of numerical values</em> (e.g., text documents) or these numerical values <em>should not be interpreted as such</em> (e.g., sports players have numbers on their jerseys, but these numbers don&#8217;t mean anything in a numeric sense, i.e., higher numbers don&#8217;t mean the person scored more goals, they are merely IDs).<br>
For the second case, statisticians distinguish between nominal, ordinal, interval, and ratio data, but for simplicity we lump the first two together as categorical data, while the other two are considered meaningful numerical values.</p>
</div>
<div class="paragraph">
<p>For both text and categorical data we need to <strong>extract <em>meaningful</em> numerical features</strong> from the original data. We&#8217;ll start with categorical data and deal with text data at the end of the section.</p>
</div>
<div class="paragraph">
<p>Categorical features can be transformed with a <strong>one-hot encoding</strong>, i.e., by creating dummy variables that enable the model to introduce a different offset for each category.<br>
For example, our dataset could include samples from four product categories <code>circle</code>, <code>triangle</code>, <code>square</code>, and <code>pentagon</code>, where each data point (representing a product) falls into exactly one of these categories. Then we create four features, <code>is_circle</code>, <code>is_triangle</code>, <code>is_square</code>, and <code>is_pentagon</code>, and indicate a data point&#8217;s product category using a binary flag, i.e., a value of 1 at the index of the true category and 0 everywhere else:<br>
e.g., product category: <code>triangle</code> &#8658; <code>[0, 1, 0, 0]</code><br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.preprocessing</span> <span class="keyword">import</span> <span class="include">OneHotEncoder</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_feature_engineering_transformations">Feature Engineering &amp; Transformations</h4>
<div class="paragraph">
<p>Often it is very helpful to not just use the original features as is, but to compute new, more informative features from them&#8201;&#8212;&#8201;a common practice called feature engineering. Additionally, one should also check the distributions of the individual variables (e.g., by plotting a histogram) to see if the features are approximately <a href="https://en.wikipedia.org/wiki/Normal_distribution" target="\_blank">normally distributed</a> (which is an assumption of most ML models).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Generate additional features (i.e., feature engineering)</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>General purpose library: missing data imputation, categorical encoders, numerical transformations, and much more.<br>
&#8594; <a href="https://feature-engine.trainindata.com/en/latest/" target="\_blank"><code>feature-engine</code> library</a></p>
</li>
<li>
<p>Feature combinations: e.g., product/ratio of two variables. For example, compute a new feature as the ratio of the temperature inside a machine to the temperature outside in the room.<br>
&#8594; <a href="https://github.com/cod3licious/autofeat" target="\_blank"><code>autofeat</code> library</a> <span class="small">(<em>Disclaimer:</em> written by yours truly.)</span></p>
</li>
<li>
<p>Relational data: e.g., aggregations across tables. For example, in a database one table contains all the customers and another table contains all transactions and we compute a feature that shows the total volume of sales for each customer, i.e., the sum of the transactions grouped by customers.<br>
&#8594; <a href="https://www.featuretools.com/" target="\_blank"><code>featuretools</code> library</a></p>
</li>
<li>
<p>Time series data: e.g., min/max/average over time intervals.<br>
&#8594; <a href="https://tsfresh.readthedocs.io/en/latest/" target="\_blank"><code>tsfresh</code> library</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#8658; Domain knowledge is invaluable here&#8201;&#8212;&#8201;instead of blindly computing hundreds of additional features, ask a subject matter expert which derived values she thinks might be the most helpful for the problem you&#8217;re trying to solve!</p>
</div>
</dd>
<dt class="hdlist1">Aim for normally/uniformly distributed features</dt>
<dd>
<p>This is especially important for heterogeneous data:<br>
For example, given a dataset with different kinds of sensors with different scales, like a temperature that varies between 100 and 500 degrees and a pressure sensor that measures values between 1.1 and 1.8 bar:<br>
&#8594; the ML model only sees the values and does not know about the different units<br>
&#8658; a difference of 0.1 for pressure might be more significant than a difference of 10 for the temperature.</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>for each feature: subtract mean &amp; divide by standard deviation (i.e., transform an arbitrary Gaussian distribution into a normal distribution)</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.preprocessing</span> <span class="keyword">import</span> <span class="include">StandardScaler</span></code></pre>
</div>
</div>
</li>
<li>
<p>for each feature: scale between 0 and 1</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.preprocessing</span> <span class="keyword">import</span> <span class="include">MinMaxScaler</span></code></pre>
</div>
</div>
</li>
<li>
<p>map to Gaussian distribution (e.g., take log/sqrt if the feature shows a skewed distribution with a few extremely large values)</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.preprocessing</span> <span class="keyword">import</span> <span class="include">PowerTransformer</span></code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Not using (approximately) normally distributed data is a very common mistake!</strong></p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="images/02_data/tsne_original.png" alt="image" width="270"></span>
<span class="image"><img src="images/02_data/tsne_standardized.png" alt="image" width="270"></span>
<span class="image"><img src="images/02_data/tsne_powertrans.png" alt="image" width="270"></span><br>
<span class="small">Three 2D visualizations created with the dimensionality reduction method <a href="#_dimensionality_reduction_2">t-SNE</a> of the same dataset, first using the original feature vectors, then on standardized data, and lastly after applying a power transformation. Each dot is one data point where the color denotes the point&#8217;s class.</span></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_computing_similarities">Computing Similarities</h4>
<div class="paragraph">
<p>Many ML algorithms rely on similarities or distances between data points, computed with measures such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Euclidean_distance" target="\_blank">Euclidean distance</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Cosine_similarity" target="\_blank">Cosine similarity</a> (e.g., when working with text data)</p>
</li>
<li>
<p>Similarity coefficients (e.g., <a href="https://en.wikipedia.org/wiki/Jaccard_index" target="\_blank">Jaccard index</a>)</p>
</li>
<li>
<p>&#8230;&#8203; and many more.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.metrics.pairwise</span> <span class="keyword">import</span> ...</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Which feature should have how much influence on the similarity between points? &#8594; Domain knowledge!
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8658; Scale / normalize heterogeneous data: For example, the pressure difference between 1.1 and 1.3 bar might be more dramatic in the process than the temperature difference between 200 and 220 degrees, but if the distance between data points is computed with the unscaled values, then the difference in temperature completely overshadows the difference in pressure.</p>
</li>
<li>
<p>&#8658; Exclude redundant / strongly correlated features, as they otherwise count twice towards the distance.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_working_with_text_data">Working with Text Data</h4>
<div class="paragraph">
<p>As mentioned before, machine learning algorithms can not work with text data directly, but we first need to extract meaningful numerical features from it.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><span class="underline">Feature extraction:</span> Bag-of-Words (BOW) TF-IDF features: </dt>
<dd>
<p>Represent a document as the weighted counts of the words occurring in the text:</p>
<div class="ulist">
<ul>
<li>
<p><em>Term Frequency</em> (TF): how often does this word occur in the current text document.</p>
</li>
<li>
<p><em>Inverse Document Frequency</em> (IDF): a weight to capture how significant this word is. This is computed by comparing the total number of documents in the dataset to the number of documents in which the word occurs. The IDF weight thereby reduces the overall influence of words that occur in almost all documents (e.g., so-called stopwords like &#8216;and&#8217;, &#8216;the&#8217;, &#8216;a&#8217;, &#8230;&#8203;).</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_nlp/tfidf6.png" alt="image" width="500">
</div>
<div class="title"><span class="small">Please note that here the feature vector is shown as a column vector, but since each document is one data point, it is actually one row in the feature matrix \(X\), while the TF-IDF values for the individual words are the features in the columns.</span></div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#8594; First, the whole <em>corpus</em> (= a dataset consisting of text documents) is processed once to determine the overall vocabulary (i.e., the unique words occurring in all documents that then make up the dimensionality of the BOW feature vector) and to compute the IDF weights for all words. Then each individual document is processed to compute the final TF-IDF vector by counting the words occurring in the document and multiplying these counts with the respective IDF weights.<br></p>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.feature_extraction.text</span> <span class="keyword">import</span> <span class="include">TfidfVectorizer</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Computing similarities between texts (represented as TF-IDF vectors) with the <em>cosine similarity</em>: </dt>
<dd>
<p>Scalar product (&#8594; <code>linear_kernel</code>) of length normalized TF-IDF vectors:</p>
<div class="stemblock">
<div class="content">
\[sim(\mathbf{x}_i, \mathbf{x}_j) = \frac{\mathbf{x}_i^\top \mathbf{x}_j}{\|\mathbf{x}_i\| \|\mathbf{x}_j\|} \quad \in [-1, 1]\]
</div>
</div>
<div class="paragraph">
<p>i.e., the cosine of the angle between the length-normalized vectors:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_nlp/cosine_sim.png" alt="image" width="640">
</div>
</div>
<div class="paragraph">
<p>&#8594; similarity score is between [0, 1] for TF-IDF vectors, since all entries in the vectors are positive.</p>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Food for thought: Human vs. TF-IDF + Cosine Similarity understanding</dt>
</dl>
</div>
<div class="paragraph text-center text-center">
<p><em>The hotel was great, but the weather was bad.</em><br>
vs.<br>
<em>The weather was great, but the hotel was bad.</em><br>
vs.<br>
<em>The accommodation was wonderful, but it was raining all day.</em></p>
</div>
<div class="paragraph">
<p>For which of the above sentences would you say that they mean something similar?<br>
Which sentence pairs would be assigned a high or lower similarity score when they are represented as TF-IDF vectors and the similarity is computed with the cosine similarity?</p>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Disadvantages of TF-IDF vectors: </dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Similarity between individual words (e.g., synonyms) is not captured, since each word has its own distinct dimension in the feature vector and is therefore equally far away from all other words.</p>
</li>
<li>
<p>Word order is ignored &#8594; this is also where the name &#8220;bag of words&#8221; comes from, i.e., imagine all the words from a document are thrown into a bag and shook and then we just check how often each word occurred in the text.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unsupervised_learning">Unsupervised Learning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first algorithms we look at in more detail are from the area of unsupervised learning:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01c_ml_overview/ml_algorithms_unsupervised.png" alt="image" width="840">
</div>
</div>
<div class="paragraph">
<p>While the subfields of unsupervised learning all include lots of different algorithms that can be used for the respective purpose, we&#8217;ll always just examine a few example algorithms with different underlying ideas in more detail. But feel free to, e.g., have a look at the <a href="https://scikit-learn.org/stable/unsupervised_learning.html" target="\_blank">sklearn user guide</a> for more information about other methods.</p>
</div>
<div class="sect2">
<h3 id="_dimensionality_reduction_2">Dimensionality Reduction</h3>
<div class="paragraph">
<p>The first subfield of unsupervised learning that we look at is dimensionality reduction:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01c_ml_overview/ml_algorithms_dimred.png" alt="image" width="740">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Goal</dt>
<dd>
<p>Reduce the number of features without loosing relevant information.</p>
</dd>
<dt class="hdlist1">Advantages</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Reduced data needs less memory (usually not that important anymore today)</p>
</li>
<li>
<p>Noise reduction (by focusing on the most relevant signals)</p>
</li>
<li>
<p>Create a visualization of the dataset (what we are mostly using these algorithms for)</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Example: Embed images of hand written digits in 2 dimensions</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/03_unsupervised/dimred_problem.png" alt="image" width="470">
</div>
<div class="title"><span class="small">The dataset in this small example consists of a set of 8 x 8 pixel images of handwritten digits, i.e., each data point can be represented as a 64-dimensional input feature vector containing the gray-scale pixel values. Usually, this dataset is used for classification, i.e., where a model should predict which number is shown on the image. We instead only want to get an overview of the dataset, i.e., our goal is to reduce the dimensionality of this dataset to two coordinates, which we can then use to visualize all samples in a 2D scatter plot. Please note that the algorithms only use the original image pixel values as input to compute the 2D coordinates, but afterwards we additionally use the labels of the images (i.e., the digit shown in the image) to give the dots in the plot some color to better interpret the results.</span></div>
</div>
<div class="openblock text-center">
<div class="content">
<div class="paragraph">
<p><span class="image"><img src="images/03_unsupervised/dimred_pca.png" alt="image" width="420"></span>
<span class="image"><img src="images/03_unsupervised/dimred_tsne.png" alt="image" width="420"></span></p>
</div>
</div>
</div>
<div class="openblock text-justify">
<div class="content">
<div class="paragraph">
<p><span class="small">The two plots show the results, i.e., the 2-dimensional representation of the dataset created with two different dimensionality reduction algorithms, PCA and t-SNE. Each point or thumbnail in the plot represents one data point (i.e., one image) and the colors, numbers, and example images were added after reducing the dimensionality so the plot is easier to interpret.</span></p>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>There is no right or wrong way to represent the data in 2D&#8201;&#8212;&#8201;it&#8217;s an unsupervised learning problem, which by definition has no ground truth answer. The algorithms arrive at two very different solutions, since they follow different strategies and have a different definition of what it means to preserve the relevant information. While PCA created a plot that preserves the global relationship between the samples, t-SNE arranged the samples in localized clusters.</p>
</div>
<div class="paragraph">
<p>The remarkable thing here is that these methods did not know about the fact that the images displayed different, distinct digits (i.e., they did not use the label information), yet t-SNE grouped images showing the same number closer together. From such a plot we can already see that if we were to solve the corresponding classification problem (i.e., predict which digit is shown in an image), this task should be fairly easy, since even an unsupervised learning algorithm that did not use the label information showed that images displaying the same number are very similar to each other and can easily be distinguished from images showing different numbers. Or conversely, if our classification model performed poorly on this task, we would know that we have a bug somewhere, since apparently the relevant information is present in the features to solve this task.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please note that even though t-SNE seems to create clusters here, it is <em>not a clustering algorithm</em>. As a dimensionality reduction algorithm, t-SNE produces a set of new 2D coordinates for our samples and when plotting the samples at these coordinates, they happen to be arranged in clusters. However, a clustering algorithm instead outputs cluster indices, that state which samples were assigned to the same group (which could then be used to color the points in the 2D coordinate plot).
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_principal_component_analysis_pca">Principal Component Analysis (PCA)</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Useful for</dt>
<dd>
<p>General dimensionality reduction &amp; noise reduction.<br>
&#8658; The transformed data is sometimes used as input for other algorithms instead of the original features.</p>
</dd>
<dt class="hdlist1">Main idea</dt>
<dd>
<p>Compute the eigendecomposition of the dataset&#8217;s covariance matrix, a symmetric matrix of size \(d \times d\) (with <em>d</em> = number of original input features), which states how strongly any two features co-vary, i.e., how related they are, similar to the linear correlation between two features.<br>
By computing the eigenvalues and -vectors of this matrix, the main directions of variance in the data are identified. These are the principle components and can be expressed as linear combinations of the original features. We then reorient the data along these new axis.<br>
Have a look at <a href="https://www.youtube.com/watch?v=5HNr_j6LmPc" target="\_blank">this video</a> for a more detailed explanation.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/03_unsupervised/pca.png" alt="image" width="740">
</div>
<div class="title"><span class="small">In this example the original data only has two features anyways, so a dimensionality reduction does not make much sense, but it nicely illustrates how the PCA algorithm works: The main direction of variance is selected as the first new dimension, while the direction with the next strongest variation (orthogonal to the first) is the second new dimension. These new dimensions are the principle components. The data is then be rotated accordingly, such that the amount of variance in the data, i.e., the information content and therefore also the eigenvalue associated with the principle components, decreases from the first to the last of these new dimensions.</span></div>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.decomposition</span> <span class="keyword">import</span> <span class="include">PCA</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="underline">Important Parameters:</span></p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8594; <code>n_components</code>: New dimensionality of data; this can be as many as the original features (or the rank of the feature matrix).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Linear algebra based: solution is a global optima, i.e., when we compute PCA multiple times on the same dataset we&#8217;ll always get the same results.</p>
</li>
<li>
<p>Know how much information is retained in the low dimensional representation; stored in the attributes <code>explained_variance_ratio_</code> or <code>singular_values_</code> / <code>eigenvalues_</code> (= eigenvalues of the respective PCs):<br>
The principle components are always ordered by the magnitude of their corresponding eigenvalues (largest first);<br>
When using the first <em>k</em> components with eigenvalues \(\lambda_i\), the amount of variance that is preserved is: \(\frac{\sum_{i=1}^k \lambda_i}{\sum_{i=1}^d \lambda_i}\).<br>
<span class="underline">Note:</span> If the intrinsic dimensionality of the dataset is lower than the original number features, e.g., because some features were strongly correlated, then the last few eigenvalues will be zeros. You can also plot the <a href="https://en.wikipedia.org/wiki/Scree_plot" target="\_blank">eigenvalue spectrum</a>, i.e., the eigenvalues ordered by their magnitude, to see how many dimensions you might want to keep, i.e., where this curve starts to flatten out.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Computationally expensive for many (&gt; 10k) features.<br>
<span class="underline">Tip:</span> If you have fewer data points than features, consider using Kernel PCA instead: This variant of the PCA algorithm computes the eigendecomposition of a similarity matrix, which is \(n \times n\) (with <em>n</em> = number of data points), i.e., when <em>n</em> &lt; <em>d</em> this matrix will be smaller than the covariance matrix and therefore computing its eigendecomposition will be faster.</p>
</li>
<li>
<p>Outliers can heavily skew the results, because a few points away from the center can introduce a large variance in that direction.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_t_sne">t-SNE</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Useful for</dt>
<dd>
<p>Visualizing data in 2D&#8201;&#8212;&#8201;but please do not use the transformed data as input for other algorithms.</p>
</dd>
<dt class="hdlist1">Main idea</dt>
<dd>
<p>Randomly initialize the points in 2D and move them around until their distances in 2D match the original distances in the high dimensional input space, i.e., until the points that were similar to each other in the original high dimensional space are located close together in the new 2D map of the dataset.<br>
&#8594; Have a look at the animations in this great blog article to see <a href="https://distill.pub/2016/misread-tsne/" target="\_blank">t-SNE in action</a>!</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.manifold</span> <span class="keyword">import</span> <span class="include">TSNE</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="underline">Important Parameters:</span></p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8594; <code>perplexity</code>: Roughly: how many nearest neighbors a point is expected to have. Have a look at the corresponding section in the blog article linked above for an example. However, what an appropriate value for this parameter is depends on the size and diversity of the dataset, e.g., if a dataset consists of 1000 images with 10 classes, then a perplexity of 5 might be a reasonable choice, while for a dataset with 1 million samples, 500 could be a better value.<br>
<span class="small">The original paper says values up to 50 work well, but in 2003 &#8220;big data&#8221; also wasn&#8217;t a buzzword yet ;-)</span></p>
</li>
<li>
<p>&#8594; <code>metric</code>: How to compute the distances in the original high dimensional input space, which tells the model which points should be close together in the 2D map.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Very nice visualizations.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Algorithm can get stuck in a local optimum, e.g., with some points trapped between clusters.</p>
</li>
<li>
<p>Selection of distance metric for heterogeneous data &#8658; normalize!</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>&#8594; Also check out the <a href="https://umap-learn.readthedocs.io/en/latest/" target="\_blank"><code>umap</code></a> and <a href="https://github.com/YingfanWang/PaCMAP" target="\_blank"><code>pacmap</code></a> libraries!</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_outlier_anomaly_detection">Outlier / Anomaly Detection</h3>
<div class="paragraph">
<p>Next up on our list of ML tools is anomaly or outlier detection:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01c_ml_overview/ml_algorithms_outliers.png" alt="image" width="740">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Useful for</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Detecting anomalies for monitoring purposes, e.g., machine failures or fraudulent credit card transactions.<br></p>
</li>
<li>
<p>Removing outliers from the dataset to improve the performance of other algorithms.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Things to consider when trying to remove outliers or detect anomalies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Does the dataset consist of <strong>independent data points</strong> or <strong>time series data</strong> with dependencies?</p>
</li>
<li>
<p>Are you trying to detect</p>
<div class="ulist">
<ul>
<li>
<p><strong>outliers in individual dimensions</strong>? For example, in time series data we might not see a failure in all sensors simultaneously, but only one sensor acts up spontaneously, i.e., shows a value very different from the previous time point, which would be enough to rule this time point an anomaly irrespective of the values of the other sensors.</p>
</li>
<li>
<p><strong>multidimensional outlier patterns</strong>? Individual feature values of independent data points might not seem anomalous by themselves, only when considered in combination with the data point&#8217;s other feature values. For example, a 35 \(m^2\) apartment could be a nice studio, but if this apartment supposedly has 5 bedrooms, then something is off.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Are you expecting a few <strong>individual outliers</strong> or <strong>clusters of outliers</strong>? The latter is especially common in time series data, where, e.g., a machine might experience an issue for several minutes or even hours before the signals look normal again. Clusters of outliers are more tricky to detect, especially if the data also contains other &#8216;legitimate&#8217; clusters of normal points. Subject matter expertise is key here!</p>
</li>
<li>
<p>Do you have any <strong>labels</strong> available? While we might not know what the different kinds of (future) anomalies look like, maybe we <em>do</em> know what normal data points look like, which is important information that we can use to check how far new points deviate from these normal points, also called novelty detection.</p>
</li>
</ul>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Know your data&#8201;&#8212;&#8201;are missing values marked as NaNs (&#8220;Not a Number&#8221;) or set to some &#8216;unreasonable&#8217; high or low value?
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Removing outlier samples from a dataset is often a necessary cleaning step, e.g., to obtain better prediction models. However, we should always be able to explain <em>why</em> we removed these points, as they could also be interesting edge cases.<br>
Try to remove as many outliers as possible with manually crafted rules (e.g., &#8220;when this sensor is 0, the machine is off and the points can be disregarded&#8221;), especially when the dataset contains clusters of outliers, which are harder to detect with data-driven methods.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Please note that some of the data points a prediction model encounters in production might be outliers as well. Therefore, new data needs to be screened for outliers as well, as otherwise these points would force the model to extrapolate beyond the training domain.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Different methods for outlier/anomaly detection</dt>
<dd>
<p>There is no one-size-fits-all solution, but depending on the characteristics of the dataset you might want to experiment with some of these approaches:</p>
<div class="ulist">
<ul>
<li>
<p>Detect outliers in individual feature dimensions:</p>
<div class="ulist">
<ul>
<li>
<p>Compute the <a href="https://en.wikipedia.org/wiki/Interquartile_range">interquartile range (IQR)</a>, i.e., the difference between the 75th and 25th percentiles of the data, as \(\text{IQR} = Q_3 - Q_1\), where \(Q_1\) and \(Q_3\) are the lower and upper quartiles. All data points with values outside of the range \([Q_1-1.5\cdot \text{IQR},\; Q_3+1.5\cdot \text{IQR}\)] are considered outliers.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Detect multidimensional outlier patterns, especially in datasets with independent data points (see also <a href="https://scikit-learn.org/stable/modules/outlier_detection.html" target="\_blank">sklearn user guide</a>):</p>
<div class="ulist">
<ul>
<li>
<p>\(\gamma\)-index (see below)</p>
</li>
<li>
<p>Local Outlier Factor (from <code>sklearn</code>; similar to the \(\gamma\)-index)</p>
</li>
<li>
<p>Isolation Forest (from <code>sklearn</code>; read about <a href="#_decision_trees">decision trees</a> and <a href="#_ensemble_methods">random forests</a> first)</p>
</li>
<li>
<p>One-class SVM (from <code>sklearn</code>; read about <a href="#_kernel_methods">kernel methods</a> and normal SVMs first)</p>
</li>
<li>
<p>DBSCAN (a <a href="#_clustering_2">clustering</a> algorithm that allows for noise, which would be considered outliers)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Compare actual data points to denoised samples or predicted values:</p>
<div class="ulist">
<ul>
<li>
<p>Use (kernel) PCA or an auto-encoder neural network architecture to first compress a sample and then reconstruct it in order to remove noise. If the denoised data point deviates a lot from the original sample, it is probably an anomaly.</p>
</li>
<li>
<p>For time series data: model the expected course of an individual time series, e.g., using a moving window average or an ARIMA model (see section on <a href="#_time_series_forecasting">time series forecasting</a> for more details), and then compare how much a time point deviates from this predicted value.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Get creative: you know your data best&#8201;&#8212;&#8201;define rules and custom anomaly KPIs based on your domain knowledge, e.g., set thresholds for what would be considered unrealistic feature values etc.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_gamma_index">\(\gamma\)-index</h4>
<div class="paragraph">
<p><span class="small">Harmeling, Stefan, et al. &#8220;From outliers to prototypes: ordering data.&#8221; <em>Neurocomputing</em> 69.13-15 (2006): 1608-1618.</span></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Main idea</dt>
<dd>
<p>Compute the average distance of a point to its <em>k</em> nearest neighbors:<br>
&#8594; Points with a large average distance are more likely to be outliers.<br>
&#8658; Set a threshold for the average distance when a point is considered an outlier.</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/03_unsupervised/outliers.png" alt="image" width="640">
</div>
<div class="title"><span class="small">This toy example in 2D, but of course the Euclidean distance between the points can also be computed in higher dimensional features spaces.</span></div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">numpy</span> <span class="keyword">as</span> np
<span class="keyword">from</span> <span class="include">sklearn.metrics</span> <span class="keyword">import</span> <span class="include">pairwise_distances</span>

<span class="keyword">def</span> <span class="function">gammaidx</span>(X, k):
    <span class="docstring"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
</span><span class="content">    Inputs:</span><span class="content">
</span><span class="content">        - X [np.array]: n samples x d features input matrix</span><span class="content">
</span><span class="content">        - k [int]: number of nearest neighbors to consider</span><span class="content">
</span><span class="content">    Returns:</span><span class="content">
</span><span class="content">        - gamma_index [np.array]: vector of length n with gamma index for each sample</span><span class="content">
</span><span class="content">    </span><span class="delimiter">&quot;&quot;&quot;</span></span>
    <span class="comment"># compute n x n Euclidean distance matrix</span>
    D = pairwise_distances(X, metric=<span class="string"><span class="delimiter">'</span><span class="content">euclidean</span><span class="delimiter">'</span></span>)
    <span class="comment"># sort the entries of each row, such that the 1st column is 0 (distance of point to itself),</span>
    <span class="comment"># the following columns are distances to the closest nearest neighbors (i.e., smallest values first)</span>
    Ds = np.sort(D, axis=<span class="integer">1</span>)
    <span class="comment"># compute mean distance to the k nearest neighbors of every point</span>
    gamma_index = np.mean(Ds[:, <span class="integer">1</span>:(k+<span class="integer">1</span>)], axis=<span class="integer">1</span>)
    <span class="keyword">return</span> gamma_index

<span class="comment"># or more efficiantly with the NearestNeighbors class</span>
<span class="keyword">from</span> <span class="include">sklearn.neighbors</span> <span class="keyword">import</span> <span class="include">NearestNeighbors</span>

<span class="keyword">def</span> <span class="function">gammaidx_fast</span>(X, k):
    <span class="docstring"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
</span><span class="content">    Inputs:</span><span class="content">
</span><span class="content">        - X [np.array]: n samples x d features input matrix</span><span class="content">
</span><span class="content">        - k [int]: number of nearest neighbors to consider</span><span class="content">
</span><span class="content">    Returns:</span><span class="content">
</span><span class="content">        - gamma_index [np.array]: vector of length n with gamma index for each sample</span><span class="content">
</span><span class="content">    </span><span class="delimiter">&quot;&quot;&quot;</span></span>
    <span class="comment"># initialize and fit nearest neighbors search</span>
    nn = NearestNeighbors(n_neighbors=k).fit(X)
    <span class="comment"># compute mean distance to the k nearest neighbors of every point (ignoring the point itself)</span>
    <span class="comment"># (nn.kneighbors returns a tuple of distances and indices of nearest neighbors)</span>
    gamma_index = np.mean(nn.kneighbors()[<span class="integer">0</span>], axis=<span class="integer">1</span>)  <span class="comment"># for new points: nn.kneighbors(X_test)</span>
    <span class="keyword">return</span> gamma_index</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Conceptually very simple and easy to interpret.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Computationally expensive for large datasets (distance matrix: \(\mathcal{O}(n^2)\)) &#8594; compute distances to a random subsample of the dataset or to a smaller set of known non-anomalous points instead.</p>
</li>
<li>
<p>Normalize heterogeneous datasets before computing distances!</p>
</li>
<li>
<p>Know your data: does the dataset contain larger clusters of outliers? &#8594; <em>k</em> needs to be large enough such that a tight cluster of outliers is not mistaken as prototypical data points.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Extension for time series data: don&#8217;t identify the <em>k</em> nearest neighbors of a sample based on the distance of the data points in the feature space, but take the neighboring time points instead.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>You&#8217;ve found an outlier&#8201;&#8212;&#8201;now what?</strong></p>
</div>
<div class="video-container">
    <iframe class="video" src="https://www.youtube.com/embed/OYwq0MlY11g" allowfullscreen></iframe>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_clustering_2">Clustering</h3>
<div class="paragraph">
<p>The last category of unsupervised learning algorithms is clustering:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01c_ml_overview/ml_algorithms_clustering.png" alt="image" width="740">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Useful for</dt>
<dd>
<p>Identifying naturally occurring groups in the data (e.g., for customer segmentation).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>There exist <a href="https://scikit-learn.org/stable/modules/clustering.html" target="\_blank">quite a lot of different clustering algorithms</a> and we&#8217;ll only present two with different ideas here.<br>
<span class="small">When you look at the linked sklearn examples, please note that even though other clustering algorithms might seem to perform very well on fancy toy datasets, data in reality is seldom arranged in two concentric circles, and on real-world datasets the k-means clustering algorithm is often a robust choice.</span></p>
</div>
<div class="sect3">
<h4 id="_k_means_clustering"><em>k</em>-means clustering</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Main idea</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Randomly place <em>k</em> cluster centers (where <em>k</em> is a hyperparameter set by the user);</p>
</li>
<li>
<p>Assign each data point to its closest cluster center;</p>
</li>
<li>
<p>Update cluster centers as the mean of the assigned data points;</p>
</li>
<li>
<p>Repeat steps 2-3 until convergence.</p>
</li>
</ol>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/03_unsupervised/kmeans.png" alt="image" width="840">
</div>
<div class="title"><span class="small">Please note that even though in these pictures the data is depicted in 2D, of course all these methods also work in high dimensional spaces!</span></div>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.cluster</span> <span class="keyword">import</span> <span class="include">KMeans</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="underline">Important Parameters:</span></p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8594; <code>n_clusters</code>: How many clusters (<em>k</em>) the algorithm should find.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Fast.</p>
</li>
<li>
<p>Usually good results on real world datasets.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Depends on random initialization &#8594; solution is local optimum, but usually not problematic in practice due to multiple restarts.</p>
</li>
<li>
<p>Assumes spherical clusters.</p>
</li>
<li>
<p>Need to guess the number of clusters. But this can be done with a heuristic and sometimes we also need to find a fixed number of clusters, e.g., if we only have the budged for three different marketing initiatives, we want to assign our customers to exactly three groups.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_dbscan">DBSCAN</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Main idea</dt>
<dd>
<p>Find &#8216;core samples&#8217; in dense areas of the data and then expand the clusters by iteratively including points with a distance &lt; <code>eps</code>.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/03_unsupervised/dbscan.png" alt="image" width="840">
</div>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.cluster</span> <span class="keyword">import</span> <span class="include">DBSCAN</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="underline">Important Parameters:</span></p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8594; <code>eps</code>: Maximum neighborhood distance of two samples.</p>
</li>
<li>
<p>&#8594; <code>metric</code>: How to compute the distance in the input feature space.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Allows for noise &#8658; can also be used to detect outliers.</p>
</li>
<li>
<p>No need to guess the number of clusters.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Very dependent on distance measure: may be tricky to get good results for heterogeneous data even after normalization (but: try on text data).</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>&#8594; Also check out the <a href="https://hdbscan.readthedocs.io/en/latest/" target="\_blank"><code>hdbscan</code></a> library!</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supervised_learning_basics">Supervised Learning Basics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we&#8217;ve surveyed the different unsupervised learning algorithms, let&#8217;s move on to supervised learning:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01c_ml_overview/ml_algorithms_supervised.png" alt="image" width="840">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Supervised learning in a nutshell (with scikit-learn): </dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/04_supervised_intro/supervised_learning_14.png" alt="image" width="840">
</div>
<div class="title"><span class="small">First, the available data needs to be split into a training and test part, where we&#8217;re assigning the majority of the data points to the training set and the rest to the test set. (Please note that, as an exception, in this graphic, \(X\) and \(\mathbf{y}\) are rotated by 90 degrees, i.e., the features are in the rows and the data points are in the columns.) Next, we need to decide on the type of model that we want to use to describe the relationship between the inputs \(X\) and the outputs \(\mathbf{y}\) and this model also comes with some hyperparameters that we need to set (which are passed as arguments when instantiating the respective sklearn class). Then we can call the <code>.fit(X_train, y_train)</code> method on the model to learn the internal model parameters by minimizing some model-specific objective function on the training data. Now the model is ready to generate predictions for new data points, i.e., by calling <code>.predict(X_test)</code>, we obtain the predicted values \(\mathbf{\hat{y}}\) for the test points. Finally, to get an estimate of how useful the model will be in practice, we evaluate it by comparing the predicted target values of the test set to the corresponding true labels.</span></div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In the following sections, we introduce the different approaches to supervised learning and explain when to use which kind of model, then discuss how to evaluate and select the hyperparameters of a supervised learning model.</p>
</div>
<div class="sect2">
<h3 id="_different_types_of_models">Different types of models</h3>
<div class="paragraph">
<p>The most important task of a data scientist is to select an appropriate model (and its hyperparameters) for solving a problem.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<div class="title"><span class="underline">Three considerations when choosing a supervised learning model</span></div>
<p></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">1. Problem type</dt>
<dd>
<p>What kind of problem are you trying to solve: <em>regression</em> or <em>classification</em>?<br>
&#8594; Depends on the type of target variable, i.e., if it has continuous or discrete values.</p>
</dd>
<dt class="hdlist1">2. Problem complexity</dt>
<dd>
<p>How complicated is the relationship between the input features and target variable: <em>linear</em> or <em>nonlinear</em>?<br>
&#8594; Depends on the available data, i.e., how easily the target can be predicted from the inputs.</p>
</dd>
<dt class="hdlist1">3. Algorithmic approach</dt>
<dd>
<p>Which type of model works best for this dataset size &amp; complexity: <em>features-based</em> or <em>similarity-based</em>?<br>
&#8594; Depends on the model you choose, i.e., it either learns according to the first or second strategy.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_problem_type_regression_vs_classification">Problem type: regression vs. classification</h4>
<div class="paragraph">
<p>The type of the target variable that we want to predict determines whether we are dealing with a regression or classification problem.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Regression</dt>
<dd>
<p>Prediction of continuous value(s) <em>(e.g., price, number of users, etc.)</em>.</p>
</dd>
<dt class="hdlist1">Classification</dt>
<dd>
<p>Prediction of discrete values:<br></p>
<div class="ulist">
<ul>
<li>
<p>binary <em>(e.g., product will be faulty: yes/no)</em></p>
</li>
<li>
<p>multi-class <em>(e.g., picture displays cat/dog/house/car/&#8230;&#8203;)</em></p>
</li>
<li>
<p>multi-label <em>(e.g., picture may display multiple objects)</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#8594; Many classification models actually predict probabilities for the different classes, i.e., a score between 0 and 1 for each class. The final class label is then chosen by applying a threshold on this score (typically 0.5 for binary classification problems) or by taking the outcome with the highest score (in multi-class problems).</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>&#8658; Whether we are dealing with a regression or classification problem is important to know and has implications for our overall workflow, e.g., how we define &amp; measure success. However, the actual models that we use to solve these problems are very similar, e.g., almost all <code>sklearn</code> models exist in either a <code>Regressor</code> or <code>Classifier</code> variant to generate the appropriate output for the respective problem type.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>In some cases it is even entirely up to us whether to frame the task as a regression or classification problem.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Example</dt>
<dd>
<p>A product is deemed faulty, if it breaks within the warranty period of 6 months, where we assume that normally the product would be used at most 300 times during these 6 months.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Depending on the use case, we might either be interested in how long a product lasts in total, or only whether this product will be a warranty case or not, i.e., we could formulate the problem as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A regression task: Predict, <em>after how many uses</em> the product will break.</p>
</li>
<li>
<p>A classification task: Predict, <em>if the product will break</em> before it was used 300 times.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, in many cases with a continuous target variable, we can learn a more accurate prediction model with the regression approach, since here the labels carry more information and edge case errors are not penalized as much. For example, in the classification case, predicting that a product is okay when it lasted 299 uses would be just as wrong as predicting &#8216;okay&#8217; for a product that lasted only 2 uses.<br>
If the workflow, where our model is later embedded in, requires a classification output, we can still transform the regression output of the model into a classification output later by simply setting a threshold, i.e., in this case if the regression model predicts a value lower than 300 we would output &#8216;faulty&#8217; and otherwise &#8216;okay&#8217;.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_problem_complexity_linear_or_nonlinear">Problem complexity: linear or nonlinear</h4>
<div class="paragraph">
<p>In accordance with the product warranty example described above, we now illustrate what it means for a problem to be linear or nonlinear on a small toy dataset:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/04_supervised_intro/problem_types2.png" alt="image" width="340">
</div>
<div class="title"><span class="small">The first input feature we consider is the production temperature, which is an independent variable, since the operator in control of the production process is free to just choose some value here. The target variable that we want to predict is the lifetime of the produced product and is dependent on this input variable. For the different temperature settings that were tested, we have collected the respective lifetime measurements (and, as you can imagine, getting such labels can be quite expensive, since these products not only needed to be produced, but also go through some stress test to determine after how many uses they break).</span></div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/04_supervised_intro/problem_types8.png" alt="image" width="840">
</div>
<div class="title"><span class="small">As you might have already guessed, the relationship between the target variable lifetime and the input feature temperature <em>(top left)</em> is a linear one, i.e., we could describe it by a straight line. Since the lifetime is a continuous variable, this is a regression problem. However, by defining some cutoff on the target variable (e.g., at 300 usages for in and out of warranty), this problem can be transformed into a classification problem, where the task here is to distinguish between faulty and good products <em>(bottom left)</em>. Again, the relationship between the target and the input variable temperature is linear, since the problem can be solved by drawing one line parallel to the y-axis, which defines some threshold on the temperature, where all data points with a temperature lower than this threshold would be classified as &#8216;ok&#8217; and those products produced at a higher temperature would be predicted as &#8216;broken&#8217;. In the center panel, we have the same situation only this time with a different input feature, pressure. In the regression case, the lifetime values now follow some quadratic curve, i.e., we could not adequately describe the relationship between our target variable and the input feature &#8216;pressure&#8217; with a single straight line, which makes this a nonlinear problem. Similarly, in the classification case below, we would need to define two thresholds on the pressure values to separate the two classes, i.e., again we could not solve the problem with a single straight line. While these four examples were univariate problems, i.e., with a single input variable, in machine learning we usually deal with multivariate problems, often with hundreds or even thousands of input features. For the case of two input variables, this is illustrated on the right, where the data is now plotted in a scatter plot where the axis correspond to the features temperature and pressure, while the color of the dots indicates the target value (either on a continuous scale or the discrete class labels). In the multidimensional case, a problem would be considered linear if it can by solved by a single hyperplane (instead of a line) in the input feature space.</span></div>
</div>
<div class="paragraph">
<p>As illustrated in the above examples, whether a problem can be solved by a simple linear model (i.e., a single straight line or hyperplane) or requires a more complex nonlinear model to adequately describe the relationship between the input features and target variable entirely depends on the given data.<br>
This also means that sometimes we can just install an additional sensor to measure some feature that is linearly related to the target variable or do some feature engineering to then be able to get satisfactory results with a linear model, i.e., sometimes, with the right preprocessing, a nonlinear problem can also be transformed into a linear one.</p>
</div>
</div>
<div class="sect3">
<h4 id="_algorithmic_approaches_features_based_vs_similarity_based_models">Algorithmic approaches: features-based vs. similarity-based models</h4>
<div class="paragraph">
<p>Finally, lets look at how the different models work and arrive at their predictions. This is what really distinguishes the various algorithms, whereas we have already established that there always exists a regression and a classification variant of each model and some models are inherently expressive enough that they can be used to describe nonlinear relationships in the data, while others will only yield satisfactory results if there exists a linear relationship between the available input features and the target variable.</p>
</div>
<div class="paragraph">
<p>Features-based models learn some parameters or rules that are applied directly to a new data point&#8217;s input feature vector \(\mathbf{x} \in \mathbb{R}^d\). Similarity-based models, on the other hand, first compute a vector \(\mathbf{s} \in \mathbb{R}^n\) with the similarities of the new sample to the training data points and the model then operates on this vector instead of the original input features.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/04_supervised_intro/algo_approach_handout.png" alt="image" width="640">
</div>
<div class="title"><span class="small"><em>Left:</em> Features-based models are described by a parametrized function that operates on the original input features. For example, in the regression case <em>(top)</em>, the predicted target for a new data point is the value on the line corresponding to its input features, while in the classification case <em>(bottom)</em>, the prediction is made according to on which side of the dividing line the inputs lie. <em>Right:</em> The similarity-based models make the prediction for a new sample based on this data point&#8217;s nearest neighbors. Depending on the type of model, this could be as simple as predicting the average target value of the nearest neighbors (regression, <em>top</em>) or their most frequent class (classification, <em>bottom</em>).</span></div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This distinction between algorithmic approaches is not only interesting from a theoretical point of view, but even more so from a practitioner&#8217;s perspective: When using a similarity-based algorithm, we have to be deliberate about which features to include when computing the similarities, make sure that these features are appropriately scaled, and in general think about which similarity measure is appropriate for this data. For example, we could capture domain knowledge by using a custom similarity function specifically tailored to the problem. When using a features-based model, on the other hand, the model itself can learn which features are most predictive by assigning individual weights to each input feature and therefore possibly ignore irrelevant features or account for variations in heterogeneous data. But of course, subject matter expertise is still beneficial here, as it can, for example, guide us when engineering additional, more informative input features.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Okay, now, when should we use which approach?</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Features-based models</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Number of features should be less than the number of samples!</p>
</li>
<li>
<p>Good for heterogeneous data due to individual feature weights (although scaling is usually still a good idea).</p>
</li>
<li>
<p>Easier to interpret (since they describe a direct relationship between input features &amp; target).</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Similarity-based models</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Nonlinear models for small datasets.</p>
</li>
<li>
<p>Need appropriate similarity function &#8594; domain knowledge! (especially for heterogeneous data)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/04_supervised_intro/comparison_all4.png" alt="image" width="840">
</div>
<div class="title"><span class="small">This is an overview of the different features-based and similarity-based models we&#8217;ll discuss in the following chapters, as well as for which dataset size and problem complexity they are appropriate: While linear models are rather simple and&#8201;&#8212;&#8201;as the name suggests&#8201;&#8212;&#8201;only yield good results for linear problems, they are very efficient and can be applied to large datasets. Decision trees are very efficient as well, but can also capture more complex relationships between inputs and output. Similarity-based models like <em>k</em>-nearest neighbors (kNN) or their more sophisticated cousin kernel methods, on the other hand, can be used to solve very complex nonlinear problems, however, as they require the computation of a similarity matrix that scales with the number of training points, they should only be applied to comparatively small datasets (~ a few thousand points). Finally, neural networks are the most sophisticated model class and can be used to solve extremely complex problems, but they are also rather data hungry (depending on the size of the network).</span></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_model_evaluation">Model Evaluation</h3>
<div class="paragraph">
<p>Since in supervised learning problems we know the ground truth, we can objectively evaluate different models and benchmark them against each other.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Is this a good model for the task?</strong><br>
I.e., does the model generate <em>reliable predictions</em> for <em>new data points</em>?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Split the data into training and test sets to be able to get a reliable estimate of how the model will later perform when applied to new data points that it wasn&#8217;t trained on.</p>
</li>
<li>
<p>Quantify the quality of the model&#8217;s predictions on the test set with a suitable evaluation metric (depending on the problem type).<br></p>
<div class="dlist">
<dl>
<dt class="hdlist1">Evaluation metrics: </dt>
<dd>
<p><em>Regression:</em> mean absolute error, mean squared error, \(R^2\)<br>
<em>Classification:</em> (balanced) accuracy<br>
<em>Ranking:</em> <a href="https://en.wikipedia.org/wiki/Precision_and_recall" target="\_blank">precision/recall</a> (&#8594; F1 score), hits@<em>k</em></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>&#8658; Are some mistakes worse than others (e.g., consider false positives vs. false negatives in medical tests)?<br>
&#8658; Always choose <em>a single metric/KPI</em> to optimize (maybe: additional constraints like runtime).</p>
</div>
</li>
<li>
<p>Compare the model to a &#8216;stupid baseline&#8217; that predicts the mean (&#8594; regression) or most frequent class (&#8594; classification).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_evaluation_metrics">Evaluation Metrics</h4>
<div class="paragraph">
<p>We start with three evaluation metrics for regression problems: the mean absolute error, mean squared error, and \(R^2\).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Mean absolute error (MAE)</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/error_mean_absolute.png" alt="image" width="480">
</div>
<div class="title"><span class="small">This is probably the most straightforward regression error metric and additionally easy to interpret since the error is given in the same units of measurement as the target variable (e.g., if we&#8217;re predicting a price in euros, we would know exactly by how many euros the model is off on average).</span></div>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.metrics</span> <span class="keyword">import</span> <span class="include">mean_absolute_error</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Mean squared error (MSE)</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/error_mean_squared.png" alt="image" width="480">
</div>
<div class="title"><span class="small">Since this regression error metric is differentiable, it is often used internally when optimizing the parameters of a model (e.g., in linear regression). When reporting the final error of a model, one often takes the square root of the result, i.e., instead reports the root mean squared error (RMSE), since this is again in the same units as the original target variable (but still less intuitive than the MAE).</span></div>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.metrics</span> <span class="keyword">import</span> <span class="include">mean_squared_error</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">\(R^2\)</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/error_r2.png" alt="image" width="700">
</div>
<div class="title"><span class="small">The \(R^2\), or coefficient of determination, essentially compares the MSE of a regression model against the MSE of the &#8216;stupid baseline&#8217; for the regression (i.e., predicting the mean), i.e., it normalizes the MSE by the variance of the data. In the best case, the \(R^2\) is 1, i.e., when the model explains the data perfectly, and in the worst case, it can even become negative, i.e., when the model performs worse then simply predicting the mean.</span></div>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.metrics</span> <span class="keyword">import</span> <span class="include">r2_score</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now lets look at evaluation metrics for classification problems.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Classification errors in detail</dt>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/error_class2.png" alt="image" width="560">
</div>
<div class="title"><span class="small">Most (binary) classification models predict the probability that a sample belongs to a certain class, i.e., a score between 0 and 1. By setting a threshold on this probability (typically at 0.5), the prediction score can be transformed into the class label, i.e., either predicting the positive or negative class for this sample. We distinguish between two types of mistakes that a classification model can make in this prediction: <em>false positives (FP)</em>, i.e., incorrectly predicting the positive class for samples belonging to the negative class, and <em>false negatives (FN)</em>, i.e., incorrectly predicting the negative class for samples from the positive class. Depending on the goal of our application, one type of error might be worse than the other, e.g., in a medical test we might rather tell someone that they should come in for a second test to confirm some problematic results than send them home with an undetected disease. By moving the classification threshold, we can control the trade-off between FP and FN.</span></div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Accuracy</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/error_class_accuracy.png" alt="image" width="440">
</div>
<div class="title"><span class="small">The accuracy is the most widely used classification evaluation metric, where we simply check, out of all samples, how many were classified correctly (i.e., TP and TN). However, this can be misleading for unequal class distributions and we should always compare the accuracy of the model against the &#8216;stupid baseline&#8217; for classification, i.e., what the accuracy would be for a &#8220;model&#8221; that always predicts the most frequent class.</span></div>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.metrics</span> <span class="keyword">import</span> <span class="include">accuracy_score</span></code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Unbalanced class distributions: Accuracy vs. Balanced Accuracy</dt>
<dd>
<p>Below we see the decision boundaries of two models on a toy dataset, where the background color indicates whether the model predicts the blue or red class for a data point in this area. Which model do you think is more useful?</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/balanced_acc4a.png" alt="image" width="640">
</div>
</div>
<div class="paragraph">
<p>With unbalanced class distributions, e.g., in this case a lot more samples from the blue compared to the red class, the accuracy of a model that simply always predicts the most frequent class can be quite large. But while a 90% accuracy might sound impressive when we report the performance of a model to the project&#8217;s stakeholders, this does not necessarily mean that the model is useful, especially since in real world problems the undersampled class is often the one we care about most, e.g., people with a rare disease or products that have a defect.</p>
</div>
<div class="paragraph">
<p>Instead, the balanced accuracy is often the more informative measure when evaluating classification models and can help us to distinguish between a model that has actually learned something and the &#8216;stupid baseline&#8217;:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/balanced_acc4b.png" alt="image" width="640">
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Balanced Accuracy</dt>
<dd>
<p>To avoid pitfalls of accuracy: consider misclassification rates of both classes separately:</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/error_class_balanced_accuracy.png" alt="image" width="440">
</div>
<div class="title"><span class="small">For the balanced accuracy, first the fraction of correctly classified points is computed for each class individually and then these values are averaged.</span></div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.metrics</span> <span class="keyword">import</span> <span class="include">balanced_accuracy_score</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Multi-class problems: micro vs. macro averaging</dt>
<dd>
<p>The accuracy and balanced accuracy scores can be generalized to the multi-class classification case. Here we instead use the terms micro- and macro-averaging to describe the two strategies (which can also be used for other kinds of metrics like the F1-score), where micro-averaging means we compute the score by averaging over all samples, while macro-averaging means we first compute the score for each class separately and then average over the values for the different classes.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Micro-averaged score (&#8594; <code>accuracy_score</code>):</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{aligned}
\frac{TP + TN}{TP + FN + TN + FP} = \frac{TP_\text{pos} + TP_\text{neg}}{n_\text{pos} + n_\text{neg}} &amp; \quad \Rightarrow \quad \frac{\sum_c TP_{c}}{\sum_c n_{c}}
\end{aligned}\]
</div>
</div>
<div class="paragraph">
<p>\(n_{c}\) : number of samples belonging to class \(c\)<br>
\(TP_{c}\) : number of correctly classified samples from class \(c\)</p>
</div>
<div class="paragraph">
<p>Macro-averaged score (&#8594; <code>balanced_accuracy_score</code>):</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{aligned}
\frac{1}{2} \left(\frac{TP}{TP+FN} + \frac{TN}{TN+FP} \right) = \frac{1}{2} \left(\frac{TP_\text{pos}}{n_\text{pos}} + \frac{TP_\text{neg}}{n_\text{neg}} \right) &amp; \quad \Rightarrow \quad \frac{1}{C} \sum_{c=1}^C \frac{TP_{c}}{n_{c}}
\end{aligned}\]
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Multi-class problems: Confusion matrix</dt>
<dd>
<p>Similarly, the table with the TP/FP/TN/FN entries can be extended for the multi-class classification case:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/confusion_matrix2.png" alt="image" width="740">
</div>
<div class="title"><span class="small">The heatmap on the left shows the (normalized) confusion matrix for a ten-class classification problem (recognizing handwritten digits), while the plot on the right shows example images for each case. Examining the confusion matrix and some individual examples can give us more faith in the predictions of our model, as we might realize that some misclassifications (highlighted in red) could also happen to a human, e.g., the 4 that was classified as a 1 or even the 4 that was classified as a 7 (which might even be a labeling error from when the dataset was originally created).</span></div>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.metrics</span> <span class="keyword">import</span> <span class="include">confusion_matrix</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_model_selection">Model Selection</h4>
<div class="paragraph">
<p>After we&#8217;ve chosen an appropriate evaluation metric for our problem, we can use the resulting scores to automatically select the best hyperparameters for a model and ultimately the best model.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">The case for an additional validation set</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/validation_set.png" alt="image" width="480">
</div>
<div class="title"><span class="small">As we&#8217;ve established in the beginning, before experimenting with any models, the dataset should be split into a training and test set. However, this isn&#8217;t all: Since we are typically experimenting with many different types of models and for each model type with dozens of hyperparameter settings, we should not use this test set to evaluate each of these model candidates, since it might happen that with all these things we try out, we end up choosing a model that just by chance performs well on this test set, but does not generalize to new data later and we would have no way of finding this out before deploying the model in production. Therefore, we introduce a new data split, the <strong>validation set</strong>, that is used to evaluate the different candidate models, while the test set remains locked away until we&#8217;re ready to evaluate our final model to get a realistic estimate of how it performs on new data.</span></div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If the original dataset is quite big, say, over 100k samples (depending on the diversity of the data, e.g., the number of classes), then it is usually enough to just split the data into training, validation, and test sets at the start, where the validation and test sets contain about 10% of the data each and should be representative of the diversity of the original dataset. However, when the original dataset is smaller, it might not be possible to get such representative splits, which is when a technique called <em>cross-validation</em> (&#8220;x-val&#8221;) comes in handy.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Especially when working with small datasets, it is important that these splits are well balanced, i.e., that all classes are represented equally in the training, validation, and test sets. This is also called stratified sampling.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Cross-Validation</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/cross_val.png" alt="image" width="540">
</div>
<div class="title"><span class="small">In a <strong><em>k</em>-fold cross-validation</strong>, the dataset is split into <em>k</em> parts, where each part is once the designated validation set, while the remaining <em>k-1</em> parts are used for training. This way, the model is trained and evaluated <em>k</em> times, each time on different splits. By computing the mean and standard deviation of the error metrics on all folds, we get a reliable estimate of the model&#8217;s generalization error and its variation due to the diversity of the dataset. The extreme case of the <em>k</em>-fold cross-validation is the <em>Leave-One-Out</em> cross-validation, where the model is always evaluated on only a single sample.</span></div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Most datasets are collected over longer time periods. Often, the <strong>samples are correlated over time</strong>, i.e., samples collected around the same time are more similar to each other than samples collected weeks or months apart. This is often very apparent in time series data (e.g., seasonality effects in sales data), but it can also true for other types of data (e.g., the topics discussed in newspaper articles change over time; a camera lens might slowly accumulate dust). To get a realistic estimate of how well the model will perform on new data, it is usually best to <strong>use the most recent samples as the test set</strong>. Additionally, it might be necessary to use a <a href="https://scikit-learn.org/stable/modules/cross_validation.html#time-series-split">time series split</a> for the cross-validation, where the model is always trained on past data and evaluated on newer data. If there is a big difference between the model performance on random vs. chronological train/validation splits, this is a strong indication that the samples are correlated over time!
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Hyperparameter Tuning</dt>
<dd>
<p>Often it is necessary to systematically evaluate a given model with different hyperparameter values to find the best settings. One straightforward approach for doing this is a <strong>grid search</strong>: In a grid search, we define the different values we want to test for each of the model&#8217;s hyperparameters and then all combinations of these different values for all hyperparameters are automatically evaluated, similar to how we would do it manually with nested for-loops. This is very useful, as often the different hyperparameter settings influence each other. Conveniently, sklearn furthermore combines this with a cross-validation. However, with many individual settings, this also comes at a computational cost, as the model is trained and evaluated \(k \times m_1 \times m_2 \times \dots \times m_i\) times, where \(k\) is the number of folds in the cross-validation and \(m_1...m_i\) are the number of values that need to be tested for each of the <em>i</em> hyperparameters of the model.<br></p>
<div class="paragraph">
<p>For example, with two hyperparameters, the grid search results could look something like the plot below, which shows a heatmap of the average accuracy achieved with each hyperparameter combination of a model in the cross-validation:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/grid_search.png" alt="image" width="360">
</div>
</div>
<div class="paragraph">
<p>While sklearn&#8217;s grid search method tells us directly what the best hyperparameter combination is out of the ones it tested (marked with a red star in the plot), it is important to check the complete set of results to verify that we have <strong>covered the whole range of possible hyperparameter values</strong> that could give good results. For example, in the plot above, we see a peak in the middle with the results getting worse to the sides, i.e., we know that better hyperparameter values are unlikely to lie outside of the range we&#8217;ve tested.<br>
It is generally a good idea to first start with a large range of values and then zoom in to the area that seems most promising. And of course knowledge about the different algorithms helps a lot in choosing reasonable settings as well.<br></p>
</div>
<div class="paragraph">
<p>Besides the basic grid search, there also exist other, more advanced hyperparameter tuning routines. For example, sklearn additionally implements a <strong>randomized search</strong>, and other dedicated libraries provide even fancier approaches, such as <a href="https://machinelearningmastery.com/what-is-bayesian-optimization/" target="\_blank">Bayesian optimization</a>.<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.model_selection</span> <span class="keyword">import</span> <span class="include">GridSearchCV</span>, <span class="include">RandomizedSearchCV</span></code></pre>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supervised_learning_models">Supervised Learning Models</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you&#8217;re familiar with the basics of supervised learning&#8201;&#8212;&#8201;problem types, algorithmic approaches, model evaluation and selection&#8201;&#8212;&#8201;we discuss the different features- and similarity-based models in more detail:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/04_supervised_intro/comparison_all4.png" alt="image" width="840">
</div>
</div>
<div class="sect2">
<h3 id="_linear_models">Linear Models</h3>
<div class="openblock float-group">
<div class="content">
<div class="paragraph">
<p><span class="image left"><img src="images/04_supervised_intro/comparison_linear.png" alt="image" width="180"></span></p>
</div>
<div class="paragraph">
<p>The first type of supervised learning model that we&#8217;ll look at in more detail are linear models, which are a type of features-based model that are very efficient (i.e., can be used with large datasets), but, as the name suggests, are only capable of describing linear relationships between the input and target variables.</p>
</div>
</div>
</div>
<div class="paragraph">
<p><br>
Linear models can be used for regression problems (&#8594; the standard linear regression model that you might have already heard of) as well as for classification problems (&#8594; logistic regression, which predicts a probability score between 0 and 1):</p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="images/05_supervised_other/linreg.png" alt="image" width="340"></span>
<span class="image"><img src="images/05_supervised_other/logreg.png" alt="image" width="340"></span></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Main idea</dt>
<dd>
<p>Prediction is a linear combination of the input features (and intercept \(b\)):</p>
</dd>
</dl>
</div>
<div class="stemblock">
<div class="content">
\[f(\mathbf{x}; \mathbf{w}) = b + \langle\mathbf{w}, \mathbf{x}\rangle = b + \sum_{k=1}^d w_k \cdot x_k = \hat{y}\]
</div>
</div>
<div class="paragraph">
<p><strong>Linear Regression</strong>:<br>
Find \(\mathbf{w}\) that minimizes MSE \(\| \mathbf{y} - \mathbf{\hat y}\|_2^2\) with \(\hat y\) computed as in the formula above.</p>
</div>
<div class="paragraph">
<p><strong>Logistic Regression</strong> (&#8594; for classification problems!):<br>
Make predictions as</p>
</div>
<div class="stemblock">
<div class="content">
\[\sigma\left(b + \langle\mathbf{w}, \mathbf{x}\rangle\right) = \hat y\quad\quad \text{with: } \sigma(z) = \frac{1}{1+e^{-z}} \quad \Rightarrow\; \hat y  \in [0, 1]\]
</div>
</div>
<div class="paragraph">
<p>where \(\sigma(z)\) is the so-called sigmoid (or logistic) function that squeezes the output of the linear model within the interval \([0, 1\)] (i.e., the S-curve shown in the plot above).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.linear_model</span> <span class="keyword">import</span> <span class="include">LinearRegression</span>, <span class="include">LogisticRegression</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Linear models are good for small datasets.</p>
</li>
<li>
<p>Extensions for nonlinear problems exist &#8658; feature engineering (e.g., including interaction terms), GAMs, etc.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When a statistician tells you that they did a &#8220;polynomial regression&#8221; what they really mean is that they did some feature engineering to include new variables like \(x_5^2\) and \(x_2^3x_7\) and then fitted a linear regression model on this extended set of features. This means the model is still linear in the parameters, i.e., the prediction is still a linear combination of the inputs, but some of the inputs are now polynomial terms computed from the original features.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Regularization (to keep \(\mathbf{w}\) in check) is often a good idea.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h4 id="_regularization" class="discrete">Regularization</h4>
<div class="paragraph">
<p>Motivation: For uncorrelated but noisy data, which model should you choose?</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_other/regularization_motivation2.png" alt="image" width="420">
</div>
</div>
<div class="paragraph">
<p>&#8658; Regularization = assume no relationship between \(x\) and \(y\) unless the data strongly suggests otherwise.</p>
</div>
<div class="paragraph">
<p>This is accomplished by imposing constraints on the model&#8217;s weights by adding penalty terms in the optimization:</p>
</div>
<div class="stemblock">
<div class="content">
\[\min_\mathbf{w}\; \underbrace{\sum_{i=1}^n (y_i - (b + \langle\mathbf{w},\mathbf{x}_i\rangle))^2}_{\text{Linear Regression}} + \lambda_1 \underbrace{\sum_{k=1}^d |w_k|}_{L1} + \lambda_2 \underbrace{\sum_{k=1}^d w_k^2}_{L2}\]
</div>
</div>
<div class="paragraph">
<p>This means the optimal solution now not only achieves a low MSE between the true and predicted values (i.e., the normal linear regression error), but additionally does so with the smallest possible weights. (The regularization therefore also defines a unique solution in the face of collinearity.)</p>
</div>
<div class="paragraph">
<p><strong><em>L1</em> Regularization</strong> (&#8594; Lasso Regression): Sparse weights (i.e., many 0, others normal)<br>
 &#8594; Good for data with possibly irrelevant features.</p>
</div>
<div class="paragraph">
<p><strong><em>L2</em> Regularization</strong> (&#8594; Ridge Regression): Small weights<br>
 &#8594; Computationally beneficial; can help for data with outliers.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When you&#8217;re working with a new dataset, it often includes lots of variables, many of which might not be relevant for the prediction problem. In this case, an <em>L1</em>-regularized model is helpful to sort out irrelevant features. Then, when you are sure which input variables are relevant for the prediction problem, an <em>L2</em>-regularized model gives a robust performance.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.linear_model</span> <span class="keyword">import</span> <span class="include">RidgeCV</span>, <span class="include">LassoLarsCV</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Regularization is also used in many other <code>sklearn</code> models. Depending on the type of model (for historical reasons), what we denoted as \(\lambda\) in the formula above is a hyperparameter that is either called <code>alpha</code> or <code>C</code>, where you have to be careful, because while for <code>alpha</code> higher values mean more regularization (i.e., this acts exactly as the \(\lambda\) in the formula above), when the model instead has the hyperparameter <code>C</code>, here higher values mean <em>less</em> regularization!
</td>
</tr>
</table>
</div>
<h4 id="_generalized_additive_models_gams" class="discrete">Generalized Additive Models (GAMs)</h4>
<div class="paragraph">
<p>GAMs are a very powerful generalization of linear models. While in a linear regression, the target variable is modeled as a sum of linear functions of the input variables (parametrized by the respective coefficients), GAMs instead fit a smooth function \(f_k(x_k)\) to each input variable and then predict the target variable as a sum of these:</p>
</div>
<div class="stemblock">
<div class="content">
\[\hat{y} = b + \sum_{k=1}^d \; w_k \cdot x_k \quad\quad \Rightarrow \quad\quad \hat{y} = b + \sum_{k=1}^d \; f_k(x_k)\]
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_other/gam2.png" alt="image" width="740">
</div>
</div>
<div class="paragraph">
<p>&#8594; <code>gam</code> library in R; Python: <a href="https://pygam.readthedocs.io/" target="\_blank"><code>pyGAM</code></a>, <a href="https://github.com/interpretml/interpret" target="\_blank"><code>interpret</code></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_neural_networks">Neural Networks</h3>
<div class="openblock float-group">
<div class="content">
<div class="paragraph">
<p><span class="image left"><img src="images/04_supervised_intro/comparison_nn.png" alt="image" width="180"></span></p>
</div>
<div class="paragraph">
<p>Next up are neural networks (NN), which can be used to solve extremely complex problems (besides regular supervised learning tasks), but that are also rather data hungry (depending on the size of the network).<br>
We&#8217;ll only cover the basics here; more advanced NN architectures, like those used to process image and text data, are discussed in the chapter on <a href="#_deep_learning_2">Deep Learning</a>.</p>
</div>
</div>
</div>
<div class="sidebarblock text-center">
<div class="content">
<div class="paragraph">
<p><strong>Basic Math</strong></p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{aligned}
\begin{pmatrix}
W_{11} &amp; W_{12} &amp; \cdots &amp; W_{1j}\\
W_{21} &amp; W_{22} &amp; \cdots &amp; W_{2j}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
W_{i1} &amp; W_{i2} &amp; \cdots &amp; W_{ij}\\
\end{pmatrix}
\end{aligned}\]
</div>
</div>
<div class="paragraph">
<p><strong>Dangerous Artificial Intelligence</strong></p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{aligned}
\begin{pmatrix}
W_{11} &amp; W_{12} &amp; \cdots &amp; W_{1j}\\
W_{21} &amp; W_{22} &amp; \cdots &amp; W_{2j}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
W_{i1} &amp; W_{i2} &amp; \cdots &amp; W_{ij}\\
\end{pmatrix} \cdot
\begin{pmatrix}
W_{11} &amp; W_{12} &amp; \cdots &amp; W_{1k}\\
W_{21} &amp; W_{22} &amp; \cdots &amp; W_{2k}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
W_{j1} &amp; W_{j2} &amp; \cdots &amp; W_{jk}\\
\end{pmatrix} \cdot
\begin{pmatrix}
W_{11} &amp; W_{12} &amp; \cdots &amp; W_{1l}\\
W_{21} &amp; W_{22} &amp; \cdots &amp; W_{2l}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
W_{k1} &amp; W_{k2} &amp; \cdots &amp; W_{kl}\\
\end{pmatrix} \cdot
\begin{pmatrix}
W_{11} &amp; W_{12} &amp; \cdots &amp; W_{1m}\\
W_{21} &amp; W_{22} &amp; \cdots &amp; W_{2m}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
W_{l1} &amp; W_{l2} &amp; \cdots &amp; W_{lm}\\
\end{pmatrix}
\end{aligned}\]
</div>
</div>
<div class="paragraph">
<p><span class="small">Deep learning just means using more matrices.</span></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_overview">Overview</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Recap: Linear Models</dt>
<dd>
<p>Prediction is a linear combination of input features (and intercept / bias term \(b\)):</p>
<div class="stemblock">
<div class="content">
\[f(\mathbf{x}; \mathbf{w}) = b + \langle\mathbf{w},\mathbf{x}\rangle = b + \sum_{k=1}^d w_k \cdot x_k = \hat{y}\]
</div>
</div>
<div class="paragraph">
<p>In the case of multiple outputs \(\mathbf{y}\) (e.g., in a multi-class classification problem \(\mathbf{y}\) could contain the probabilities for all classes):</p>
</div>
<div class="stemblock">
<div class="content">
\[f(\mathbf{x}; W) = \mathbf{x^\top}W = \mathbf{\hat{y}}\]
</div>
</div>
<div class="paragraph">
<p>For simplicity, we omit the bias term \(b\) here; using a bias term is equivalent to including an additional input feature that is always 1.</p>
</div>
</dd>
<dt class="hdlist1">Intuitive Explanation of Neural Networks</dt>
<dd>
<p><span class="small">[Adapted from: &#8220;AI for everyone&#8221; by Andrew Ng (coursera.org)]</span></p>
<div class="paragraph">
<p>Let&#8217;s say we have an online shop and are trying to predict how much of a product we will sell in the next month. The price we are willing to sell the product for will obviously influence the demand, as people are trying to get a good deal, i.e., the lower the price, the higher the demand; a negative correlation that can be captured by a linear model. However, the demand will never be below zero (i.e., when the price is very high, people wont suddenly return the product), so we need to adapt the model such that the predicted output is never negative. This can be achieved by applying the max function, in this context also called a nonlinear activation function, to the output of the linear model, so that now when the linear model would return a negative value, we instead predict 0.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/neural_network_intuitive_a4.png" alt="image" width="440">
</div>
<div class="title"><span class="small">A very simple linear model with one input and one output variable and a nonlinear activation function (the max function).</span></div>
</div>
<div class="paragraph">
<p>This functional relationship can be visualized as a circle with one input <em>(price)</em> and one output <em>(demand)</em>, where the S-curve in the circle indicates that a nonlinear activation function is applied to the result. We will later see these circles as single units or &#8220;neurons&#8221; of a neural network.</p>
</div>
<div class="paragraph">
<p>To get better results, we can extend the model and use multiple input features for the prediction:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/neural_network_intuitive_b2.png" alt="image" width="540">
</div>
<div class="title"><span class="small">A linear model with multiple inputs, where the prediction is computed as a weighted sum of the inputs, together with the max function to prevent negative values.</span></div>
</div>
<div class="paragraph">
<p>To improve the performance even further, we could now manually construct more informative features from the original inputs by combining them in meaningful ways (&#8594; feature engineering) before computing the output:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/neural_network_intuitive_b6.png" alt="image" width="540">
</div>
<div class="title"><span class="small">Our example is about an online shop, so the customers additionally have to pay shipping fees, which means to reflect the true affordability of the product, we need to combine the product price with the shipping costs. Next, the customers are interested in high quality products. However, not only the actual quality of the raw materials we used to make the product influences how the customers perceive the product, but we can also reinforce the impression that the product is of high quality with a marketing campaign. Furthermore, a high price also suggests that the product is superior. This means by creating these additional features, the price can actually contribute in two ways towards the final prediction: while, on the one hand, a lower price is beneficial for the affordability of the product, a higher price, on the other hand, results in a larger perceived quality.</span></div>
</div>
<div class="paragraph">
<p>While in this toy example, it was possible to construct such features manually, the nice thing about neural networks is that they do exactly that automatically: By using multiple layers, i.e., stacking multiple linear models (with nonlinear activation functions) on top of each other, it is possible to create more and more complex combinations of the original input features, which can improve the performance of the model. The more layers the network uses, i.e., the &#8220;deeper&#8221; it is, the more complex the resulting feature representations.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Since different tasks and especially different types of input data benefit from different feature representations, there exist different types of neural network architectures to accommodate this, e.g.</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8594; Feed Forward Neural Networks (FFNNs), also called Multi-Layer Perceptrons (MLPs), for &#8216;normal&#8217; (e.g., structured) data</p>
</li>
<li>
<p>&#8594; Convolutional Neural Networks (CNNs) for images</p>
</li>
<li>
<p>&#8594; Recurrent Neural Networks (RNNs) for sequential data like text or time series</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ll only cover FFNNs here; the other architectures are discussed in the chapter on <a href="#_deep_learning_2">Deep Learning</a>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>State-of-the-art performance (especially on data with <a href="https://towardsdatascience.com/geometric-foundations-of-deep-learning-94cdd45b451d" target="\_blank">input invariances</a>).</p>
</li>
<li>
<p>Prediction for new test points is fast (just a few matrix multiplications).</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Can take a long time to train (use a GPU!!! (or <a href="https://en.wikipedia.org/wiki/Tensor_Processing_Unit" target="\_blank">TPU</a>)).</p>
</li>
<li>
<p>Need a lot of data (depending on the size of the NN architecture).</p>
</li>
<li>
<p>Solution only a local optimum (which is usually not too problematic in practice, as there are many good optima).</p>
</li>
<li>
<p>Tricky to train: Performance depends on many parameters like learning rate, batch size, and even the random seed used when initializing the weights!</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_feed_forward_neural_network_ffnn">Feed Forward Neural Network (FFNN)</h5>
<div class="paragraph">
<p>This is the original and most straightforward neural network architecture, which we&#8217;ve already seen in the initial example, only that in practice such a model usually has a few more layers and units per layer.
Each layer here is basically a linear model, i.e., it consists of a weight matrix \(W_i\) and some nonlinear activation function \(\sigma_i\) that is applied to the output. These layers are applied sequentially to the input features \(\mathbf{x}\), i.e., the network computes a composite function (in this case for three layers):</p>
</div>
<div class="stemblock">
<div class="content">
\[f(\mathbf{x}) = \sigma_3(\sigma_2(\sigma_1(\mathbf{x^\top}W_1)W_2)W_3) = \mathbf{\hat{y}}\]
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/neural_network.png" alt="image" width="840">
</div>
<div class="title"><span class="small">Feed Forward Neural Network (FFNN) architecture: The input feature vector \(\mathbf{x}\), representing one data point, is multiplied by the first weight matrix \(W_1\) to create a new vector, which, after applying the nonlinear activation function (e.g., the max function as we&#8217;ve seen in the initial example) results in the first hidden layer representation \(\mathbf{x}'\). This new vector is then multiplied by the second weight matrix \(W_2\) and again a nonlinear activation function is applied to yield the second hidden layer representation of the sample, \(\mathbf{x}''\). Depending on how many layers the network has (i.e., how deep it is), this could be repeated multiple times now until finally the last layer computes the predicted output \(\mathbf{\hat{y}}\). While the network is trained, these predicted outputs gets closer and closer to the true outputs for the training samples.</span></div>
</div>
<div class="paragraph">
<p>For a regression problem, the output of the network would be a direct prediction of the target values (i.e., without applying a final nonlinear activation function), while for a classification problem, the output consists of a vector with probabilities for the different classes, created by applying a softmax activation function on the output, which ensures all values are between 0 and 1 and sum up to 1.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Test your understanding</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Why do we need the nonlinear activation functions between the layers, i.e., how could we simplify a network with multiple layers, if it didn&#8217;t have any nonlinear activation functions between the layers?</p>
</li>
<li>
<p>In what way could we manipulate the parameters (i.e., weight matrices) of an existing neural network without changing its predictions? (This is also a reason why there exist many equally good local optima.)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Number of hidden layers and units: </dt>
<dd>
<p>While the size of the input and output layers are determined by the number of input features and targets respectively, the dimensionality and number of hidden layers of the network is up to us. Usually, the hidden layers get smaller (i.e., have fewer units) as the data moves from the input to the output layer and when experimenting with different settings we can start with no hidden layers (which should give the same result as a linear model) and then progressively increase the size of the network until the performance stops improving. Just <a href="https://playground.tensorflow.org/" target="\_blank">play around</a> a bit.</p>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Training Neural Networks</dt>
<dd>
<p>To train a neural network, we first need to choose a loss function that should be optimized (e.g., mean squared error for regression problems or cross-entropy for classification problems).<br></p>
<div class="paragraph">
<p>While for a linear regression model, the optimal weights can be found analytically by setting the derivative of this loss function to 0 and solving for the weights, in a network with multiple layers and therefore many more weights, this is not feasible. Instead, the weights are tuned iteratively using a <strong>gradient descent</strong> procedure, where the derivative of the loss function w.r.t. each layer is computed step by step using the chain rule by basically pushing the error backwards through the network (i.e., from the output, where the error is computed, to the input layer), also called error <strong>backpropagation</strong>. At the beginning, all weight matrices are randomly initialized, so, for example, for a classification problem, for a given sample the network would predict approximately equal probabilities for all classes. The weights are then adapted according to their gradient, such that the next time the same samples are passed through the network, the prediction will be closer to the true output (and the value of the loss function is closer to a local minima).<br></p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/loss_surface.png" alt="image" width="460">
</div>
<div class="title"><span class="small">Training loss surface over the network&#8217;s parameter space (simplified, i.e., showing only two weights (\(\theta_1\) and \(\theta_2\)), while in reality, this would be a super complex nonlinear function in a very high-dimensional space), where every possible weight configuration of a network results in a different loss on the training set. By taking a step into the direction of steepest descent of this loss function, the weights of the network get closer to a configuration where the loss is at a local minimum.</span></div>
</div>
<div class="paragraph">
<p>Typically, the weights are adapted over multiple <strong>epochs</strong>, where one epoch means going over the whole training set once.
By plotting the <a href="https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/" target="\_blank">learning curves</a>, i.e., the training and validation loss against the number of training epochs, we can check whether the training was successful (i.e., whether the weights have converged to a good solution).</p>
</div>
<div class="paragraph">
<p>Since a training set usually contains lots of data points, it would be too computationally expensive to do gradient descent based on the whole dataset at once in each epoch, so we instead use mini-<strong>batches</strong>, i.e., subsets of usually 16-128 data points, for each training step.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tips_tricks">Tips &amp; Tricks</h4>
<div class="ulist">
<ul>
<li>
<p>Scale the data (for classification tasks only inputs, for regression tasks also outputs or adapt the bias of the last layer; <code>StandardScaler</code> is usually a good choice) as otherwise the weights have to move far from their initialization to scale the data for us.</p>
</li>
<li>
<p>Use sample weights for classification problems with unequal class distributions.</p>
</li>
<li>
<p>NN are trained with gradient descent, which requires a good learning rate (i.e., step size for each training iteration &#8594; not too small, otherwise nothing is learned, not too big, otherwise it spirals out of control):</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/nn_learning_rate4.png" alt="image" width="540">
</div>
<div class="title"><span class="small">A simple strategy to select a suitable initial learning rate is to train the network with different learning rates for one epoch on a subsample of the dataset and then check the loss after training. For too small learning rates (left), the loss will stay the same, while for too large learning rates (right) the loss will be higher after training.</span></div>
</div>
</li>
<li>
<p>Sanity check: A linear network (i.e., a FFNN with only one layer mapping directly from the inputs to the outputs) should achieve approximately the same performance as the corresponding linear model from sklearn.</p>
</li>
<li>
<p>Gradually make the network more complex until it can perfectly memorize a small training dataset (to get a network that has enough capacity to at least in principle capture the complexity of the task).</p>
</li>
<li>
<p>When selecting hyperparameters, always check if there is a clear trend towards an optimal setting; if the pattern seems random, initialize the network with different random seeds to see how robust the results are.</p>
</li>
<li>
<p>Using a learning rate scheduler (to decrease the learning rate over time to facilitate convergence) or early stopping (i.e., stopping the training when the performance on the validation set stops improving) can improve the generalization performance.</p>
</li>
<li>
<p>But often it is more important to train the network long enough, like, for hundreds of epochs (depending on the dataset size).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="small">&#8594; more tips for training NN: <a href="http://karpathy.github.io/2019/04/25/recipe/" class="bare">http://karpathy.github.io/2019/04/25/recipe/</a></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_decision_trees">Decision Trees</h3>
<div class="openblock float-group">
<div class="content">
<div class="paragraph">
<p><span class="image left"><img src="images/04_supervised_intro/comparison_dt.png" alt="image" width="180"></span></p>
</div>
<div class="paragraph">
<p>Next, we&#8217;ll look at decision trees, another type of features-based model that is very efficient as well, but can also capture more complex relationships between inputs and output.</p>
</div>
</div>
</div>
<div class="paragraph">
<p><br>
We&#8217;ll describe the decision tree algorithm with the help of an example dataset:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Example: Iris Dataset</dt>
<dd>
<p>The famous Iris dataset was initially studied by the influential statistician R. Fisher. It includes samples from three different types of Iris flowers, each described by four measurements. The task is to classify to which type of Iris flower a sample belongs:</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_other/iris_dataset.png" alt="image" width="640">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Main idea</dt>
<dd>
<p>Iteratively set a threshold on one of the features such that the remaining samples are split into two &#8220;cleaner&#8221; groups, where &#8220;clean&#8221; means that all samples in a group have a similar label, e.g., belong to the same class in case of a classification problem:</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_other/decision_tree_iris2.png" alt="image" width="840">
</div>
<div class="title"><span class="small"><em>Left:</em> Scatter plot of the data, which shows how the splits of the decision tree translate into a decision surface in the feature space, which also shows the characteristic cuts orthogonal to the respective axis (&#8594; new points are classified according to the color of the shaded areas). <em>Right:</em> Illustration of the learned decision tree: Starting left at the root of the tree, the first decision is made to split the data at the &#8216;petal width&#8217; feature, where all samples with a value smaller than 0.8 are classified as setosa Irises (&#8658; perfectly clean group at this leaf) and the other samples advance to a followup decision. In the lower branch of the tree, the remaining samples are now split again according to their petal width and then again at their petal length (it is a coincidence that the same variable is used in both branches at this level to make the cut). Eventually, at each leaf (i.e., terminal node of the tree), the samples that ended up there are mostly from one single class, i.e., the decision tree succeeded in splitting the dataset into cleaner groups. (Please note that decision trees are normally drawn from top to bottom and, unlike real trees, their root is at the top and their branches and leaves grow towards the bottom&#8201;&#8212;&#8201;the computer scientist who came up with binary trees probably spent too much time indoors&#8230;&#8203;).</span></div>
</div>
<div class="paragraph">
<p>To classify a new sample (i.e., if we went for a walk and found an Iris flower and decided to measure it), we compare the flower&#8217;s measurements to the thresholds in the tree (starting at the root) and depending on the leaf we end up in we get a prediction for the Iris type as the most frequent class of the training samples that ended up in this leaf. For regression problems, the tree is built in the same way, but the final prediction is given as the mean of the target variable of the training samples in a leaf.</p>
</div>
<div class="paragraph">
<p>The decision tree algorithm comes up with the decisions by essentially examining the histograms of all features at each step to figure out for which of the features the distributions for the different classes is separated the most and then sets a threshold there to split the samples.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.tree</span> <span class="keyword">import</span> <span class="include">DecisionTreeClassifier</span>, <span class="include">DecisionTreeRegressor</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="underline">Important Parameters:</span></p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8594; <code>max_depth</code>: Maximum number of decisions to make about a sample.</p>
</li>
<li>
<p>&#8594; <code>min_samples_leaf</code>: How many samples have to end up in each leaf (at least), to prevent overly specific leaves with only a few samples.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Easy to interpret (i.e., we know exactly what decisions were made to arrive at the prediction).</p>
</li>
<li>
<p>Good for heterogeneous data: no normalization necessary since all features are considered individually.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>If the hyperparameters (e.g., <code>min_samples_leaf</code>) aren&#8217;t set appropriately, it can happen that the tree becomes very specific and memorizes individual samples, which means it probably wont generalize well to new data points (also called &#8220;overfitting&#8221;, e.g., in the example above, one of the leaves contains only three samples, which might not have been a very useful split).</p>
</li>
<li>
<p>Unstable: small variations in the data can lead to very different trees.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_ensemble_methods">Ensemble Methods</h3>
<div class="paragraph">
<p>What is better than one model? Multiple models!</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Main idea</dt>
<dd>
<p>Train multiple models &amp; combine their predictions (regression: average; classification: most frequent class).</p>
</dd>
</dl>
</div>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8594; Different types of models.</p>
</li>
<li>
<p>&#8594; Same type of model but with different hyperparameter settings (this can also include the random seed used when initializing the model, e.g., for neural networks).</p>
</li>
<li>
<p>&#8594; Models trained on different subsets of the data (different selections of samples and/or features).</p>
</li>
<li>
<p>&#8594; Boosting: models are trained sequentially and each additional model focuses on those data points that the previous models got wrong.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>More stable prediction (tip: use individual models that on their own overfit a bit).</p>
</li>
<li>
<p>Get an estimate of how certain the prediction is &#8594; how many models agree?</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Computationally expensive (depending on the models used).</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Popular example</dt>
<dd>
<p><em>Random Forest</em>: Multiple decision trees trained on random subsamples of the data, thereby exploiting the fact that decision trees can be sensitive to small variations in the dataset.<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.ensemble</span> <span class="keyword">import</span> <span class="include">RandomForestClassifier</span>, <span class="include">RandomForestRegressor</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For more advanced approaches, check out the voting ensemble and boosting methods from <a href="https://scikit-learn.org/stable/modules/ensemble.html" target="\_blank">sklearn</a>, with which arbitrary models can be combined into an ensemble.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Ensemble methods like random forests and gradient boosting trees give very good results on real world structured datasets and dominate the leader boards for many competitions at <a href="https://www.kaggle.com/" target="\_blank">Kaggle</a>, a website where companies can upload datasets for data scientists to benchmark themselves against each other and even win prize money.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_k_nearest_neighbors_knn">k-Nearest Neighbors (kNN)</h3>
<div class="openblock float-group">
<div class="content">
<div class="paragraph">
<p><span class="image left"><img src="images/04_supervised_intro/comparison_knn.png" alt="image" width="180"></span></p>
</div>
<div class="paragraph">
<p>The first similarity-based model we&#8217;ll look at is <em>k</em>-nearest neighbors (kNN), which follows a rather naive and straightforward approach, but nevertheless often achieves a good performance on complex problems.</p>
</div>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Main idea</dt>
<dd>
<p>For a new sample, identify the <em>k</em> most similar training data points and predict the average of their target values / their most frequent class:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_other/knn.png" alt="image" width="640">
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This kind of approach is also called <em>Lazy Learning</em>, since the model doesn&#8217;t actually learn any kind of internal parameters, but all the real computation only happens when we make a prediction for a new data point.<br>
(When calling the fit-method on the sklearn model, a search tree is built to efficiently identify the nearest neighbors for a new data point.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.neighbors</span> <span class="keyword">import</span> <span class="include">KNeighborsRegressor</span>, <span class="include">KNeighborsClassifier</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="underline">Important Parameters:</span></p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8594; <code>n_neighbors</code>: How many nearest neighbors to consider when making a prediction.</p>
</li>
<li>
<p>&#8594; <code>metric</code>: How to compute the similarity between the samples (default: Euclidean distance).</p>
</li>
<li>
<p>&#8594; <code>weights</code>: By setting this to <code>'distance'</code> instead of the default <code>'uniform'</code>, the labels of the nearest neighbors contribute to the prediction proportionally to their distance to the new data point.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Intuitive approach.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Results completely depend on the similarity measure.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_kernel_methods">Kernel Methods</h3>
<div class="openblock float-group">
<div class="content">
<div class="paragraph">
<p><span class="image left"><img src="images/04_supervised_intro/comparison_kernel.png" alt="image" width="180"></span></p>
</div>
<div class="paragraph">
<p>Kernel methods are more sophisticated similarity-based models and were the hot stuff in the late 90s, when datasets were still of moderate size and computers weren&#8217;t fast enough to train large neural networks. They have some elegant math behind them, but please don&#8217;t be discouraged, if you don&#8217;t fully understand it the first time you read it&#8201;&#8212;&#8201;this is completely normal 😉.</p>
</div>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Main idea / &#8220;Kernel Trick&#8221;</dt>
<dd>
<p>By working on similarities (computed with special <em>kernel functions</em>) instead of the original features, linear methods can be applied to solve nonlinear problems.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Assume there exists some function \(\phi(\mathbf{x})\) (also called a &#8216;feature map&#8217;) with which the input data can be transformed in such a way that the problem can be solved with a linear method (basically the ideal outcome of feature engineering).<br>
For example, in the simple toy dataset shown below, the two classes become linearly separable when projecting the original input features into the space of their second order monomials:</p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="images/05_supervised_other/kernels_xspace.png" alt="image" width="340"></span> &#8594; \(\phi(\mathbf{x})\) &#8594;
<span class="image"><img src="images/05_supervised_other/kernels_zspace.png" alt="image" width="340"></span><br>
<span class="small">In the original 2D representation on the left, we need a circle (i.e., a nonlinear function) to separate the blue from the red points, while in the 3D plot on the right, the data points are arranged in a cone shape, where we can cut off the red points at the tip of the cone with a hyperplane.</span></p>
</div>
<div class="paragraph">
<p>Of course, coming up with such a feature map \(\phi(\mathbf{x})\), especially for more complex problems, isn&#8217;t exactly easy. But as you will see, we don&#8217;t actually need to know what this transformation looks like!</p>
</div>
<div class="paragraph">
<p><span class="underline"><strong>Example:</strong> Kernel Ridge Regression</span></p>
</div>
<div class="paragraph">
<p>Remember: In a linear regression model, the prediction for a new data point \(\mathbf{x}'\) is computed as the scalar product of the feature vector with the weight vector \(\mathbf{w}\):</p>
</div>
<div class="stemblock">
<div class="content">
\[\hat{y}' = \mathbf{x}' \mathbf{w}\]
</div>
</div>
<div class="paragraph">
<p>(for simplicity, we omit the bias term here; using a bias term is equivalent to including an additional input feature that is always 1).</p>
</div>
<div class="paragraph">
<p>The parameters of a linear ridge regression model are found by taking the derivative of the objective function,</p>
</div>
<div class="stemblock">
<div class="content">
\[\| \mathbf{y} - \mathbf{Xw}\|_2^2 + \lambda \| \mathbf{w}\|_2^2\]
</div>
</div>
<div class="paragraph">
<p>with respect to \(\mathbf{w}\), setting it to 0, and solving for \(\mathbf{w}\) (i.e. to find the minimum). This gives the following solution:</p>
</div>
<div class="stemblock">
<div class="content">
\[\mathbf{w} = (\mathbf{X}^\top \mathbf{X} +\lambda I)^{-1}\mathbf{X}^\top \mathbf{y}\]
</div>
</div>
<div class="paragraph">
<p>where \(\mathbf{X} \in \mathbb{R}^{n \times d}\) is the feature matrix of the training data and \(\mathbf{y} \in \mathbb{R}^n\) are the corresponding target values.</p>
</div>
<div class="paragraph">
<p>Now we replace every occurrence of the original input features \(\mathbf{x}\) in the formulas with the respective feature map \(\phi(\mathbf{x})\) and do some linear algebra:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{aligned}
\hat{y}' &amp;= \phi(\mathbf{x}') \mathbf{w} \quad\quad\quad\text{ with }\; \mathbf{w} = (\phi(\mathbf{X})^\top \phi(\mathbf{X}) +\lambda I)^{-1}\phi(\mathbf{X})^\top \mathbf{y}\\
&amp;= \phi(\mathbf{x}') (\phi(\mathbf{X})^\top \phi(\mathbf{X}) +\lambda I)^{-1}\phi(\mathbf{X})^\top \mathbf{y}\\
&amp; \quad\quad\vdots\\
&amp;= \underbrace{\phi(\mathbf{x}')\phi(\mathbf{X})^\top}_{\mathbf{k}'= k(\mathbf{x'}, \mathbf{X})} (\underbrace{\phi(\mathbf{X}) \phi(\mathbf{X})^\top}_{\mathbf{K} = k(\mathbf{X}, \mathbf{X})} +\lambda I)^{-1} \mathbf{y}\\
&amp;= \mathbf{k}'\underbrace{(\mathbf{K}  +\lambda I)^{-1} \mathbf{y}}_{\mathbf{\alpha}} = \sum_{i=1}^n k(\mathbf{x}', \mathbf{x}_i) \alpha_i
\end{aligned}\]
</div>
</div>
<div class="paragraph">
<p>After the reformulation, every \(\phi(\mathbf{x})\) only occurs in scalar products with other \(\phi(\mathbf{x})\), and all these scalar products were replaced with a so-called <em>kernel function</em> \(k(\mathbf{x}', \mathbf{x})\), where \(k(\mathbf{X}, \mathbf{X}) = \mathbf{K} \in \mathbb{R}^{n \times n}\) is the <em>kernel matrix</em>, i.e., the similarity of all training points to themselves, and \(k(\mathbf{x}', \mathbf{X}) = \mathbf{k}' \in \mathbb{R}^{n}\) is the <em>kernel map</em>, i.e., the similarities of the new data point to all training points.</p>
</div>
<div class="paragraph">
<p>The prediction \(\hat{y}'\) is now computed as a weighted sum of the similarities in the kernel map, i.e., while in the normal linear regression model the sum goes over the number of input features <em>d</em> and the weight vector is denoted as \(\mathbf{w}\), here the sum goes over the number of data points <em>n</em> and the weight vector is called \(\mathbf{\alpha}\).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Kernel Functions</strong> \(k(\mathbf{x}', \mathbf{x})\)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A kernel function is basically a similarity function, but with the special requirement that the similarity matrix computed using this function, also called the <em>kernel matrix</em>, is positive semi-definite, i.e., has only eigenvalues \(\geq 0\).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There exist different kinds of kernel functions and depending on how they are computed, they induce a different kind of kernel feature space \(\phi(\mathbf{x})\), where computing the kernel function for two points is equivalent to computing the scalar product of their vectors in this kernel feature space.</p>
</div>
<div class="paragraph">
<p>We illustrate this on the initial example, where the data was projected into the space of second order monomials. When we compute the scalar product between the feature maps of two vectors \(\mathbf{a}\) and \(\mathbf{b}\), we arrive at a polynomial kernel of second degree:</p>
</div>
<div class="stemblock">
<div class="content">
\[\langle\phi(\mathbf{a}), \phi(\mathbf{b})\rangle = (a_1^2, \sqrt{2}a_1a_2, a_2^2)(b_1^2, \sqrt{2}b_1b_2, b_2^2)^\top
= \langle\mathbf{a}, \mathbf{b}\rangle^2
=: k(\mathbf{a}, \mathbf{b})\]
</div>
</div>
<div class="paragraph">
<p>i.e, computing the kernel function \(k(\mathbf{a}, \mathbf{b}) = \langle\mathbf{a}, \mathbf{b}\rangle^2\) between the two points is the same as computing the scalar product of the two feature maps \(\langle\phi(\mathbf{a}), \phi(\mathbf{b})\rangle\).</p>
</div>
<div class="paragraph">
<p>While for the polynomial kernel of second degree, \(\langle\mathbf{a}, \mathbf{b}\rangle^2\), we could easily figure out that the feature map consisted of the second order monomials, for other kernel functions, the corresponding feature map is not that easy to identify and the kernel feature space might even be infinite dimensional. However, since all the feature map terms \(\phi(\mathbf{x})\) in the kernel ridge regression formulas only occurred in scalar products, we were able to replace them by a kernel function, which we can compute using the original input feature vectors. Therefore, we don&#8217;t actually need to know what the respective feature map looks like for other kernel functions!<br>
So while kernel methods are internally working in this really awesome kernel feature space \(\phi(\mathbf{x})\), induced by the respective kernel function, where all our problems are linear, all we need to know is how to compute the kernel function using the original feature vectors.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are curious what the kernel feature space looks like for some kernel function, you can use kernel PCA to get an approximation of \(\phi(\mathbf{x})\). Kernel PCA computes the eigendecomposition of a given kernel matrix, thereby generating a new representation of the data such that the scalar product of these new vectors approximates the kernel matrix. This means the new kernel PCA feature vector computed for some data point \(i\) approximates \(\phi(\mathbf{x}_i)\)&#8201;&#8212;&#8201;however, this still doesn&#8217;t tell us what the function \(\phi\) itself looks like, i.e., how to get from \(\mathbf{x}\) to \(\phi(\mathbf{x})\), we only get (an approximation of) the final result \(\phi(\mathbf{x})\).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the example above you were already introduced to the polynomial kernel of second degree; the generalization, i.e., the polynomial kernel of degree <em>k</em>, is computed as \(\langle\mathbf{x}', \mathbf{x}_i\rangle^k\).</p>
</div>
<div class="paragraph">
<p>The most popular kernel function that works well in many use cases is the <strong>Radial Basis Function (RBF) / Gaussian kernel</strong>:</p>
</div>
<div class="stemblock">
<div class="content">
\[k(\mathbf{x}', \mathbf{x}_i) = e^{-\gamma \|\mathbf{x}_i - \mathbf{x}' \|^2}\]
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_other/rbf2.png" alt="image" width="540">
</div>
<div class="title"><span class="small">With the RBF kernel function, the similarity of a new point \(\mathbf{x}'\) to the training sample \(\mathbf{x}_i\) is computed by centering a Gaussian function (with a width inversely proportional to \(\gamma\)) over the \(i^{th}\) training sample and then checking where the new point falls on this curve. Depending on the choice of \(\gamma\), either many samples will later contribute to the prediction (if the Gaussian function is very wide and therefore the similarity to multiple training points is large) or only the closest points will be considered (if the curve is very narrow and therefore the similarity to most training examples is close to 0).</span></div>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Support Vector Machine (SVM)</dt>
<dd>
<p>A more efficient method, especially when the training set is large.<br>
<span class="underline">Key idea:</span> Only compute similarity to &#8216;most informative&#8217; training points (= support vectors):</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_other/svm.png" alt="image" width="440">
</div>
</div>
<div class="stemblock">
<div class="content">
\[\sum_{i=1}^n k(\mathbf{x}', \mathbf{x}_i) \alpha_i  \quad \Rightarrow \quad  \sum_{i \in \{\text{SV}\}} k(\mathbf{x}', \mathbf{x}_i) \alpha_i\]
</div>
</div>
<div class="paragraph">
<p>This reduces the memory requirements and makes the prediction for new data points much faster, since it is only necessary to store the support vectors and compute the similarity to them instead of the whole training set.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.decomposition</span> <span class="keyword">import</span> <span class="include">KernelPCA</span>     <span class="comment"># Kernel variant of PCA</span>
<span class="keyword">from</span> <span class="include">sklearn.kernel_ridge</span> <span class="keyword">import</span> <span class="include">KernelRidge</span>    <span class="comment"># Kernel variant of ridge regression (-&gt; use SVR instead)</span>
<span class="keyword">from</span> <span class="include">sklearn.svm</span> <span class="keyword">import</span> <span class="include">SVC</span>, <span class="include">SVR</span>                <span class="comment"># SVM for classification (C) and regression (R)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="underline">Important Parameters:</span></p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8594; <code>kernel</code>: The kernel function used to compute the similarities between the points (&#8594; see <code>sklearn.metrics.pairwise</code>; usually <code>'rbf'</code>).</p>
</li>
<li>
<p>&#8594; Additionally: Kernel parameters, e.g., <code>gamma</code> for <code>'rbf'</code> kernel.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Nonlinear predictions with global optimum.</p>
</li>
<li>
<p>Fast to train (on medium size datasets; compared to, e.g., neural networks).</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Computationally expensive for large datasets (kernel matrix: \(\mathcal{O}(n^2)\)).</p>
</li>
<li>
<p>Kernel functions, just like other similarity functions, benefit from scaled heterogeneous data.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_avoiding_common_pitfalls">Avoiding Common Pitfalls</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
All models are wrong, but some are useful.
</blockquote>
<div class="attribution">
&#8212; George E. P. Box
</div>
</div>
<div class="paragraph">
<p>The above quote is also nicely exemplified by <a href="https://xkcd.com/2048/" target="\_blank">this xkcd comic</a>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://imgs.xkcd.com/comics/curve_fitting.png" alt="image" width="540">
</div>
</div>
<div class="paragraph">
<p>A supervised learning model tries to infer the relationship between some inputs and outputs from the given exemplary data points. What kind of relation will be found is largely determined by the chosen model type and its internal optimization algorithm, however, there is a lot we can (and should) do to make sure what the algorithm comes up with is not blatantly wrong.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">What do we want?</dt>
<dd>
<p>A model that &#8230;&#8203;</p>
<div class="ulist none">
<ul class="none">
<li>
<p>&#8230;&#8203; makes accurate predictions</p>
</li>
<li>
<p>&#8230;&#8203; for new data points</p>
</li>
<li>
<p>&#8230;&#8203; for the right reasons</p>
</li>
<li>
<p>&#8230;&#8203; even when the world keeps on changing.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">What can go wrong?</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Evaluating the model with an inappropriate evaluation metric (e.g., accuracy instead of balanced accuracy for a classification problem with an unequal class distribution), thereby not noticing the subpar performance of a model (e.g., compared to a simple baseline).</p>
</li>
<li>
<p>Using a model that can not capture the &#8216;input &#8594; output&#8217; relationship (due to underfitting) and does not generate useful predictions.</p>
</li>
<li>
<p>Using a model that overfit on the training data and therefore does not generalize to new data points.</p>
</li>
<li>
<p>Using a model that abuses spurious correlations.</p>
</li>
<li>
<p>Using a model that discriminates.</p>
</li>
<li>
<p>Not monitoring and retraining the model regularly on new data.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Below you find a quick summary of what you can do to avoid these pitfalls and we&#8217;ll discuss most these points in more detail in the following sections.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Before training a model</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Select the right inputs: ask a subject matter expert which variables could have a causal influence on the output; possibly compute additional, more informative features from the original measurements (&#8594; <a href="#_feature_engineering_transformations">feature engineering</a>).</p>
</li>
<li>
<p>Sanity check: Does the dataset contain samples with the same inputs but different outputs? &#8658; Some important features might be missing or the targets are very noisy, e.g., due to inconsistent annotations&#8201;&#8212;&#8201;<a href="#_garbage_in_garbage_out">fix this first!</a></p>
</li>
<li>
<p>Try a simple model (linear model or decision tree)&#8201;&#8212;&#8201;this can serve as a reasonable baseline when experimenting with more complex models.</p>
</li>
<li>
<p>Think about the structure of the problem and what type of model might be appropriate to learn the presumed &#8216;input &#8594; output&#8217; relationship. For example, if the problem is clearly nonlinear, the chosen model type also needs to be complex enough to at least in principle be able to pick up on this relation (i.e., such that the model does not underfit, see below). A lot of domain knowledge can also be put into the design of neural network architectures.</p>
</li>
<li>
<p>Make sure the data satisfies the model&#8217;s assumptions &#8658; for pretty much all models except decision trees and models based on decision trees, like random forests, the data should be approximately normally distributed.</p>
</li>
<li>
<p>Make sure you&#8217;ve set aside a representative test set to evaluate the final model and possibly a validation set for model selection and hyperparameter tuning.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">After the model was trained</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Evaluate the model with a meaningful <a href="#_model_evaluation">evaluation metric</a>, especially when the classes in the dataset are not distributed evenly (&#8594; balanced accuracy).</p>
</li>
<li>
<p>Check that the model can interpolate, i.e., that it generalizes to unseen data points <em>from the same distribution as the training set</em> and does not <a href="#_model_does_not_generalize">over- or underfit</a>. Please note that this does <em>not</em> ensure that it can also extrapolate, i.e., that it has learned the true <a href="#_model_abuses_spurious_correlations">causal relation</a> between inputs and outputs and can generate correct predictions for data points outside of the training domain!</p>
</li>
<li>
<p>Carefully analyze the model&#8217;s prediction errors to check for systematic errors, which can indicate that the data violates your initial assumptions. For example, in a classification task the performance for all classes should be approximately the same, while in a regression task the <a href="https://statisticsbyjim.com/regression/check-residual-plots-regression-analysis/" target="\_blank">residuals</a> should be <a href="https://www4.stat.ncsu.edu/~stefanski/NSF_Supported/Hidden_Images/Residual_Surrealism_TAS_2007.pdf" target="\_blank">independent</a>.</p>
</li>
<li>
<p>Verify that the model does not <a href="#_model_discriminates">discriminate</a>. Due to the large quantities of data used to train ML models, it is not always possible to ensure that the training data does not contain any systematic biases (e.g., ethnicity/gender stereotypes) that a model might pick up on, but it is important to test the model on a controlled test set and individual data slices to catch any discrimination before the model is deployed in production.</p>
</li>
<li>
<p>Interpret the model and <a href="#_explainability_interpretable_ml">explain its predictions</a>: Does it use the features you or a subject matter expert expected it to use or does it make predictions based on any spurious correlations?</p>
</li>
<li>
<p>If necessary, use model editing or assertions to fix incorrect model predictions. For example, you can manually alter the rules learned by a decision tree or implement additional business rules that override model predictions or act as sanity checks (e.g., a predicted age should never be negative).</p>
</li>
<li>
<p>Monitor the model&#8217;s performance as it is running in production and watch out for <a href="#_data_concept_drifts">data &amp; concept drifts</a>.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Please note that these steps represent an iterative workflow, i.e., after training some model and analyzing its performance one often goes back to the beginning and, e.g., selects different features or tries a more complex model to improve the performance.</em></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_model_does_not_generalize">Model does not generalize</h3>
<div class="paragraph">
<p>We want a model that captures the &#8216;input &#8594; output&#8217; relationship in the data and is capable of interpolating, i.e., we need to check:<br>
<strong>Does the model generate reliable predictions for new data points from the same distribution as the training set?</strong></p>
</div>
<div class="paragraph">
<p>While this does not ensure that the model has actually learned any true causal relationship between inputs and outputs and can extrapolate beyond the training domain (we&#8217;ll discuss this in the next section), at least we can be reasonably sure that the model will generate reliable predictions for data points similar to those used for training the model. If this isn&#8217;t given, the model is not only wrong, it&#8217;s also useless.</p>
</div>
<h4 id="_over_underfitting" class="discrete">Over- &amp; Underfitting</h4>
<div class="paragraph">
<p>So, why does a model make mistakes on new data points? A poor performance on the test set can have two reasons: overfitting or underfitting.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/overunderfitting.png" alt="image" width="840">
</div>
<div class="title"><span class="small">If we only looked at the test errors for the different models shown here, we could conclude that the model on the left (overfitting) and the one on the right (underfitting) are equally wrong. While this is true in some sense, the test error alone does not tell us <em>why</em> the models are wrong or how we could improve their performance. As we can see, the two models make mistakes on the test set for completely different reasons: The model that overfits, memorized the training samples and is not able to generalize to new data points, while the model that underfits is too simple to capture the relationship between the inputs and outputs in general.</span></div>
</div>
<div class="paragraph">
<p>These two scenarios require vastly different approaches to improve the model&#8217;s performance.</p>
</div>
<div class="paragraph">
<p>Since most datasets have lots of input variables, we can&#8217;t just plot the model like we did above to see if it is over- or underfitting. Instead we need to compute the model&#8217;s prediction error with a meaningful evaluation metric for both the training and the test set and compare the two to see if we&#8217;re dealing with over- or underfitting:</p>
</div>
<div class="paragraph">
<p><strong>Overfitting:</strong> great training performance, bad on test set<br>
<strong>Underfitting:</strong> poor training AND test performance</p>
</div>
<div class="paragraph">
<p>Depending on whether a model over- or underfits, different measures can be taken to improve its performance:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/overunderfitting_errors4.png" alt="image" width="640">
</div>
</div>
<div class="paragraph">
<p>However, it is unrealistic to expect a model to have a perfect performance, as some tasks are just hard, for example, because the data is very noisy.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Always look at the data! Is there a pattern among wrong predictions, e.g., is there a discrepancy between the performance for different classes or do the wrongly predicted points have something else in common? Could some additional preprocessing steps help to fix errors for some type of data points (e.g., blurry images)?
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Over- or underfitting  is (partly) due to the model&#8217;s complexity:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/modelcomplex3.png" alt="image" width="640">
</div>
<div class="title"><span class="small">While a simple model (e.g., a linear model) has a high bias and might therefore underfit the data, a more complex model (e.g., a deep neural network) has high variance and is therefore at risk of overfitting the training set. Often, it makes sense to use a more complex model, but then reduce its variance through explicit (e.g., L2-regularization) and/or implicit regularization (e.g., data augmentation). Also, please note the <a href="https://openai.com/blog/deep-double-descent/" target="\_blank">double descent phenomenon</a> for neural networks, which often show a good generalization performance even if they are vastly over-parametrized.</span></div>
</div>
<div class="paragraph">
<p>In general, one should first try to decrease the model&#8217;s bias, i.e., find a model that is complex enough and at least in principle capable of solving the task, since the error on the training data is the lower limit for the error on the test set. Then make sure the model doesn&#8217;t overfit, i.e., generalizes to new data points (what we ultimately care about).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Will more data help?</dt>
<dd>
<p>With little data, we risk overfitting. But is it worth getting more data?<br>
&#8594; check <em>learning curves</em>, i.e., how the performance improves when using more training samples:</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/06_evaluation/learning_curve.png" alt="image" width="840">
</div>
</div>
<div class="paragraph">
<p>Instead of <em>more</em>, it might also be helpful to get <em>cleaner</em> data, i.e., with less ambiguous labels! (See <a href="https://youtu.be/06-AZXmwHjo" target="\_blank">talk by Andrew Ng</a>.)</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For some tasks it is also possible to generate additional training samples programmatically through <strong>data augmentation</strong>, i.e., by modifying the original data points. For example, an image of an animal can be rotated or flipped without affecting its label. In this way we can easily increase the size of the training set without the need for human labeling. Furthermore, this makes our model more robust to realistic variations in the data. However, we need to be careful to not create garbage samples, i.e., a human must still be able of recognizing the objects in the images, for example.
</td>
</tr>
</table>
</div>
</div>
</div>
<h5 id="_feature_selection" class="discrete">Feature Selection</h5>
<div class="paragraph">
<p>In small datasets, some patterns can occur simply by chance (= <a href="https://www.tylervigen.com/spurious-correlations" target="\_blank">spurious correlations</a>).<br>
&#8658; Exclude irrelevant features to avoid overfitting on the training data. This is especially important if the number of samples in the dataset is close to the number of features.</p>
</div>
<div class="paragraph">
<p>Feature selection techniques are either</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>unsupervised</strong>, which means they only look at the features themselves, e.g., removing highly correlated/redundant features, or</p>
</li>
<li>
<p><strong>supervised</strong>, which means they take into account the relationship between the features and target variable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="underline">Supervised Feature Selection Strategies:</span></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">1.) Univariate feature selection</dt>
<dd>
<p>e.g., correlation between feature &amp; target</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.feature_selection</span> <span class="keyword">import</span> <span class="include">SelectKBest</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Careful:</strong> This can lead to the inclusion of redundant features or the exclusion of features that might seem useless by themselves, but can be very informative when taken together with other features:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_explainability/features_informative4.png" alt="image" width="720">
</div>
<div class="title"><span class="small">Guyon, Isabelle, and André Elisseeff. &#8220;An introduction to variable and feature selection.&#8221; <em>Journal of Machine Learning Research</em> 3.Mar (2003): 1157-1182.</span></div>
</div>
<div class="paragraph">
<p>Also, please note: if we were to reduce the dimensionality with PCA on these two datasets, for the plot on the right, the main direction of variance does not capture the class differences, i.e., while the second PC captures less variance overall, it capture the class-discriminative information that we care about.</p>
</div>
<div class="paragraph">
<p>&#8658; Better:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">2.) Model-based feature selection</dt>
<dd>
<p>select features based on <code>coef_</code> or <code>feature_importances_</code> attribute of trained model</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.feature_selection</span> <span class="keyword">import</span> <span class="include">SelectFromModel</span></code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">3.) Sequential feature selection</dt>
<dd>
<p>greedy algorithm that iteratively includes/removes one feature at a time:</p>
<div class="ulist">
<ul>
<li>
<p><span class="underline">forward selection:</span> start with no features, iteratively add best feature until the performance stops improving</p>
</li>
<li>
<p><span class="underline">backward elimination:</span> start with all features, iteratively eliminate worst feature until the performance starts to deteriorate</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.feature_selection</span> <span class="keyword">import</span> <span class="include">SequentialFeatureSelector</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="underline">General rule</span>: Always remove truly redundant (i.e., 100% correlated) features, but otherwise if in doubt: keep all features.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
While feature selection can improve the performance, these automatic feature selection techniques will only select a subset of features that are good predictors of the target, i.e., highly correlated, not necessary variables that correspond to the true underlying causes, as we will discuss in the next section.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_model_abuses_spurious_correlations">Model abuses spurious correlations</h3>
<div class="paragraph">
<p>By following the strategies outlined in the previous section, we can find a model that is good at interpolating, i.e., generating reliable predictions for new data points from the same distribution as the training set. However, this does not mean that the model actually picked up on the true causal relationship between the inputs and outputs!</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
ML models love to cheat &amp; take shortcuts! They will often pick up on <a href="https://www.tylervigen.com/spurious-correlations" target="\_blank">spurious correlations</a> instead of learning the true causal relationships. This makes them vulnerable to adversarial attacks and data/domain shifts, which force the model to extrapolate instead of interpolate.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Specifically, models that neither over- nor underfit, i.e., that perfectly capture the relation between inputs and outputs in the given samples, often still fail to extrapolate:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_causality/extrapolating_nn10.png" alt="image" width="440">
</div>
<div class="title"><span class="small">These ten curves were generated by initializing the weights of a FFNN with one hidden layer of 20 units with a ReLU activation with ten different random seeds and then training the network on the data samples. While all these models generalize well on the known data distribution, they can&#8217;t produce correct predictions for data points outside of the training domain.</span></div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Extrapolation on feature combinations</strong></p>
</div>
<div class="paragraph">
<p>Please note that only because we might have sampled a large range of values for each individual feature, this does not necessary entail that we&#8217;ve also covered all relevant combinations of feature values:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_causality/extrapolate_sampling.png" alt="image" width="240">
</div>
</div>
<div class="paragraph">
<p>If the two features and their effect on the target are independent of each other (e.g., \(y = ax_1 + bx_2\)), this is not too dramatic, however, if these variables interact in some complicated nonlinear way, this might not be modeled correctly when relevant combinations of feature values weren&#8217;t sampled.</p>
</div>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
When deploying an ML system in production, you also need to replicate the preprocessing steps that were used to clean the training data. For example, if you removed outliers from the initial training set, you need to apply the same rules to sort out anomalies in the production data as well, since otherwise the ML model would be forced to extrapolate on these samples.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When setting up a model, we always have to be clear about whether it is enough that the model is capable of interpolating or whether it might also need to extrapolate every once in a while.</p>
</div>
<div class="paragraph">
<p>If the model will only be used to generate predictions for new data points from the same distribution as the original training samples and it is unlikely that any data drifts will occur, then a model that has a decent performance on a representative hold-out test set will be sufficient for the task. This might be the case when building a softsensor that just needs to construct a new signal from other fixed inputs in a tightly controlled loop.</p>
</div>
<div class="paragraph">
<p>However, this assumption seldomly holds in practice and especially in safety-critical situations, such as image recognition in self-driving cars or at security checkpoints, it is vital that the model is robust and can not easily be fooled.
Other use cases where it is important that the model picks up on meaningful causal relationships include using a model to identify root causes or generating counterfactual &#8220;what-if&#8221; forecasts, which also require extrapolation, e.g., when trying to simulate under which conditions a catastrophic event might occur without having observed one in the historical data.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>A correct prediction is not always made for the right reasons!</strong></p>
</div>
<div class="paragraph">
<p>The graphic below is taken from a paper where the authors noticed that a fairly simple ML model (not a neural network) trained on a standard image classification dataset performed poorly for all ten classes in the dataset except one, horses. When they examined the dataset more closely and analyzed <em>why</em> the model predicted a certain class, i.e., which image features were used in the prediction (displayed as the heatmap on the right), they noticed that most of the pictures of horses in the dataset were taken by the same photographer and they all had a characteristic copyright notice in the lower left corner.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_explainability/analyzing_classifiers.png" alt="image" width="840">
</div>
<div class="title"><span class="small">Lapuschkin, Sebastian, et al. &#8220;Analyzing classifiers: Fisher vectors and deep neural networks.&#8221; <em>IEEE Conference on Computer Vision and Pattern Recognition.</em> 2016.</span></div>
</div>
<div class="paragraph">
<p>By relying on this artifact, the model could identify what it perceives as &#8220;horses&#8221; in this dataset with high accuracy&#8201;&#8212;&#8201;both in the training and the test set, which includes pictures from the same photographer. However, of course the model failed to learn what actually defines a horse and would not be able to extrapolate and achieve the same accuracy on other horse pictures without this copyright notice.
Or, equally problematic, one could add such a copyright notice to a picture of another animal and suddenly the model would mistakenly classify this as a horse, too. This means, it is possible to purposefully trick the model, which is also called an &#8220;adversarial attack&#8221;.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This is by far not the only example where a model has &#8220;cheated&#8221; by exploiting spurious correlations in the training set. Another popular example: A dataset with images of dogs and wolves, where all wolves were photographed on snowy backgrounds and the dogs on grass or other non-white backgrounds. Models trained on such a dataset can show a good predictive performance without having learned the true causal relationship between the features and labels.</p>
</div>
<div class="paragraph">
<p>To catch these kinds of mishaps, it is important to</p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>a) critically examine the test set and hopefully notice any problematic patterns that could result in an overly optimistic performance estimate, and</p>
</li>
<li>
<p>b) <a href="https://franziskahorn.de/mlbook/_explainability_interpretable_ml.html" target="\_blank"><strong>interpret the model and explain its predictions</strong></a> to see if it has focused on the features you (or a subject matter expert) would have expected (as they did in the paper above).</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Adversarial Attacks: Fooling ML models on purpose</strong></p>
</div>
<div class="paragraph">
<p>An adversarial attack on an ML model is performed by asking the model to make a prediction for an input that was modified in such a way that a human is unaware of the change and would still arrive at a correct result, but the ML model changes its prediction to something else.</p>
</div>
<div class="paragraph">
<p>For example, while an ML model can easily recognize the &#8216;Stop&#8217; sign from the image on the left, the sign on the right is mistaken as a speed limit sign due to the strategically placed, inconspicuous stickers, which humans would just ignore:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_explainability/adversarial_attack2.png" alt="image" width="640">
</div>
</div>
<div class="paragraph">
<p>This happened because the model didn&#8217;t pick up on the true reasons humans identify a Stop sign as such, e.g., the octagonal form and the four white letters spelling &#8216;STOP&#8217; on a red background. Instead it relied on less meaningful correlations to distinguish it from other traffic signs.<br>
Convolutional neural networks (CNN), the type of neural net typically used for image classification tasks, rely a lot on local patterns. This is why they are often easily <a href="https://www.sciencemag.org/news/2018/07/turtle-or-rifle-hackers-easily-fool-ais-seeing-wrong-thing" target="\_blank">fooled</a> by leaving the global shape of objects, which humans rely on for identification, intact and overlaying the images with specific textures or other high-frequency patterns to trick the model into predicting a different class.</p>
</div>
<div class="paragraph">
<p><strong>GenAI &amp; Adversarial Prompts</strong></p>
</div>
<div class="paragraph">
<p>Due to their complexity, it is particularly difficult to control the output of generative AI (GenAI) models such as ChatGPT. While they can be a useful tool in human-in-the-loop scenarios (e.g., to draft an email or write code snippets that are then checked by a human before they see the light of day), it is difficult to put the necessary guardrails in place to ensure the chatbot can&#8217;t be abused in the wild.</p>
</div>
<div class="paragraph">
<p>A Chevrolet car dealer that tried to use ChatGPT in their customer support chat is just one of many examples where early GenAI applications yielded mixed results at best:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_explainability/adversarial_chatgpt.png" alt="medical images" width="640">
</div>
<div class="title"><span class="small">Screenshot: https://twitter.com/ChrisJBakke/status/1736533308849443121 (12.1.2024)</span></div>
</div>
</div>
</div>
<h4 id="_learning_causal_models" class="discrete">Learning causal models</h4>
<div class="paragraph">
<p>Finding robust causal models that capture the true &#8216;input &#8594; output&#8217; relationship in the data is still <a href="https://bdtechtalks.com/2021/03/15/machine-learning-causality/" target="\_blank">an active research area</a> and a lot harder than learning a model that &#8220;only&#8221; generalizes well to the test set.</p>
</div>
<div class="paragraph">
<p>Specifically, this requires knowledge of two things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Which input features should be included in the model</strong>, i.e., which variables have a causal impact on the target. In practice, this can be complicated by the fact that we might not be able to measure all of these variables directly and have to rely on proxy values.</p>
</li>
<li>
<p><strong>What kind of model best captures the true causal relationship</strong>, e.g., if the relationship between inputs and target is nonlinear, then a linear model wont be enough. One possibility here is to introduce domain knowledge into the design of a neural network architecture.</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_causality/extrapolating_nn10_sin.png" alt="image" width="440">
</div>
<div class="title"><span class="small">Like in the initial example, these ten curves were generated by initializing the weights of a FFNN with one hidden layer of 20 units with a ReLU activation with ten different random seeds and then training the network on the data samples, only this time after the last layer a \(sin()\) activation was applied to the output. By including domain knowledge, we get much closer to the true causal relationship and can extrapolate beyond the training domain (to some extent).</span></div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><span class="small">The following example is adapted from: &#8220;Elements of Causal Inference&#8221; by Jonas Peters, Dominik Janzig, and Bernhard Schölkopf (2017).<br>
See also Jonas Peters' great <a href="https://www.youtube.com/watch?v=zvrcyqcN9Wo" target="\_blank">lecture series on causality</a>. You can also play around with this example yourself in the <a href="https://github.com/cod3licious/ml_exercises/blob/main/notebooks/causal_model.ipynb" target="\_blank">causal model notebook</a>.</span></p>
</div>
<div class="paragraph">
<p><strong>Example: Learning a causal model</strong></p>
</div>
<div class="paragraph">
<p>Assume this is the true <em>causal graph</em> of some process, where the nodes represent different variables and the edges specify their (linear) influence on one another:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_causality/causality_network.png" alt="image" width="340">
</div>
</div>
<div class="paragraph">
<p>Please note that individual nodes in a causal graph can also represent hidden variables, i.e., process conditions that can not be directly observed, e.g., for which one might want to build a softsensor.</p>
</div>
<div class="paragraph">
<p>Based on the above stated relationships, we can generate a dataset, where each variable additionally depends on an independent (w.r.t. the other variables) normally distributed noise component. This means for each sample some process conditions are set independently (<code>C</code> and <code>A</code>) while for others the value partially depends on the values already set for the other variables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">n = <span class="integer">20000</span>
C =              <span class="float">1.0</span> * np.random.randn(n)
A =              <span class="float">0.8</span> * np.random.randn(n)
K = A          + <span class="float">0.1</span> * np.random.randn(n)
X = C - <span class="integer">2</span> * A  + <span class="float">0.2</span> * np.random.randn(n)
F = <span class="integer">3</span> * X      + <span class="float">0.8</span> * np.random.randn(n)
D = -<span class="integer">2</span> * X     + <span class="float">0.5</span> * np.random.randn(n)
G = D          + <span class="float">0.5</span> * np.random.randn(n)
Y = <span class="integer">2</span> * K - D  + <span class="float">0.2</span> * np.random.randn(n)
H = <span class="float">0.5</span> * Y    + <span class="float">0.1</span> * np.random.randn(n)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the dependencies between the variables are linear, the optimal model type to learn any &#8216;input &#8594; output&#8217; relation on this dataset is a linear regression model. The true coefficients that this model should find for one input variable are the values on the edges on the way from this variable&#8217;s node to the target node multiplied with each other, e.g., for <code>X</code> (input) on <code>Y</code> (target) this would be <code>-2</code> (from <code>X</code> to <code>D</code>) times <code>-1</code> (from <code>D</code> to <code>Y</code>), i.e., <code>2</code>.</p>
</div>
<div class="paragraph">
<p>Depending on which variables we include as input features, the models is or isn&#8217;t able to learn the correct coefficients:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="comment"># (1) missing relevant input feature K -&gt; wrong coefficient for X</span>
R^<span class="integer">2</span> (train): <span class="float">0.844</span>; (test): <span class="float">0.848</span> =&gt; Y ~  <span class="float">0.001</span> + <span class="float">1.285</span> * X
<span class="comment"># (2) all the right input features -&gt; correct coefficients</span>
R^<span class="integer">2</span> (train): <span class="float">0.958</span>; (test): <span class="float">0.959</span> =&gt; Y ~  <span class="float">0.003</span> + <span class="float">2.003</span> * X + <span class="float">2.010</span> * K
<span class="comment"># (3) additional input feature D, which has a more direct influence on Y than X</span>
R^<span class="integer">2</span> (train): <span class="float">0.994</span>; (test): <span class="float">0.994</span> =&gt; Y ~ -<span class="float">0.002</span> - <span class="float">0.015</span> * X + <span class="float">1.998</span> * K - <span class="float">1.007</span> * D
<span class="comment"># (4) additional input feature H, which is dependent on (i.e., highly correlated with) Y</span>
R^<span class="integer">2</span> (train): <span class="float">0.995</span>; (test): <span class="float">0.995</span> =&gt; Y ~  <span class="float">0.001</span> + <span class="float">0.242</span> * X + <span class="float">0.245</span> * K + <span class="float">1.759</span> * H
<span class="comment"># (5) additional input feature G that is not directly causal of Y, but dependent on D</span>
R^<span class="integer">2</span> (train): <span class="float">0.977</span>; (test): <span class="float">0.976</span> =&gt; Y ~  <span class="float">0.004</span> + <span class="float">0.978</span> * X + <span class="float">2.002</span> * K - <span class="float">0.510</span> * G</code></pre>
</div>
</div>
<div class="paragraph">
<p>Often the best predictive model is not the true causal model (e.g., (4)) and especially regularized models, which try to explain the target with as few variables as possible, often choose variables dependent on the target (such as <code>H</code>) as the single best predictor instead of relying on multiple true causal influences (e.g., notice how <code>K</code> and <code>X</code> already have much lower coefficients in (4)).<br>
But only the causal models are robust to data drifts and can extrapolate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="comment"># Changed equations to generate test data (notice larger noise component)</span>
X = C - <span class="integer">2</span> * A  + <span class="float">2.0</span> * np.random.randn(n)
H = <span class="float">0.5</span> * Y    + <span class="float">1.0</span> * np.random.randn(n)

<span class="comment"># model (2): true relationship between X and Y -&gt; test performance equally good</span>
R^<span class="integer">2</span> (train): <span class="float">0.958</span>; (test): <span class="float">0.987</span> =&gt; Y ~ <span class="float">0.003</span> + <span class="float">2.003</span> * X + <span class="float">2.010</span> * K
<span class="comment"># model (4): variable dependent on but not causal of Y -&gt; test performance a lot worse</span>
R^<span class="integer">2</span> (train): <span class="float">0.995</span>; (test): <span class="float">0.866</span> =&gt; Y ~ <span class="float">0.001</span> + <span class="float">0.242</span> * X + <span class="float">0.245</span> * K + <span class="float">1.759</span> * H</code></pre>
</div>
</div>
<div class="paragraph">
<p>But unfortunately none of the models can handle a <em>concept</em> drift, i.e., when the underlying process, from which the data is sampled, changes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="comment"># Changed equation to generate test data (notice the reversed sign for X on the way to Y)</span>
D =  <span class="integer">2</span> * X     + <span class="float">0.5</span> * np.random.randn(n)

<span class="comment"># model (2): causal relationship between X and Y changed -&gt; test performance catastrophic</span>
R^<span class="integer">2</span> (train): <span class="float">0.958</span>; (test): -<span class="float">1.797</span> =&gt; Y ~ <span class="float">0.003</span> + <span class="float">2.003</span> * X + <span class="float">2.010</span> * K</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case only retraining the model on new data helps to recover the performance.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>&#8658; If the goal is to find a <strong>good predictive model</strong>, use as input variables the <a href="https://en.wikipedia.org/wiki/Markov_blanket" target="\_blank">Markov blanket</a> of the target variable, i.e., its parent nodes, child nodes, and the other parent nodes of these child nodes (in the above example, to predict <code>Y</code> this would be <code>D</code> and <code>K</code> (parent nodes) and <code>H</code> (child node that has no other parents)).<br>
&#8658; If the goal is to find a <strong>causal model</strong> that can extrapolate, use as input variables only the parent nodes of the target variable.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Residual Plots</strong></p>
</div>
<div class="paragraph">
<p>Residual plots can give us a hint as to whether or not we might be missing important input variables in the model.<br></p>
</div>
<div class="paragraph">
<p>In regression problems we assume that the input variables explain all important external influences on the target and what remains is just random noise. I.e., as we predict the target as:</p>
</div>
<div class="stemblock">
<div class="content">
\[\hat{y} = b + w_1x_1 + w_2x_2 + ... + w_dx_d\]
</div>
</div>
<div class="paragraph">
<p>we assume that the true process that generated \(y\) looked like this:</p>
</div>
<div class="stemblock">
<div class="content">
\[y = b + w_1x_1 + w_2x_2 + ... + w_dx_d + \epsilon\]
</div>
</div>
<div class="paragraph">
<p>where \(\epsilon \in \mathcal{N}(0, \sigma)\) is the unexplained random noise with mean 0 and standard deviation \(\sigma\), which is assumed to be independent of all other factors.</p>
</div>
<div class="paragraph">
<p>By plotting the residuals (i.e., prediction errors) \(y_i - \hat{y}_i\) against the predicted targets \(\hat{y}_i\) and other variables and observing whether or not these residuals show distinctive patterns or really look like random noise, we can check whether the model is missing important additional input variables.</p>
</div>
<div class="paragraph">
<p>For example, from the example above for model (1), i.e., when using only <code>X</code> as an input to predict <code>Y</code>, the residuals plots looks like this:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_causality/residuals_dependent.png" alt="image" width="840">
</div>
</div>
<div class="paragraph">
<p>The residuals here are correlated with several other variables, which means we should probably include one of them as an additional input feature.</p>
</div>
<div class="paragraph">
<p>The residuals plots for model (2), i.e., when using both <code>X</code> and <code>K</code> as features, on the other hand, show randomly distributed residuals, which means, we&#8217;re at least not missing some obvious influencing factors:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_causality/residuals_independent.png" alt="image" width="840">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When working with time series data, you should also check for autocorrelation between the residuals, i.e., it should not be possible to use the residual at time point <em>t</em> to predict the next residual at <em>t+1</em>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_model_discriminates">Model discriminates</h3>
<div class="paragraph">
<p>As we ponder the true causal relations between variables in the data, we also need to consider whether there are some causal relationships encoded in the historical data that we <em>don&#8217;t</em> want a model to pick up on. For example, discrimination based on gender or ethnicity can leak into the training data and we need to take extra measures to make sure that these patterns, although they might have been true causal relationships in the past, are not present in our model now.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Biased data leads to (strongly) biased models</dt>
<dd>
<p>Below are some examples where people with the best of intentions have set up an ML model that has learned problematic things from real world data.</p>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="images/07_data_issues/bias_microsoft_tay.png" alt="image" width="550">
</div>
<div class="title"><span class="small">What started as a research project to see how humans would interact with an AI-based chatbot, ended as a PR-nightmare for Microsoft. The chatbot was supposed to learn from the messages written to it, but since the developers apparently thought more about their natural language models instead of human behavior on the internet, Tay mainly repeated all the racist, sexists things others tweeted.</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="images/07_data_issues/bias_gender_stereotypes_we.png" alt="image" width="620">
</div>
<div class="title"><span class="small">In the chapter on deep learning we&#8217;ll discuss how neural network language models learn word embeddings through self-supervised learning. As it turns out, a lot of the texts these models are trained on include, e.g., gender stereotypes, which are then also encoded in the word embeddings. So while the analogy question "<em>man</em> is to <em>king</em> as <em>women</em> is to <em>XXX</em>" might be answered correctly with "<em>queen</em>",  "<em>man</em> is to <em>doctor</em> as <em>women</em> is to <em>XXX</em>" is more likely to be answered with "<em>nurse</em>" instead of "<em>doctor</em>", since this role allocation was typical in the past and is therefore also present in many texts used as training data for these models.</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="images/07_data_issues/bias_twitter_imagecrop.png" alt="image" width="550">
</div>
<div class="title"><span class="small">Since many of the images posted on Twitter are larger than the available space for the preview image, Twitter decided to train a model to select &#8220;the most relevant part&#8221; of an image to be displayed as a preview. Unfortunately, as they had trained this model on a dataset with more pictures of white people than people of color, the model became racist and, for example, given a picture of Barack Obama and some random unimportant white politician, it always selected the white politician for the preview image. Similarly, such cropping algorithms were also reported to more often select faces as preview images for men and the body (specifically, you&#8217;ve guessed it, boobs) as preview images for women.</span></div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="images/07_data_issues/bias_household_lowerincome.png" alt="image" width="700">
</div>
<div class="title"><span class="small">Most computer vision models are (pre-)trained on the ImageNet dataset, which contains over 14 million hand-annotated pictures, organized in more than 20k categories. However, since these pictures are sourced from the internet and more people from developed instead of developing nations tend to post pictures online, the variety of common household items, for example, is highly skewed towards products found in richer countries. Subsequently, these models mistake, e.g., bars of soap found in a poorer country as food (e.g., one could argue that these do indeed bear some resemblance to a plate of food that might be found in a fancy restaurant).</span></div>
</div>
<div class="paragraph text-center">
<p><span class="small">de Vries, Terrance, et al. &#8220;Does object recognition work for everyone?&#8221; <em>IEEE/CVF Conference on Computer Vision and Pattern Recognition Workshops.</em> 2019.</span></p>
</div>
</div>
</div>
<div class="paragraph">
<p>The above problems all arose because the data was not sampled uniformly:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tay has seen many more racist and hateful comments and tweets than &#8216;normal&#8217; ones.</p>
</li>
<li>
<p>In historical texts, women were underrepresented in professions such as doctors, engineers, carpenters, etc.</p>
</li>
<li>
<p>The image dataset Twitter trained its model on included more pictures of white people compared to people of color.</p>
</li>
<li>
<p>Similarly, given a random collection of photos from the internet, these images will have mostly been uploaded by people from developed countries, i.e., pictures displaying the status quo in developing nations are underrepresented.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Even more problematic than a mere underrepresentation of certain subgroups (i.e., a skewed input distribution) is a pattern of systematic discrimination against them in historical data (i.e., a discriminatory shift in the assigned labels).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="images/07_data_issues/bias_apple_card.png" alt="image" width="550">
</div>
<div class="title"><span class="small">A lot of explicit discrimination is often encoded in datasets used to train models for assigning credit scores or determine interest rates for mortgages or loans. Since these application areas have a direct and severe influence on humans' lives, here we have to be especially careful and, for example, check that the model predicts the same score for a man and a woman if all the features of a data point are equal except those encoding a person&#8217;s gender.</span></div>
</div>
</div>
</div>
<div class="paragraph">
<p><span class="underline">To summarize:</span> A biased model can negatively affect users in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Disproportionate product failures, due to skewed sampling. For example, speech recognition models are often less accurate for women, because they were trained on more data collected from men (e.g., transcribed political speeches).</p>
</li>
<li>
<p>Harm by disadvantage / opportunity denial, due to stereotypes encoded in historical data. For example, women are assigned higher credit interest rates than men or people born in foreign countries are deemed less qualified for a job when their resumes are assessed by an automated screening tool.</p>
</li>
</ul>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Retraining models on data shaped by predictions from a biased predecessor model can intensify existing biases. For instance, if a resume screening tool recognizes a common trait (e.g., &#8220;attended Stanford University&#8221;) among current employees, it may consistently recommend resumes with this trait. Consequently, more individuals with this characteristic will be invited for interviews and hired, further reinforcing the dominance of the trait in subsequent models trained on these employee profiles.
</td>
</tr>
</table>
</div>
<h5 id="_towards_fair_models" class="discrete">Towards fair models</h5>
<div class="paragraph">
<p><span class="underline">1.) Know you have a problem</span></p>
</div>
<div class="paragraph">
<p>The first step to mitigating these problems is to become aware of them. We often don&#8217;t notice a poor performance for an undersampled subgroup, because the model performance overall looks fine:</p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="images/07_data_issues/bias_unequal_lr.png" alt="image" width="420"></span>
<span class="image"><img src="images/07_data_issues/bias_equal_lr.png" alt="image" width="420"></span><br></p>
</div>
<div class="paragraph text-justify">
<p><span class="small">These two plots show a simple linear regression model trained on data with three subgroups (e.g., subgroups could be based on gender and/or ethnicity). In both cases, the model performs well for the subgroup in the middle, but poorly for the marginalized subgroups. However, if we only consider at the overall \(R^2\) value of the model, the performance of the model on the left seems fine, since here the good performance on the &#8216;main&#8217; subgroup drowns out the poor performance on the undersampled marginalized subgroups. The poor performance of the model is only apparent when the subgroups are sampled equally.</span></p>
</div>
<div class="paragraph">
<p>Therefore:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Assess the model&#8217;s performance for each (known) subgroup individually by slicing the data accordingly to verify that the prediction errors of the model are random and the model is not systematically worse for some subgroups / data slices.</p>
</li>
<li>
<p>If it is not possible to obtain a well balanced training and/or test set, assign higher sample weights to data points from undersampled subgroups to make sure the algorithm pays enough attention to them during training and they are given more weight when evaluating the model (similar to using the balanced accuracy).</p>
</li>
<li>
<p>Check if/how the model&#8217;s prediction changes when everything about a data point is the same except attributes encoding gender / age / ethnicity / etc.</p>
</li>
<li>
<p>Interpret the model to see whether features encoding subgroup-specific information have an unexpectedly high influence on the prediction.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="underline">2.) Learn a fair model</span></p>
</div>
<div class="paragraph">
<p>We should also <strong>be careful when including variables in the model that encode attributes such as gender or ethnicity</strong>. For example, the performance of a model that diagnoses heart attacks will most likely be improved by including &#8216;gender&#8217; as a feature, since men and women present different symptoms when they have a heart attack. On the other hand, a model that assigns someone a credit score should probably not rely on the gender of the person for this decision, since, even though this might have been the case in the historical data because the humans that generated the data relied on their own stereotypes, women should not get a lower score just because they are female.</p>
</div>
<div class="paragraph text-center">
<p><span class="image"><img src="images/07_data_issues/bias_simpson_lr.png" alt="image" width="420"></span>
<span class="image"><img src="images/07_data_issues/bias_simpson_lrd.png" alt="image" width="405"></span><br></p>
</div>
<div class="paragraph text-justify">
<p><span class="small">In the plot on the right, additional dummy variables to represent the different subgroups in the data are included in the model and improve its predictive performance. While this can make the bias of a model explicit, should this information be included at all? (By the way, this is also an example of <a href="https://en.wikipedia.org/wiki/Simpson&#8217;s_paradox" target="\_blank">Simpson&#8217;s paradox</a>, where the model&#8217;s coefficients reverse their sign when additional features are included.)</span></p>
</div>
<div class="paragraph">
<p>However, a person&#8217;s gender or ethnicity, for example, is often correlated with other variables such as income or neighborhood, so even inconspicuous features can still leak problematic information to the model and require some extra steps to ensure the model does not discriminate.</p>
</div>
<div class="paragraph">
<p>This can, for example, be achieved by setting up a neural network that learns <strong>subgroup-invariant feature representations</strong>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_data_issues/invariant_rep.png" alt="image" width="720">
</div>
</div>
<div class="paragraph">
<p>This architecture works similar to a <a href="https://en.wikipedia.org/wiki/Generative_adversarial_network" target="\_blank">Generative Adversarial Network (GAN)</a> in that there are two parts of the network, one that tries to predict the target from the intermediate feature representation and the other (i.e., the adversary) that tries to predict the subgroup label (e.g., gender) from the same representation. The goal here is to find an intermediate feature representation that still includes all the necessary information such that the first network can predict the target, but from which the adversarial network can not predict the subgroup anymore, which can be achieved by training both networks together.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>For other examples of what not to do, check out the <a href="https://incidentdatabase.ai/" target="\_blank">AI Incidence Database</a> and</p>
</div>
<div class="openblock float-group">
<div class="content">
<div class="paragraph">
<p><span class="image left"><img src="images/09_ml_in_practice/book_weapons_2016.jpg" alt="image" width="140"></span></p>
</div>
<div class="paragraph">
<p>Book recommendation:<br>
<strong>Weapons of Math Destruction</strong> by Cathy O’Neil (2016)</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_explainability_interpretable_ml">Explainability &amp; Interpretable ML</h3>
<div class="paragraph">
<p>Explainability is essential to trust a model&#8217;s predictions, especially in performance-critical areas like medicine (e.g., diagnosis from x-ray images).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Explainable/Interpretable ML – distinguish between:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="underline">Local</span> Explainability: explain individual predictions.<br>
&#8594; Which features from one particular sample swayed the model to make a certain prediction? This can, for example, be visualized as a heatmap like that over the image of a horse, where the classification decision was made mostly <a href="#_model_abuses_spurious_correlations">because of the copyright notice</a>.</p>
</li>
<li>
<p><span class="underline">Global</span> Explainability: explain the model behavior in general.<br>
&#8594; Which features are most important over all?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#8594; Some models are <em>intrinsically interpretable</em> (e.g., linear models, decision trees), others require <em>model-agnostic methods</em> to make them explainable, i.e., for these models the interpretability does not come for free.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Explaining a model and its predictions helps to understand what it learned from the data and why it makes certain mistakes. But only when the model has a good predictive performance <em>and</em> there is reason to believe that the model actually captured the true causal relationship between the inputs and targets, then these explanations might shed light on the <a href="https://towardsdatascience.com/e68626e664b6" target="\_blank">true root causes</a> of the underlying process as well. Always discuss the results with a subject matter expert!
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Correlated features can lead to misrepresented feature importances! For example, when using a random forest, one decision tree might use one feature in the root node, while another decision tree uses a second feature that is correlated with the first, which means that overall it seems that both features are only somewhat important, while in fact they are just interchangeable and therefore their true feature importance would be the sum of the two individual feature importances.</p>
</li>
<li>
<p>Beware of <a href="https://en.wikipedia.org/wiki/Simpson%27s_paradox" target="\_blank">Simpson&#8217;s paradox</a>.</p>
</li>
<li>
<p>Possibly look at results for different subsamples of the data.</p>
</li>
<li>
<p>Compare feature importances obtained for different models to get a better feeling for which features truly matter for the problem, e.g., investigate why a linear model and a decision tree might base their decisions on different features.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><span class="underline">Recommended Reading:</span> <a href="https://christophm.github.io/interpretable-ml-book/" target="\_blank">Interpretable ML Book</a>, which additionally covers some more advanced methods. However, please keep in mind that explainable AI is about understanding better what happens&#8201;&#8212;&#8201;if you use a complex method to explain a model (e.g., the popular SHAP values) where it is difficult to understand how the explanations were derived, then this might instead result in further uncertainty.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_explaining_decision_trees_random_forests">Explaining Decision Trees (&amp; Random Forests)</h4>
<div class="paragraph">
<p><strong>Explaining individual predictions</strong>: retrace decision path (in a single tree).</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_explainability/expl_dt.png" alt="image" width="540">
</div>
<div class="title"><span class="small">This is an example of a decision tree plot generated with <code>sklearn</code>. The decision tree has its root at the top (where we start when predicting for a new sample) and the leaves (i.e., those nodes that don&#8217;t branch off anymore) at the bottom (where we stop and make the final prediction). Each node in the tree shows in the first line the variable based on which the next split is made incl. the threshold value (except for leaf nodes), then the current Gini impurity (i.e., how homogeneous the labels of all the samples that ended up in this node are; this is what the decision tree internally optimizes, i.e., notice how the value gets smaller on at least one side after a split), then the fraction of samples that ended up in this node, and the distribution of samples for the different classes (for a classification problem), as well as the label that would be predicted for a sample at this point. So when making a prediction for a new sample with a decision tree, we start at the root node of the tree and then follow the branches down depending on the sample&#8217;s feature values until we reach a leaf node and would then know exactly based on which feature thresholds the prediction for the sample was made.</span></div>
</div>
<div class="paragraph">
<p><strong>Global interpretation</strong>: a trained decision tree or random forest has an attribute <code>feature_importances_</code>, which indicates how much each feature contributed to reducing the (Gini) impurity. This is related to the position of the feature in the tree and how many samples pass through the respective node.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_explainability/expl_dt_featimp.png" alt="image" width="400">
</div>
<div class="title"><span class="small">This is just a bar plot of the values from the <code>feature_importances_</code> attribute of the decision tree shown above. When we&#8217;re using a random forest instead of a single decision tree, it would be impractical to plot all of the individual trees contained in the forest to explain individual predictions, but a random forest at least also has the <code>feature_importances_</code> attribute to examine the global importance of the different features.</span></div>
</div>
</div>
<div class="sect3">
<h4 id="_explaining_linear_models_neural_networks">Explaining Linear Models (&amp; Neural Networks)</h4>
<div class="paragraph">
<p>Since the formula used to make predictions with a linear model is very simple, we can easily understand what is going on. To assess the importance of individual features, either for a single sample or overall, the sum can be decomposed into its individual components:<br>
\(\hat{y} = b + \sum_{k=1}^d w_k \cdot x_k\) &#8658; effect of feature <em>k</em> for ith data point: \(w_k \cdot x_k^{(i)}\):</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_explainability/expl_lm_effects.png" alt="image" width="540">
</div>
<div class="title"><span class="small">The feature effects for a single sample are indicated by the red crosses, i.e., these show whether each feature contributed positively or negatively (or not at all) to the final prediction for this one sample. By computing the feature effects for all samples, we can generate the box plots shown below the red crosses, which display the distribution of feature effects for all samples and therefore indicate which features are overall important for the prediction (= those with the largest absolute values). For example, in this plot we can see that the feature 'AveOccup' has an effect of around zero for all but one sample, which indicates that the model might have overfit on one outlier point and it might be best to exclude this feature altogether.</span></div>
</div>
<div class="paragraph">
<p>&#8594; It is easier to understand and validate the results if only a few features are considered important. Use an L1-regularized model (e.g., <code>linear_model.LassoLarsCV</code>) to get sparse weights.</p>
</div>
<div class="paragraph">
<p><span class="underline">Generalization for neural networks:</span> <strong>Layer-wise Relevance Propagation (LRP)</strong>: Similar to how the prediction of the linear model was split up into the contributions of the individual input features, by keeping track of the gradients in a neural network, the decision can be decomposed as well to obtain the influence of each feature on the final prediction. This is similar to what happens in the backpropagation procedure when training the network, only that with LRP not the prediction error, but the prediction itself is propagated backwards layer by layer (hence the name) until we arrive at the input layer and get the individual contributions of the features.<br>
<span class="small">For <code>torch</code> networks, this approach is implemented in the <a href="https://captum.ai/" target="\_blank"><code>captum</code> library</a> as the &#8216;Input X Gradient&#8217; method. The library also contains many other methods for interpreting neural networks, however, I find this the most natural approach, since it is a direct extension of the intuitive feature effects approach used to interpret linear models.</span></p>
</div>
</div>
<div class="sect3">
<h4 id="_global_model_agnostic_permutation_feature_importance">[Global] Model-agnostic: permutation feature importance</h4>
<div class="paragraph">
<p>The first question when it comes to global explainability is always &#8220;Which features are important?&#8221;, i.e., how much does the model rely on each feature when making its predictions?
We can shed light on this using the permutation importance, which, for each feature, is computed like this:</p>
</div>
<div class="paragraph">
<p>&#8216;Feature importance&#8217; = &#8216;performance of trained model on original dataset&#8217; minus &#8216;performance when values for this feature are shuffled&#8217;.</p>
</div>
<div class="paragraph">
<p>I.e., first, a trained model is normally evaluated on the original dataset (either training or test set), then for one feature the values from all samples are permuted and the performance of the trained model on this modified dataset is computed again. If there is a big discrepancy between the performance on the original and permuted dataset, this means the model heavily relies on this feature to make correct predictions, while if there is no difference, then this feature is not relevant. For example, a linear model that has a coefficient of zero for one feature would not change its predictions if this feature was shuffled.</p>
</div>
<div class="paragraph">
<p>Since a single permutation of a feature might by chance shuffle the values in a way that is close to the original ordering, this process is performed multiple times, i.e., we get a distribution of the permutation importance scores for each feature, which can again be visualized as a box plot:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_explainability/expl_perm_imp.png" alt="image" width="540">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.inspection</span> <span class="keyword">import</span> <span class="include">permutation_importance</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_global_model_agnostic_influence_of_individual_features_on_prediction">[Global] Model-agnostic: influence of individual features on prediction</h4>
<div class="paragraph">
<p>After we&#8217;ve identified which features are important for a model in general, we can dig deeper to see <em>how</em> each of these features influences the final prediction. A simple way to accomplish this is with <strong>Individual Conditional Expectation (ICE) &amp; Partial Dependence (PD) Plots</strong>.</p>
</div>
<div class="paragraph">
<p>To generate these plots, we take some samples and systematically vary the feature in question for each sample, i.e., set it to many different values within the normal range of values for this feature while keeping everything else about the data points the same. We then observe by how much and in which direction the predictions for these samples change in response to the different values set for the feature.</p>
</div>
<div class="paragraph">
<p>The ICE plot shows the results for individual samples (thin lines), while the PD plot shows the averaged values (thick line), where the ICE plot can be used to verify that some opposite changes in individual samples are not averaged out in the PD plot:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_explainability/expl_pdp.png" alt="image" width="740">
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
One big drawback of this approach is that it assumes that the features are independent of each other, i.e., since the features are varied individually, this could otherwise result in unrealistic feature combinations. For example, if one feature is the height of a person (in the range of 60-200cm) and another feature is the weight (30-120kg), then when these features are varied independently, at some point we would evaluate a data point with height: 200cm and weight: 30kg, which seems like a very unhealthy combination.<br>
However, by examining the ICE plot for possibly erratic changes for individual samples, this can usually be spotted. And in general&#8201;&#8212;&#8201;this goes for all explainability methods&#8201;&#8212;&#8201;the results should not be over-interpreted, i.e., they are good for showing rough trends, but remember that the plots might also look completely different for a different type of model trained on the same dataset, i.e., be careful before concluding anything about the root causes of a problem based on these results.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Usually, we want a model that reacts smoothly to changes in the input data. Drastic changes in the decision function as a result of minor changes to the input data suggest that a model might be vulnerable to an adversarial attack. Data augmentation can help decrease the model&#8217;s sensitivity to noise and other minor variations in the input data.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.inspection</span> <span class="keyword">import</span> <span class="include">partial_dependence</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_local_model_agnostic_local_interpretable_model_agnostic_explanations_lime">[Local] Model-agnostic: <em>Local Interpretable Model-agnostic Explanations</em> (LIME)</h4>
<div class="paragraph">
<p>To generate an explanation for a single sample of interest:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate a local neighborhood dataset through small perturbations of the sample&#8217;s feature vector.</p>
</li>
<li>
<p>Use the original model to predict labels for these new points, i.e., generate an artificial labeled training set for the local surrogate model.</p>
</li>
<li>
<p>Train an intrinsically interpretable model (e.g., a linear model) on the neighborhood dataset.<br>
&#8658; The decision surface of the original model is very complex, but we assume that it can be approximated locally with a linear function.</p>
</li>
<li>
<p>Interpret the local surrogate model&#8217;s prediction for the sample of interest.</p>
</li>
</ol>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Explaining ML with more ML&#8230;&#8203;
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>&#8594; <a href="https://github.com/marcotcr/lime" target="\_blank"><code>lime</code> Python library</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_example_based_explanations">Example-Based Explanations</h4>
<div class="paragraph">
<p>Manually examine some of the data points for which the model predicted a certain target &amp; hopefully notice a pattern&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Prototypes</strong>: Representative samples, e.g., cluster centroids.</p>
</li>
<li>
<p><strong>Optimal inputs</strong>: Optimized samples that result in a strong prediction of the given target. For example, in a neural network we can also optimize the input instead of the weights:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_explainability/optimal_inputs.png" alt="image" width="600">
</div>
<div class="title"><span class="small">Optimal inputs generated with <a href="https://distill.pub/2017/feature-visualization/" target="\_blank">Google&#8217;s &#8216;DeepDream&#8217;</a></span></div>
</div>
</li>
<li>
<p><strong>Counterfactual examples</strong>: Samples with minor modifications that change the prediction. For example, similar to how the optimal inputs are generated, we can also start with an image from a different class (instead of random noise) and adapt it until the network changes its prediction for it.</p>
</li>
<li>
<p><strong>Adversarial examples</strong>: Counterfactual examples where a human doesn&#8217;t notice the change.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_concept_drifts">Data &amp; Concept Drifts</h3>
<div class="paragraph">
<p>We must never forget that the world keeps on changing and that models need to be updated regularly with new data to be able to adapt to these changing circumstances!</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<strong>ML fails silently!</strong> I.e., even if all predictions are wrong, the program does not simply crash with some error message.<br>
&#8594; Need constant monitoring to detect changes that lead to a deteriorating performance!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><span class="underline">One of the biggest problems in practice: Data and Concept Drifts:</span><br>
The model performance quickly decays when the distribution of the <strong>data used for training</strong> \(P_{train}(X, y)\) is <strong>different from the data the model encounters when deployed in production</strong> \(P_{prod}(X, y)\), where  \(P(X, y) = P(y|X)P(X) = P(X|y)P(y)\).<br>
Such a discrepancy can be due to</p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p><strong><em>Data drift:</em></strong> the distribution of one or more variables changes. This is called a <em>covariate shift</em> if the distribution of input features \(X\) changes, i.e., \(P_{train}(X) \neq P_{prod}(X)\), and a <em>label shift</em> if the distribution of the target variable \(y\) changes.</p>
</li>
<li>
<p><strong><em>Concept drift:</em></strong> input/output relationship \(X \to y\) changes, i.e., \(P_{train}(y|X) \neq P_{prod}(y|X)\). This means with exactly the same inputs \(X\) we now get a different output \(y\) than before the drift.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In both cases, something important for our machine learning task changes in the world. If our collected data reflects this change, it is called data drift. If we can&#8217;t see this change in our input data, we&#8217;re dealing with a concept drift.</p>
</div>
<div class="paragraph">
<p><span class="underline">Example:</span> From the production settings incl. the size of a produced part (\(X\)) we want to predict whether the part is scrap or okay (\(y\)):</p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p><em>Data drift:</em> The company used to manufacture only small parts, now they also produce larger parts.</p>
</li>
<li>
<p><em>Concept drift:</em> The company used to produce 10% scrap parts, but after some maintenance on the machine, the same production settings (\(X\)) now result in only 5% scrap (\(y\)).</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Covariate shifts, without concept drift, can lead to label shifts when the input variable is causally related to the target. For example, a model predicting cancer (\(y\)) in patients based on age (\(x\)) was trained on a dataset consisting of mostly older people, who naturally also have a higher cancer incidence. In production, the model is used on patients of all ages (<em>covariate shift</em>), i.e., including more young people that have cancer less frequently (<em>label shift</em>).
</td>
</tr>
</table>
</div>
<h4 id="_drift_origins_mitigation_strategies" class="discrete">Drift Origins &amp; Mitigation Strategies</h4>
<div class="paragraph">
<p>There are various reasons for data and concepts drifts, both related to how the data is collected as well as external events outside our control.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These drifts can either be <strong>gradual</strong> (e.g., languages change gradually as new words are coined; a camera lens gets covered with dust over time), or they can come as a <strong>sudden shock</strong> (e.g., someone cleans the camera lens; when the COVID-19 pandemic hit, suddenly a lot of people switched to online shopping, which tripped up the credit card fraud detection systems).
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Changed data schema: </dt>
<dd>
<p>Many problems are created in-house and could be avoided, for example</p>
<div class="ulist">
<ul>
<li>
<p>the user interface used to collect the data changes, e.g., a height was previously recorded in meters, now in cm</p>
</li>
<li>
<p>the sensor configuration changed, e.g., in a new version of a device, a different sensor is used, but still logs values under the same variable name as the old sensor</p>
</li>
<li>
<p>the features used as input for the model are changed, e.g., to include additional engineered features, but the feature transformation pipeline was only changed in the training code, not yet in the production code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#8658; These cases should ideally result in an error, e.g., we could include some <strong>checks before applying the model</strong> to make sure we received the expected number of features, their data types (e.g., text or numbers) is as expected, and the values are roughly in the expected range for the respective feature. Furthermore, other teams in the company need to be made aware that an ML model is relying on their data so they can notify the data science team ahead of time in case of changes.</p>
</div>
</dd>
<dt class="hdlist1">Data drifts: </dt>
<dd>
<p>Data drifts occur when our model has to make predictions for samples that are different from the data it encountered during training, e.g., because certain regimes of the training domain were undersampled, or in the extreme case the model might even be forced to extrapolate beyond the training domain, for example, due to</p>
<div class="ulist">
<ul>
<li>
<p><strong>changed sample selection</strong>, e.g., the business recently expanded to a different country or after a targeted marketing campaign the website is now visited by a new user group</p>
</li>
<li>
<p><strong>adversarial behavior</strong>, e.g., spammers continuously adapt their messages in an effort to circumvent spam filters (i.e., ten years ago a human would have also recognized a spam message from today as spam (i.e., the meaning of what is or isn&#8217;t spam didn&#8217;t change), but these more sophisticated messages weren&#8217;t included in the training set yet, making it hard for ML models to pick up on these patterns)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#8658; Data drifts can be seen as an opportunity to extend our training set and <strong>retrain the model with more data from underrepresented subgroups</strong>. Yet, as highlighted in the earlier section on model-based discrimination, this often implies that these undersampled subgroups could initially experience a less effective model, such as a speech recognition function performing less accurately for women than for men. Therefore, it&#8217;s crucial to identify subgroups where the model might exhibit poor performance, ideally gathering more data from these groups or, at the very least, giving greater consideration to these samples during model training and evaluation.</p>
</div>
</dd>
<dt class="hdlist1">Concept drifts: </dt>
<dd>
<p>Concept drifts happen when external changes or events occur that we did not record in our data or that change the meaning of our data. This means that the exact same input features suddenly result in a different output. One reason can be that we&#8217;re <strong>missing a variable that has a direct influence on the target</strong>, for example</p>
<div class="ulist">
<ul>
<li>
<p>our process is sensitive to temperature and humidity, but we only recorded the temperature not the humidity, so as the humidity changes, the same temperature values result in different output values &#8658; additionally include humidity as an input feature in the model</p>
</li>
<li>
<p>seasonal trends result in changes in the popularity of summer vs. winder clothes &#8658; include month / outside temperature as an additional input feature</p>
</li>
<li>
<p>special events, e.g., a celebrity mentioned our product on social media or people changed their behavior because of the lockdown during a pandemic &#8658; while it can be hard to predict these events in advance, when they happen we could include an additional feature, e.g., &#8216;during lockdown&#8217;, to distinguish data collected during this time period from the rest of the data</p>
</li>
<li>
<p>degenerate feedback loops, i.e., the existence of the model changes users' behavior, e.g., a recommender system causes users to click on videos just because they were recommended &#8658; include as an additional feature whether the video was recommended or not to learn how much of &#8220;user clicked on item&#8221; was due to the item being recommended and how much was due to the user&#8217;s natural behavior</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Another cause of concept drifts are events that <strong>change the meaning of the recorded data</strong>, for example</p>
</div>
<div class="ulist">
<ul>
<li>
<p>inflation: 1 Euro in 1990 was worth more than 1 Euro now &#8658; adjust the data for inflation or include the inflation rate as an additional input feature</p>
</li>
<li>
<p>a temperature sensor immersed in water amasses limescale and after a while the temperature reading is not accurate anymore, e.g., if the true temperature is 90 degrees, a clean senor measures the true 90 degrees, but after it has accumulated some layers of limescale, it only measures 89 degrees under the same circumstances. While our output is influenced by the true temperature, we only have access to the sensor reading for the temperature, which is additionally influenced by the state of the sensor itself &#8658; try to estimate the amount of accumulated limescale, e.g., based on the number of days since the sensor was cleaned the last time (which also means that these kinds of maintenance events need to be recorded somewhere!)</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_data_issues/concept_drift.png" alt="image" width="420">
</div>
<div class="title"><span class="small">Causal diagram showing how our observed input \(x\) (temperature measurement) and output \(y\) are related through and influenced by hidden variables (which we can not access directly), namely, the state of the temperature sensor (i.e., how much limescale has accumulated), the actual temperature, and the humidity (for which we have not installed a sensor yet). If the sensor state and humidity stay constant, we are able to predict the output from the temperature measurement, however, if either of these values change, we experience a concept drift. Therefore, we should try to include estimates of these hidden variables in our model to account for these changes.</span></div>
</div>
<div class="paragraph">
<p>
&#8658; Before training a model, examine the data to <strong>identify instances where identical inputs yield different outputs</strong>. If possible, <strong>include additional input features to account for these variations</strong>. Subpar model performance on the test set often indicates missing relevant inputs, heightening vulnerability to future concept drifts. Even when the correct variables are incorporated to capture a concept drift, frequent model retraining may still be necessary. For instance, different states of the concept might be sampled unevenly, leading to data drifts (e.g., more data collected during winter than in the early summer months). If it is not possible to include variables that account for the concept drift, it might be necessary to <strong>remove samples from the original training set that do not conform to the novel input/output relation before retraining the model</strong>.</p>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The best way to counteract data and concept drifts is to frequently <strong>retrain the model</strong> on new data. This can either happen on a schedule (e.g., every weekend, depending on how quickly the data changes) or when your monitoring system raises an alert because it detected drifts in the inputs or a deteriorating model performance.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>While traditional ML models typically need to be retrained from scratch, neural network models can also be fine-tuned on newly collected data, however, this is only useful when faced with minor data drifts, not drastic concept drifts.</p>
</div>
<div class="paragraph">
<p>To get a better understanding of how often it might be necessary to retrain the model, we can train the model on data from different periods in the past and then compare the performance on the most recent data (e.g., train the model on data from Jan-June, April-Sept, and June-Nov and then compare the performances on the data from December&#8201;&#8212;&#8201;if the model trained on the most recent data performs much better, it probably makes sense to retrain the model more frequently). Of course, in the presence of sudden events, it might be necessary to train the model outside of the regular schedule.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Monitoring for data &amp; concept drifts</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Use statistical tests to detect changes in the distributions of individual features:</p>
<div class="ulist">
<ul>
<li>
<p>Kullback-Leibler divergence</p>
</li>
<li>
<p>Jensen-Shannon divergence</p>
</li>
<li>
<p>Kolmogorov-Smirnov (K-S) test</p>
</li>
<li>
<p>Wasserstein / Earth Movers distance</p>
</li>
</ul>
</div>
</li>
<li>
<p>Use novelty detection or clustering to identify data points that are different from the training samples. Even if a sample&#8217;s individual feature values are still in a normal range, this particular combination of feature values can be far from what the model encountered during training.</p>
</li>
<li>
<p>Check if there is a difference between the predicted and true (training) label frequencies. For example, if in reality usually about 10% of our produced products are faulty, but the model suddenly predicts that 50% of the products are faulty, then something is probably off.</p>
</li>
<li>
<p>Check whether the confidence scores of the model predictions (i.e., the probability for a class, not the predicted class label) get lower, which indicates that new samples are closer to the model&#8217;s decision boundary than the training samples.</p>
</li>
<li>
<p>Check the error metrics of the model on new data (only possibly if you continuously collected new <em>labeled</em> data).</p>
</li>
<li>
<p>After retraining the model on new data, check if the feature importances changed, which indicates that it might be time to select different features for the prediction.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These checks can be combined with a sliding window approach, for example, every hour the data collected in the last 48 hours is compared to the training data. If any of the monitoring values exceeds some predefined threshold, the system triggers an alert and possibly automatically retrains the model on new data.</p>
</div>
<div class="paragraph">
<p>Additionally:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Validate the input data schema, i.e., check that data types and value ranges (incl. missing values / NaNs) match those encountered in the training data.</p>
</li>
<li>
<p>Log known external events (!!), e.g., maintenance on a machine.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The "ML fails silently" part also applies to bugs in your code: Especially when you just started with ML it often happens that your results seem fine (maybe just a little too good), but you have a subtle bug somewhere that doesn&#8217;t cause your program to crash, but just calculates something slightly wrong somewhere. These issues can be very hard to notice, so always triple-check your code and if you can, write <a href="https://realpython.com/python-testing/" target="\_blank">unit tests</a> for individual functions to make sure they do what you expect them to do.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You might also want to have a look at Google&#8217;s <a href="https://developers.google.com/machine-learning/guides/rules-of-ml" target="\_blank">rules of machine learning</a> (the first one being: <em>"Don&#8217;t be afraid to launch a product without machine learning."</em>)
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_topics">Advanced Topics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we&#8217;ve discussed different unsupervised and supervised learning methods, we explore some other special-purpose methods, which can be used to solve somewhat less straightforward problems:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/ml_goals_other.png" alt="image" width="840">
</div>
</div>
<div class="sect2">
<h3 id="_deep_learning_2">Deep Learning</h3>
<div class="paragraph">
<p>We&#8217;ve already covered the general principles behind neural networks in a <a href="#_neural_networks">previous chapter</a>. Now we&#8217;ll have a look at more complex architectures to work with, for example, image or text data, as well as some advanced training techniques and special-purpose Python libraries for implementing custom neural network architectures.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want to learn more about deep learning, there are many great free resources available online, such as the introductory videos from <a href="https://www.3blue1brown.com/topics/neural-networks" target="\_blank">3blue1brown</a>, which nicely illustrate what neural networks are actually computing and how backpropagation works; the <a href="https://www.coursera.org/specializations/deep-learning" target="\_blank">Coursera Deep Learning Specialization (by Andrew Ng)</a>, which provides a good general introduction with many practical tips and also covers application areas like computer vision and NLP; or the <a href="https://atcold.github.io/pytorch-Deep-Learning/" target="\_blank">Deep Learning with PyTorch course (by Yann LeCun)</a>, which is a bit more advanced and discusses state-of-the-art architectures.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_advanced_nn_architectures">Advanced NN architectures</h4>
<div class="paragraph">
<p>Similar to how domain-specific feature engineering can result in vastly improved model performances, it pays off to construct a neural network architecture tailored to the task.</p>
</div>
<div class="sect4">
<h5 id="_recurrent_neural_network_rnn">Recurrent Neural Network (RNN)</h5>
<div class="paragraph">
<p>Recurrent neural networks are great for sequential data such as time series data or text (i.e., a sequence of words).</p>
</div>
<div class="paragraph">
<p>In its simplest form, a RNN is like a FFNN, but with additional recurrent connections \(W_h\) in the hidden layer to create a memory of the past:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/rnn2.png" alt="image" width="460">
</div>
</div>
<div class="paragraph">
<p>It&#8217;s easiest when thinking about the RNN unrolled in time:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/rnn_unrolled2.png" alt="image" width="540">
</div>
<div class="title"><span class="small">At the beginning of a new sequence, the hidden state \(\mathbf{x}'_0\) is initialized with zeros. Then for each new sample \(\mathbf{x}_t\) (with \(t \in \{1, ..., T\}\)) in the sequence, the hidden state is updated based on this new input (after multiplying \(\mathbf{x}_t\) with \(W_1\)), as well as the previous hidden state at \(t-1\) (by multiplying  \(\mathbf{x}'_{t-1}\) with \(W_h\)). From this new hidden state \(\mathbf{x}'_t\), the output for this time step can then be predicted (by multiplying \(\mathbf{x}'_t\) with \(W_2\)). While this network only includes a single recurrent layer, a more complex architecture could also contain multiple such layers.</span></div>
</div>
<div class="paragraph">
<p>The original RNN layer uses a very simple update rule for the hidden state, but there also exist more advanced <a href="https://towardsdatascience.com/44e9eb85bf21" target="\_blank">types of RNNs</a>, like the Long Short Term Memory (LSTM) network or Gated Recurrent Units (GRU), which define more complex rules for how to combine the new input with the existing hidden state, i.e., they learn in more detail what to remember and which parts to forget, which can be beneficial when the data consists of longer sequences.</p>
</div>
<div class="paragraph">
<p>The cool thing about RNNs is that they can process input sequences of varying length (where one sequence represents one data point, e.g., a text document), whereas all methods that we&#8217;ve discussed so far always expected the feature vectors that represent one data point to have a fixed dimensionality. For RNNs, while the input at a single time step (i.e., \(\mathbf{x}_t\) with \(t \in \{1, ..., T\}\)) is also a feature vector of a fixed dimensionality, the sequences themselves do not need to be of the same length \(T\) (e.g., text documents can consist of different numbers of words). This comes in especially handy for time series analysis, as we&#8217;ll see in the next chapter.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Useful in Natural Language Processing (NLP):</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">RNNs can take word order into account, which is ignored in TF-IDF vectors</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_nlp/rnn_wordemb.png" alt="image" width="440">
</div>
<div class="title"><span class="small">This is an example architecture for a sentence classification task (e.g., sentiment analysis, i.e., deciding whether the text is positive or negative). The individual words in the sentence are represented as so-called word embeddings, which are just <em>d</em>-dimensional vectors that contain some (learned) information about the individual words (e.g., whether the word is more male or female; how these embeddings are created is discussed in the section on self-supervised learning below). The RNN is then fed the sentence word by word and at the end of the sentence, the final hidden state, which contains the accumulated information of the whole sentence, is used to make the prediction. Since the RNN processes the words in the sentence sequentially, the order of the words is taken into account (e.g., whether a &#8220;not&#8221; occurred before an adjective), and since we use word embeddings as inputs, which capture semantic and syntactic information about the words, similarity between individual words (e.g., synonyms) is captured, thereby creating more meaningful representations of text documents compared to TF-IDF vectors (at the expense of greater computational complexity).</span></div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_convolutional_neural_network_cnn">Convolutional Neural Network (CNN)</h5>
<div class="paragraph">
<p>Manual feature engineering for computer vision tasks is incredibly difficult. While humans recognize a multitude of objects in images without effort, it is hard to describe <em>why</em> we can identify what we see, e.g., which features allow us to distinguish a cat from a small dog. Deep learning had its first breakthrough success in this field, because neural networks, in particular CNNs, manage to learn meaningful feature representations of visual information through a hierarchy of layers.</p>
</div>
<div class="paragraph">
<p>Convolutional neural networks are very well suited for processing visual information, because they can operate on the 2D images directly and do not need the input to be flattened into a vector. Furthermore, they utilize the fact that images are composed of a lot of local information (e.g., eyes, nose, and mouth are all localized components of a face).</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/cnn.png" alt="image" width="840">
</div>
<div class="title"><span class="small">CNNs utilize two important operations, convolutions and pooling layers, to generate meaningful feature representations: A <a href="https://en.m.wikipedia.org/wiki/Convolution" target="\_blank">convolution</a> is computed by taking a small filter patch (e.g., a \(5 \times 5\) matrix) and moving it over the image pixel by pixel and row by row, at each position multiplying the filter with the image (see also <a href="https://youtu.be/Oqm9vsf_hvU?t=275" target="\_blank">this animation</a>). This results in a feature map of the same size as the original image, where a high value at some position indicates that the respective feature in the filter (e.g., an edge with a specific orientation) was detected at this position in the original image. Since this is done for multiple filters, the output after a convolutional layer consists of as many new feature maps as the layer had filters. The filter patches (i.e., multiple small matrices) are the learned weights of the CNN, and after training they can look something like the small tiles shown below the network architecture. The pooling layers then perform a subsampling of the individual feature maps by taking the max (or sometimes mean) value of multiple pixels in a small area. This reduces the dimensionality of the hidden layer representation, thereby improving the computational efficiency. Additionally, the pooling introduces some positional invariance, since it is not important anymore where exactly in some area a detected feature was, e.g., a face can be recognized even if the eyes of one person are further apart than usual or they have a longer nose, etc. Usually, the convolutional and pooling layers are interleaved, however, there is no strict rule saying that a pooling layer always has to follow a convolutional layer. With more layers, more and more complex features can be detected as a composition of the features identified in the lower layers (notice how the filters first detect edges, then individual components of a face, then full faces), i.e., by making the network deeper, we can solve more complex tasks. Finally, after multiple convolution and pooling layers, the feature representation is flattened into a vector and fed to a FFNN (i.e., fully connected layers) to perform the classification.</span></div>
</div>
<div class="paragraph">
<p>Compared to the dense / fully-connected layers in FFNNs, which consist of one huge matrix mapping from one layer to the next, the filter patches used in convolutional layers are very small, i.e., there are less parameters that need to be learned. Furthermore, the fact that the filters are applied at every position in the image has a regularizing effect, since the filters need to be general enough capture relevant information in multiple areas of the images.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By the way, the edge filters typically learned in the first layer of a CNN nicely match the <a href="https://en.wikipedia.org/wiki/Gabor_filter" target="\_blank">Gabor filters</a> used in early computer vision feature engineering attempts. Combined with the subsequent pooling operation, they compute something similar as the <a href="https://towardsdatascience.com/45afa1046f7f" target="\_blank">simple and complex cells</a> in the human primary visual cortex.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_general_principles">General Principles</h5>
<div class="paragraph">
<p>When trying to solve a problem with a NN, always consider that the network needs to understand the inputs, as well as generate the desired outputs:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/nn_architectures4.png" alt="image" width="740">
</div>
<div class="title"><span class="small">As we&#8217;ve seen in the CNN used for image classification in the previous section, the representation generated by the CNN is at some point flattened and a FFNN then computes the final prediction for the classification task. Similarly, the final hidden state of a RNN, representing the information contained in a sentences, can be passed to a FFNN to generate a prediction (e.g., for sentiment analysis). However, some problems do not fall into the category of simple supervised learning tasks (i.e., regression or classification), and require a different output. For example, in machine translation, the output should be the sentence translated into the other language, which can be achieved by coupling two RNNs: the first &#8216;understands&#8217; the sentence in the original language and this representation of the meaning of the sentence is then passed to a second RNN, which generates from it the translated sentence word by word. (If we need to translate texts from and to multiple languages, this can be done very efficiently by using just one input and one output network for each language and have them operate on the same meaning representations, i.e., instead of learning multiple pairs of networks for each language combination individually, we only learn for each language one network to understand this language and one network to generate output sentences in this language.) Another example is the task of image captioning (i.e., generating text describing what can be seen on an image, e.g., to improve the online experience for people with visual impairment), where first the image is &#8216;understood&#8217; by a CNN and then this representation of the input image is passed to a RNN to generate the matching text.</span></div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Below are two examples of neural network architectures that deal with somewhat unusual inputs and outputs and incorporate a lot of domain knowledge, which enables them to achieve state-of-the-art performance on the respective tasks:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Predicting the 3D structure of a protein from its amino acid sequence with AlphaFold</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/01_alphafold_nn.png" alt="image" width="840">
</div>
<div class="title"><span class="small">https://deepmind.google/discover/blog/alphafold-a-solution-to-a-50-year-old-grand-challenge-in-biology/ (30.11.2020)</span></div>
</div>
</dd>
<dt class="hdlist1">Predicting properties of molecules with SchNet (which is an example of a <a href="https://www.youtube.com/watch?v=uF53xsT7mjc" target="\_blank">Graph Neural Network (GNN)</a>)</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/schnet.png" alt="image" width="840">
</div>
<div class="title"><span class="small">Schütt, Kristof T., et al. &#8220;Quantum-chemical insights from deep tensor neural networks.&#8221; <em>Nature communications</em> 8.1 (2017): 1-8.</span></div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_self_supervised_transfer_learning">Self-Supervised &amp; Transfer Learning</h4>
<div class="paragraph">
<p><a href="https://ai.facebook.com/blog/self-supervised-learning-the-dark-matter-of-intelligence/" target="_blank" rel="noopener"><strong>Self-supervised learning</strong></a> is a very powerful technique with which neural networks can learn meaningful feature representations from unlabeled data. Using this technique is cheap since, like in unsupervised learning, it does not require any labels generated by human annotators. Instead, pseudo-labels are generated from the inputs themselves by masking parts of it. For example, a network can be trained by giving it the first five words of a sentence as input and then asking it to predict what the next word should be. This way, the network learns some general statistics and knowledge about the world, similar to how human brains interpolate from the given information (e.g., with the <a href="https://en.wikipedia.org/wiki/Blind_spot_(vision)" target="\_blank">blind spot test</a> you can nicely observe how your brain predicts missing information from the given context). Self-supervised learning is often used to &#8220;pretrain&#8221; a neural network before using it on a supervised learning task (see transfer learning below).</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>NLP Example: <strong>Neural Network Language Models</strong> (e.g., <code>word2vec</code> &#8594; have a look at <a href="https://jalammar.github.io/illustrated-word2vec/" target="\_blank">this blog article</a> for more details) use self-supervised learning to generate word embeddings that capture semantic &amp; syntactic relationships between the words (which is ignored in TF-IDF vectors, where each word dimension has the same distance to all other words):</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_nlp/word2vec.png" alt="image" width="640">
</div>
<div class="title"><span class="small">The learned word embeddings can be used to solve analogy questions like those posed in an IQ test, e.g., "<em>man</em> is to <em>king</em> as <em>women</em> is to <em>XXX</em>", where the correct answer is <em>queen</em>. This can be solved with vector arithmetic, i.e., by taking the word embedding for <em>king</em>, subtracting from it the embedding for <em>man</em>, adding the embedding for <em>women</em> and then checking which word embedding is closest to this new vector (which should be the embedding for <em>queen</em>).</span></div>
</div>
<div class="paragraph">
<p>&#8658; These word embedding vectors can then be used as input to a RNN.</p>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Transfer learning</strong> is the idea of using what a network has learned before on a different task (e.g., a self-supervised learning task) as a starting point when tackling a new task. In practice, this means the weights of our network are initialized with (some of) the weights of a network trained on another task, before training our network on the new task. We also say that the network was pretrained on a source task before it is fine-tuned on the target task.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/transfer_learning_nn.png" alt="image" width="760">
</div>
<div class="title"><span class="small">From an old project, we have a network that was trained on a large dataset to recognize dogs in images (= source task). Now we&#8217;re working on a new project, where we want to recognize cats in images (= target task). Since the two tasks are very similar (cats and dogs share a lot of the same features) and we only have a small dataset available for the new task, transfer learning could improve the prediction performance on the target task.</span></div>
</div>
<div class="paragraph">
<p>Typically, not all the weights of a target network are initialized with weights from a source network, but only those from the earlier layers, where the source network has learned some general principles that are not task specific (e.g., observe how the first layer of the CNN in the previous section had learned to detect edges, which seems like a relevant skill for pretty much all computer vision tasks). Often, using a pretrained network will give us a more robust solution and boost the prediction performance, especially if we only have a very small dataset for the target task available to train the network. However, since when training a neural network we&#8217;re trying to find weights that minimize the loss function by iteratively improving the weights starting with some initialization, if this initialization is unfavorable because it is very far away from a good minimum (i.e., further away than a random initialization), e.g., because we&#8217;ve initialized the weights with those from a source network trained on a very different task, then this can hurt the performance, since the network first has to unlearn a lot of things from this unrelated task before it can learn the actual task. Therefore, transfer learning should only be used if the source and target tasks are &#8220;related enough&#8221;. Pretraining a network on a self-supervised learning task (i.e., a task that is just about understanding the world in general, not solving a different kind of specific task) usually works quite well though.</p>
</div>
<div class="paragraph">
<p>When using transfer learning, one question is whether to &#8220;freeze&#8221; the weights that were copied from the source network, i.e., to use the pretrained part of the network as a fixed feature extractor and only train the later layers that generate the final prediction. This is basically the same as first transforming the whole dataset once by pushing it through the first layers of a network trained on a similar task and then using these new feature representations to train a different model. While we often get good results when training a traditional model (e.g., a SVM) on these new feature representations, it is generally not recommended for neural networks. In some cases, we might want to keep the pretrained weights fixed for the first few epochs, but in most cases the performance will be best if all weights are eventually fine-tuned on the target task.</p>
</div>
<div class="paragraph">
<p>In cases where transfer learning is not beneficial, because the source and target tasks are not similar enough, it can nevertheless be helpful to copy the network architecture in general (i.e., number and shape of the hidden layers). Using an appropriate architecture is often more crucial than initializing the weights themselves.</p>
</div>
</div>
<div class="sect3">
<h4 id="_neural_networks_in_python">Neural Networks in Python</h4>
<div class="paragraph">
<p>There are several libraries available for working efficiently with neural networks (especially since many of the big firms doing machine learning decided to develop their own library): <code>theano</code> was the first major deep learning Python framework, developed by the MILA institute at the university of Montreal (founded by Yoshua Bengio), then came <code>TensorFlow</code>, developed by the Google Brain team, <code>MXNet</code> (pushed by Amazon), and finally <code>PyTorch</code>, developed by the Facebook/Meta AI Research team (lead by Yann LeCun). PyTorch is currently preferred by most ML researchers, while TensorFlow is still found in many (older) applications used in production.</p>
</div>
<div class="paragraph">
<p>Below you can find some example code for how to construct a neural network using PyTorch or Keras (which is a wrapper for TensorFlow to simplify model creation and training). Further details can be found in the example notebooks on GitHub, which also use the (Fashion) MNIST datasets described below to benchmark different architectures.</p>
</div>
<div class="paragraph">
<p>[Recommended:] <a href="https://pytorch.org/" target="\_blank"><code>torch</code> library</a>
(&#8594; to simplify model training, combine with <a href="https://skorch.readthedocs.io/en/stable/" target="\_blank"><code>skorch</code> library</a>!)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">import</span> <span class="include">torch</span>
<span class="keyword">import</span> <span class="include">torch.nn.functional</span> <span class="keyword">as</span> F

<span class="keyword">class</span> <span class="class">MyNeuralNet</span>(torch.nn.Module):

    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="predefined-constant">self</span>, n_in, n_hl1, n_hl2, n_out=<span class="integer">10</span>):
        <span class="comment"># neural networks are always a subclass of torch modules, which makes it possible</span>
        <span class="comment"># to use backpropagation and gradient descent to learn the weights</span>
        <span class="comment"># the call to the super() constructor is vital for this to work!</span>
        <span class="predefined">super</span>(MyNeuralNet, <span class="predefined-constant">self</span>).__init__()
        <span class="comment"># initialize the layers of the network with random weights</span>
        <span class="comment"># a Linear layer is the basic layer in a FFNN with a weight matrix,</span>
        <span class="comment"># in this case with shape (n_in, n_hl1), and a bias vector</span>
        <span class="predefined-constant">self</span>.l1 = torch.nn.Linear(n_in, n_hl1)  <span class="comment"># maps from dimensionality n_in to n_hl1</span>
        <span class="comment"># we need to make sure that the shape of the weights matches up</span>
        <span class="comment"># with that from the previous layer</span>
        <span class="predefined-constant">self</span>.l2 = torch.nn.Linear(n_hl1, n_hl2)
        <span class="predefined-constant">self</span>.lout = torch.nn.Linear(n_hl2, n_out)

    <span class="keyword">def</span> <span class="function">forward</span>(<span class="predefined-constant">self</span>, x):
        <span class="comment"># this defines what the network is actually doing, i.e.,</span>
        <span class="comment"># how the layers are connected to each other</span>
        <span class="comment"># they are now applied in order to transform the input into the hidden layer representations</span>
        h = F.relu(<span class="predefined-constant">self</span>.l1(x))       <span class="comment"># 784 -&gt; 512 [relu]</span>
        h = F.relu(<span class="predefined-constant">self</span>.l2(h))       <span class="comment"># 512 -&gt; 256 [relu]</span>
        <span class="comment"># and finally to predict the probabilities for the different classes</span>
        y = F.softmax(<span class="predefined-constant">self</span>.lout(h))  <span class="comment"># 256 -&gt; 10 [softmax]</span>
        <span class="keyword">return</span> y

<span class="comment"># this initializes a new network</span>
my_nn = MyNeuralNet(<span class="integer">784</span>, <span class="integer">512</span>, <span class="integer">256</span>)
<span class="comment"># this calls the forward function on a batch of training samples</span>
y_pred = my_nn(X_batch)
<span class="comment"># (btw: using an object like a function also works for other classes if you implement a __call__ method)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://keras.io/" target="\_blank"><code>keras</code> framework</a> (which simplifies the construction and training of <a href="https://www.tensorflow.org/" target="\_blank">TensorFlow</a> networks)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">tensorflow</span> <span class="keyword">import</span> <span class="include">keras</span>

<span class="comment"># construct a feed forward network:</span>
<span class="comment"># 784 -&gt; 512 [relu] -&gt; 256 [relu] -&gt; 10 [softmax]</span>
model = keras.Sequential()
<span class="comment"># we need to tell the first layer the shape of our input features</span>
model.add(keras.layers.Dense(<span class="integer">512</span>, activation=<span class="string"><span class="delimiter">'</span><span class="content">relu</span><span class="delimiter">'</span></span>, input_shape=(<span class="integer">784</span>,)))
<span class="comment"># the following layers know their input shape from the previous layer</span>
model.add(keras.layers.Dense(<span class="integer">256</span>, activation=<span class="string"><span class="delimiter">'</span><span class="content">relu</span><span class="delimiter">'</span></span>))
model.add(keras.layers.Dense(<span class="integer">10</span>, activation=<span class="string"><span class="delimiter">'</span><span class="content">softmax</span><span class="delimiter">'</span></span>))

<span class="comment"># compile &amp; train the model (for a classification task)</span>
model.compile(loss=keras.losses.categorical_crossentropy,
              optimizer=keras.optimizers.Adam(), metrics=[<span class="string"><span class="delimiter">'</span><span class="content">accuracy</span><span class="delimiter">'</span></span>])
model.fit(X, y)

<span class="comment"># predict() gives probabilities for all classes; with argmax we get the actual labels</span>
y_pred = np.argmax(model.predict(X_test), axis=<span class="integer">1</span>)
<span class="comment"># evaluate the model (returns loss and whatever was specified for metrics in .compile())</span>
print(<span class="string"><span class="delimiter">&quot;</span><span class="content">The model is this good:</span><span class="delimiter">&quot;</span></span>, model.evaluate(X_test, y_test)[<span class="integer">1</span>])
<span class="comment"># but of course we can also use the evaluation functions from sklearn</span>
print(<span class="string"><span class="delimiter">&quot;</span><span class="content">Equivalently:</span><span class="delimiter">&quot;</span></span>, accuracy_score(y_test, y_pred))</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Standard ML Benchmarking Datasets</dt>
<dd>
<p>The MNIST handwritten digits dataset is very old and super easy even for traditional models.<br>
&#8594; \(28 \times 28\) pixel gray-scale images with 10 different classes:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/MnistExamples.png" alt="image" width="640">
</div>
</div>
<div class="paragraph">
<p>The new MNIST dataset: Fashion<br>
&#8658; Same format (i.e., also 10 classes and images of the same shape), but more useful for benchmarks since the task is harder.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_nn/mnist_fashion.jpeg" alt="image" width="640">
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_information_retrieval_similarity_search">Information Retrieval (Similarity Search)</h3>
<div class="paragraph">
<p>The goal of information retrieval is to identify similar items given some query:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/05_supervised_other/inforetr.png" alt="image" width="640">
</div>
<div class="title"><span class="small">Just like in the reverse Google image search, we here use as input a query image and get as a result the <em>k</em> images that are most similar to it.</span></div>
</div>
<div class="paragraph">
<p>This can be accomplished by building a nearest neighbors search tree (i.e., just like for the k-nearest neighbors algorithm, only that here we return the neighbors directly instead of using them to predict the label for the new data point).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="keyword">from</span> <span class="include">sklearn.neighbors</span> <span class="keyword">import</span> <span class="include">NearestNeighbors</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>But of course, the success of this approach is again highly dependent on being able to compute meaningful similarities between the data points. For text datasets, information retrieval often works quite well by using simple TF-IDF feature vectors together with a cosine similarity, however, for images, for example, out-of-the-box similarity measures that operate directly on the original input features (i.e., pixel values) are only able to identify images with similar colors, not necessarily similar content (e.g., an image showing a black cat would be more similar to an image showing a black dog than a white cat). To get around this problem, we could use neural networks to obtain a more informative feature representation, with which it is then easier to compute meaningful semantic similarities.</p>
</div>
</div>
<div class="sect2">
<h3 id="_recommender_systems_pairwise_data">Recommender Systems (Pairwise Data)</h3>
<div class="paragraph">
<p>Recommender systems can be found on many websites to promote products, content, or ads that a specific user might be interested in (e.g., on Amazon, Netflix, Facebook, YouTube, etc.).</p>
</div>
<div class="paragraph">
<p>What is special about them is that here we&#8217;re not really dealing with single data points, but instead with pairwise data, i.e., we have samples from two groups (e.g., users and movies), where each combination of samples (e.g., each (user, movie)-tuple) is assigned a label (e.g., the rating the user gave to the movie).</p>
</div>
<div class="paragraph">
<p>Typically, the training set contains only very few labels (e.g., since there are many users and many movies, but every user has only rated a handful of movies) and the task is to predict all the missing labels, based on which then, for example, a user would be recommended the movie with the highest predicted rating.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><span class="underline">Recommender Systems Overview:</span></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pairwise data</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>(user, movie) &#8594; rating (1 - 5 stars)</p>
</li>
<li>
<p>(drug, protein) &#8594; bind (yes / no)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Idea:</strong> Similar users watch similar movies.<br>
<strong>Given:</strong> Very sparse matrix with known interactions:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_recsys/rec_sys_pairwise.png" alt="image" width="200">
</div>
</div>
<div class="paragraph">
<p><strong>Task:</strong> Fill in the missing values.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>There are lots of different approaches for how to accomplish this, and we&#8217;ll only look at two here, the traditional method of collaborative filtering, and a more modern approach relying on neural networks that falls under the category of triplet learning.</p>
</div>
<div class="paragraph">
<p>&#8594; One possible Python library: <a href="http://surpriselib.com/" target="\_blank"><code>surprise</code></a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Collaborative Filtering</dt>
<dd>
<p>Using a <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition" target="\_blank">singular value decomposition</a> (SVD; basically the big sister of the eigendecomposition, e.g., from <code>scipy.sparse.linalg.svds</code>), the matrix with the known interactions can be decomposed into two smaller matrices of shapes (number of movies \(\times\, d\)) and (\(d \,\times\) number of users) and by multiplying these matrices together, the missing values from the original matrix are approximated:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_recsys/rec_sys_svd3.png" alt="image" width="600">
</div>
<div class="title"><span class="small">The two matrices we obtain from the SVD contain <em>d</em>-dimensional latent variable representations of movies and users respectively, where <em>d</em> denotes the number of eigenvectors we decided to keep (corresponding to the <em>d</em> largest eigenvalues of the original matrix). You can think of these as feature vectors, where, for example, one of the <em>d</em> dimensions in the vector representing a movie might correspond to how much this movie is considered a horror movie, while the same dimension in a user vector indicates how much this user likes horror movies. If both entries for some dimension in the vectors point in the same direction (e.g., the movie is a horror movie and the user likes horror movies), then the product of the two entries will contribute positively to the overall scalar product of the vectors and therefore the approximated rating. However, please note that just like with the new feature dimensions we got from PCA, it is very difficult to determine exactly what is actually encoded in each dimension.</span></div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>One big problem with this approach is that we always need some initial ratings for each user and movie, otherwise we can&#8217;t generate any useful personalized recommendations. This is also referred to as the &#8220;cold start problem&#8221;, which can be addressed with triplet learning.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Triplet Learning / Content-based Filtering</dt>
<dd>
<p>In triplet learning, we don&#8217;t directly work with the full matrix of known interactions, but instead the training dataset consists of triplets for the existing labels (e.g., (user <em>i</em>, movie <em>j</em>, 4 stars), which can also be a more memory-friendly representation). Additionally, we assume that we have feature vectors available for the users and movies (e.g., the users might have filled out a short survey when they set up an account and for the movies we know the genres, directors, and plot keywords; if all fails, this could also just be a one-hot encoding).<br>
Given the two feature vectors of a user and a movie, we predict the interaction value directly:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_recsys/rec_sys_triplet2.png" alt="image" width="700">
</div>
<div class="title"><span class="small">These are two possible neural network architectures for predicting the rating a user might give to a movie. The architecture on the left first processes the user and movie feature vectors individually (in case they require a certain type of network to be understood, e.g., for the movie plot description or poster), and then the representations are concatenated into a single vector, which is then passed to a FFNN to predict the rating (= a regression task). A different approach is shown on the right, where instead the two original feature representations for users and movies are projected into the same vector space, where then the cosine similarity of these two vectors is computed to predict the interaction between them (similar as with the <em>d</em>-dimensional latent variable representations in the collaborative filtering approach).</span></div>
</div>
<div class="paragraph">
<p>&#8594; Given the feature vector of a new user who has not rated any movies yet, we are now able to generate useful predictions.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_time_series_forecasting">Time Series Forecasting</h3>
<div class="paragraph">
<p>In the chapter on data, where we discussed what can be considered <a href="#_what_constitutes_one_data_point">&#8216;one data point&#8217;</a>, you&#8217;ve already encountered some tasks that involve time series data. Now we&#8217;re looking into possibly the most difficult question that one can try to solve with time series data, namely predicting the future.</p>
</div>
<div class="paragraph">
<p>In time series forecasting, sometimes also called &#8220;predictive analytics&#8221;, the goal is to predict the future time course of a variable (i.e., its values for \(t' &gt; t\)) from its past values (and possibly some additional information).
This is, for example, used in <strong>Predictive Maintenance</strong>, where the remaining life span or degradation of important process components is forecast based on their past usage and possibly some future process conditions:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_timeseries/timeseries4.png" alt="image" width="660">
</div>
<div class="title"><span class="small">One predictive maintenance problem coming up over and over again in the chemical production industry is trying to predict the remaining activity or lifetime of a catalyst (a critical component in a chemical plant that facilitates the reaction; visualized as the purple line) under different process conditions (which are planned for the future; blue and green lines). For example, the catalyst might decay faster, if the process is run at a higher temperature. If the weekend is coming up, a predictive maintenance model could be used to estimate the temperature at which the process should be run such that the catalyst lasts until the next Monday, when the crew to replace it is back.</span></div>
</div>
<div class="paragraph">
<p><strong>Predictive Maintenance Example Paper:</strong><br>
Bogojeski, M., et al. &#8220;Forecasting industrial aging processes with machine learning methods.&#8221; <em>Computers and Chemical Engineering</em> 144 (2021): 107123. <a href="https://arxiv.org/abs/2002.01768" target="\_blank">(arXiv:2002.01768)</a></p>
</div>
<div class="sect3">
<h4 id="_input_and_target_variables">Input and Target Variables</h4>
<div class="paragraph">
<p>Basically, we can think of time series forecasting as a supervised learning problem with more complicated inputs &amp; outputs:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_timeseries/tsf_inout8.png" alt="image" width="800">
</div>
<div class="title"><span class="small">Depending on the task (i.e., what we want to forecast), we either have a <strong>univariate</strong> forecasting problem (if we only need to predict the development of a single variable) or a <strong>multivariate</strong> problem (i.e., with multiple target variables). Additionally, it is important to note for <strong>how many time steps into the future</strong> the variables need to be forecast: In the easiest case, only the next time step needs to be predicted, but it might also be necessary to predict a fixed window of \(k\) time steps into the future, and sometimes the prediction horizons might even be of varying lengths. In any case, we should always try to make use of as much (relevant) information as possible when making forecasts. In principle, <strong>all values from the past can be used as input features</strong>, especially those from the target variable(s) (&#8594; see also auto-regressive models, e.g., <a href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average" target="\_blank">ARIMA</a>). What is often overlooked, however, is all the additional <strong>information about the future</strong> that can be used as inputs as well, provided that these values are independent of the targets, i.e., <strong>exogenous variables</strong> outside of the system.</span></div>
</div>
<div class="paragraph">
<p>For example, let&#8217;s say we own a small cafe and want to predict how much ice cream we are likely to sell tomorrow. Certainly, the amount of ice cream we&#8217;ve sold yesterday or on the same day last week will be useful input features, but additionally, for example, the weather forecast for tomorrow or whether or not there is a holiday or some special event happening would be useful predictive information that should not be ignored and that can be used since these are independent variables.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><span class="underline">Know your data: Beware of hidden feedback loops!</span></p>
</div>
<div class="paragraph">
<p>In this predictive maintenance example, the pressure in some pipes indicates how much residual material has built up on the walls of the pipes (&#8594; <a href="https://en.wikipedia.org/wiki/Fouling" target="\_blank">fouling</a>) and the task is to predict when these pipes need to be cleaned again, i.e., when the next maintenance event is due.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">What are input features, what are targets?</dt>
<dd>
<div class="imageblock text-center">
<div class="content">
<img src="images/07_timeseries/input_target_leak4.png" alt="image" width="580">
</div>
</div>
<div class="paragraph">
<p>While in general many future process conditions (e.g., the planned amount of product that should be produced in the next weeks), can be used as input variables at \(t' &gt; t\), this does not hold for the process condition &#8216;temperature&#8217; in this example, since it is not a true exogenous variable, even though it could theoretically be set independently. In the historical data, the value of the temperature at \(t+1\) is dependent on the target variable (pressure) at \(t\), therefore, if we want to forecast the target for more than one time step, only the past values of temperature can be used as input features.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>We need a feature vector for every time point we want to make a prediction about. Think about what it is we&#8217;re trying to predict and what values could influence this target variable, i.e., what inputs are needed such that we have all the required information to make the prediction. Especially when using stateless models (see below), the feature vectors need to capture all the relevant information about the past.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Possible Input Features</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Known information about future (e.g., weather forecast, planned process conditions).</p>
</li>
<li>
<p>Auto-regressive: Lagged (target) variable (i.e. values at \(t' \leq t\)).<br>
❗️ Don&#8217;t use the <em>predicted</em> target value for this (in a multi-step forecast) – errors accumulate!</p>
</li>
<li>
<p>Account for cyclical (e.g., seasonal) trends &#8594; check auto-correlation or spectral analysis.<br>
<span class="small">For example, a cafe might sell more ice cream during the summer or it could be located next to a school and therefore sell more on days the kids come by in their lunch break:</span><br>
<span class="image"><img src="images/07_timeseries/ts_months.png" alt="image" width="160"></span>
<span class="image"><img src="images/07_timeseries/ts_week.png" alt="image" width="160"></span><br>
&#8594; Include categorical variables <code>month</code> and <code>day_of_week</code>.</p>
</li>
<li>
<p>For predictive maintenance: hours / integral of input variable since last maintenance event (maybe take log).<br>
<span class="image"><img src="images/07_timeseries/ts_integralfeat.png" alt="image" width="470"></span></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>&#8594; For more ideas: <a href="https://tsfresh.readthedocs.io/en/latest/" target="\_blank">tsfresh library</a>, <a href="https://machinelearningmastery.com/category/deep-learning-time-series/" target="\_blank">time series analysis blog posts</a></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_stateless_vs_stateful_models">Stateless vs. Stateful Models</h4>
<div class="paragraph">
<p>When dealing with time series data, one should always think carefully about how complex the dependencies between the past and future process values in the respective forecasting task are.<br>
For example, when trying to predict <strong>spontaneous events</strong>, like a sudden increase in the emissions produced in the process, then the relevant time window into the past, when the process conditions might have had an influence on this target variable, would be very short, i.e., only the process values from time \(t\) need to be included in the input feature vector to predict the anomalous event at time \(t+1\).<br>
For other prediction tasks, what happened over a <strong>longer (but uniquely determined) interval</strong> might be relevant, but can be <strong>summarized with simple features</strong>. For example, in a production process, one might want to predict the quality of the final product that is produced within a fixed time interval. In this case, the process conditions during the time interval where the respective product is produced will be important for the prediction, but the process conditions during the time where the previous product was produced are most likely not relevant. Additionally, it would be enough to compute only some summary statistics (like mean/max/min values of the process conditions during the time interval of interest) and use these as input features to capture all the relevant information.<br>
The third case are prediction tasks for which it is necessary to consider <strong>very long time windows</strong>, often of varying lengths, with some <strong>complex long-ranging dependencies</strong> between the process conditions at different time points. For example, in some predictive maintenance tasks, the decay of the critical process component might not happen in some linear fashion (unlike, for example, a light bulb, which might have some fixed life expectancy and one only needs to count the number of hours it was turned on up to now to estimate when it needs to be replaced). Instead, there exist more complex dependencies, for example, the component might decay faster if it is already in a poor state. Therefore, if some unfortunate combination of process conditions lead to a strain on the component early on, it might have to be replaced a lot sooner than under otherwise identical conditions without this initial mishap, i.e., <strong>the order of events matters</strong> a lot, too.</p>
</div>
<div class="paragraph">
<p>Depending on how complex the dependencies are between the process values over time, it will be more or less complicated to construct feature vectors that capture all the relevant information to make accurate predictions. In general, one should always try to come up with <strong>features that contain all the relevant information about the past</strong>, i.e., that fulfill the <a href="https://en.wikipedia.org/wiki/Markov_property" target="\_blank">Markov assumption</a> that given this information the future is otherwise independent of the history of the process: For example, if we knew the number of hours a light bulb was turned on up to now, we would have a complete picture about the state the light bulb is currently in; everything else that happened in the past, like how many people were in the room while the light was on, is irrelevant for the state of the light bulb. Another example is the current position of pieces on a chess board: To plan our next move, we don&#8217;t need to know the exact order in which the pieces were moved before, but only the position of all the pieces right now.</p>
</div>
<div class="paragraph">
<p>If we are able to derive such input features, we can use a <strong>stateless model</strong> for the prediction (e.g., any of the supervised learning models we&#8217;ve discussed so far except RNNs), i.e., treat all data points as independent regardless of where in time they occurred. If it is not possible to construct such an informative feature vector that captures all the relevant information about the past, e.g., because of complex long-ranging dependencies that can not be adequately captured by simple summary statistics, then we have to use a <strong>stateful model</strong> (e.g., a form of Recurrent Neural Network (RNN)), which internally constructs a full memory of the history of the process, i.e., it keeps track of the current state of the process.</p>
</div>
<div class="paragraph">
<p>Whether to use a stateless or stateful model is also an important consideration when dealing with other kinds of sequential data such as text. Analogous to the three scenarios described above, we can also find similar cases for natural language processing (NLP) problems that either benefit from the use of stateful models or where a simple stateless model is enough:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Spontaneous event:</strong> Trigger word detection for smart speakers: A simple classification task for which only the last 1-2 spoken words, i.e., the audio signal from a time window of a few seconds, are relevant.</p>
</li>
<li>
<p><strong>Fixed interval &amp; summary features:</strong> Text classification, e.g., determining the category of a newspaper article (e.g., &#8216;sports&#8217; or &#8216;politics&#8217;): While here a longer span of text needs to be considered to make the prediction, a simple TF-IDF vector is usually sufficient to represent the contents of the whole document, since such categories can easily be identified by simply checking whether the terms &#8220;soccer&#8221; or &#8220;politician&#8221; occur more often in the current article. Furthermore, the span of text that is relevant for the task is fixed: we only need to consider the current article and it can be considered independent of the articles written before it.</p>
</li>
<li>
<p><strong>Complex long-ranging dependencies:</strong> For some tasks like sentiment analysis or machine translation, it doesn&#8217;t just matter which words occurred in a text, but also in which order and what their larger surrounding context was.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>&#8594; While for 1. and 2. a stateless model will do just fine, for 3. the best performance is achieved with a stateful model that can keep track of the more complex dependencies.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">TL;DR: Which type of model should we use?</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>How much does the future depend on the past?<br>
a) Values at \(t\) or simple summary statistics are sufficient as input features to predict \(t' &gt; t\).<br>
b) There exist complex long-ranging dependencies between past and future values and the order of events matters.</p>
</li>
<li>
<p>How many time steps into the future do we need to predict?<br>
a) A fixed, small window of \(1\) or \(k\) steps.<br>
b) Arbitrarily long prediction horizons.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If <strong>only a)</strong>:<br>
&#8594; <em>Stateless</em> model, e.g., linear model, FFNN, random forest, &#8230;&#8203;<br>
If <strong>any b)</strong>:<br>
&#8594; <em>Stateful</em> model, e.g., recurrent neural network (RNN)</p>
</div>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When working with time series data, the train, validation, and test data splits should always be in chronological order, i.e., the model is trained on the oldest time points and evaluated on more recent samples to get a realistic performance estimate, especially in cases where the data changes over time, e.g., due to smaller changes in the underlying process.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Output prediction with <em>stateless</em> models (e.g., linear regression, FFNN)</dt>
<dd>
<p>Only predict for a fixed time window of 1 or <em>k</em> steps:<br></p>
<div class="ulist none">
<ul class="none">
<li>
<p>Univariate, single-step prediction:</p>
<div class="stemblock">
<div class="content">
\[[\underbrace{\quad y_1 \quad}_{t' \,\leq\, t} | \underbrace{\, x_1 \, | \,  x_2 \, }_{t+1} ] \; \to \; [\underbrace{y_1}_{t+1}]\]
</div>
</div>
</li>
<li>
<p>Multivariate, single-step prediction:</p>
<div class="stemblock">
<div class="content">
\[[\underbrace{\quad y_1  \quad | \quad y_2 \quad}_{t' \,\leq\, t} | \underbrace{\, x_1 \, | \,  x_2 \, }_{t+1} ] \; \to \; [\underbrace{\, y_1  \, | \, y_2 \, }_{t+1}]\]
</div>
</div>
</li>
<li>
<p>Multivariate, multi-step prediction:</p>
<div class="stemblock">
<div class="content">
\[[\underbrace{\quad y_1  \quad | \quad y_2 \quad}_{t' \,\leq\, t} | \underbrace{\quad\quad x_1 \quad\quad | \quad\quad  x_2 \quad\quad }_{t+1\, ...\, t+k} ] \; \to \; [\underbrace{\quad\quad y_1 \quad\quad | \quad\quad  y_2 \quad\quad }_{t+1\, ...\, t+k}]\]
</div>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Output prediction with <em>stateful</em> models (e.g., RNN, LSTM, GRU, Echo State Network)</dt>
<dd>
<p>The model builds up a memory of the past by mirroring the actual process, i.e., even if we don&#8217;t need the prediction at some time step \(t-5\), we still need to feed the model the inputs from this time step so that it can build up the appropriate hidden state.</p>
<div class="paragraph">
<p>Multivariate, multi-step prediction:</p>
</div>
</dd>
</dl>
</div>
<div class="stemblock">
<div class="content">
\[\begin{aligned}
...\\
t-1:\quad [\, x_1 \, | \,  x_2 \,]\; &amp;\to \; [\, y_1  \, | \, y_2 \,]\\
\text{memory state buildup} \quad\quad\quad\quad t:\quad [\, x_1 \, | \,  x_2 \,]\; &amp;\to \; [\, y_1  \, | \, y_2 \,]\\
---------------------&amp;------\\
\text{prediction} \quad\quad\quad\quad\quad t+1:\quad [\, x_1 \, | \,  x_2 \,]\; &amp;\to \; [\, y_1  \, | \, y_2 \,]\\
t+2:\quad [\, x_1 \, | \,  x_2 \,]\; &amp;\to \; [\, y_1  \, | \, y_2 \,]\\
...\\
t+k:\quad [\, x_1 \, | \,  x_2 \,]\; &amp;\to \; [\, y_1  \, | \, y_2 \,]
\end{aligned}\]
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reinforcement_learning_2">Reinforcement Learning</h3>
<div class="paragraph">
<p>Finally, we come to the last main category of ML algorithms besides unsupervised and supervised learning: reinforcement learning.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Main idea</dt>
<dd>
<p>Agent performs actions in some environment and learns their (state-specific) consequences by receiving rewards.</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/08_rl/reinforcement_learning4.png" alt="image" width="640">
</div>
<div class="title"><span class="small">The environment lets the agent know in which state it currently is. Then the agent selects some action, i.e., how it responds to this state, according to its internal policy function \(\pi\) (the main thing that is learned in RL). The environment evaluates the consequences of this action and returns an immediate reward (e.g., "game over" or "collected a coin"), as well as the next state, at which point the cycle repeats.</span></div>
</div>
<div class="paragraph">
<p><span class="underline">Goal:</span> Maximize the <em>cumulative</em> reward (also called <em>return</em>), i.e., the sum of the immediate rewards received from the environment over all time steps in an episode (e.g., one level in a video game).<br>
The difficult thing here is that sometimes an action might not result in a big immediate reward, but is still crucial for the agent&#8217;s long-term success (e.g., finding a key at the beginning of a level and the door for which we need the key comes much later). This means the agent needs to learn to perform an optimal <em>sequence of actions</em> from <em>delayed labels</em>.</p>
</div>
<div class="paragraph">
<p>The agent&#8217;s decision trajectory basically defines one path among a bunch of different possible parallel universes, which is then judged in the end by the collected return:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/08_rl/rl_trajectory2.png" alt="image" width="720">
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Reinforcement Learning vs. &#8216;normal&#8217; Optimization</dt>
<dd>
<p>In regular mathematical optimization, we are given some fixed function \(f: \mathbb{R}^d \to \mathbb{R}\) and try to find the inputs \(\mathbf{x} \in  \mathbb{R}^d\) that maximize (or minimize) the value of \(f(\mathbf{x})\). Since each evaluation of \(f(\mathbf{x})\) is independent of the next, we could theoretically try as many different values for \(\mathbf{x}\) as we wanted, until we&#8217;ve found some combination of inputs that results in an optimal value for \(f\).<br>
<span class="small">If \(f\) is easily differentiable, the solution to the optimization problem can be found analytically by setting the first derivative of \(f\) to zero to obtain the local extrema or saddle points of \(f\), which can then be examined further to determine the (global) maximum or minimum. If \(f\) is not differentiable (or very complicated), there exist other methods to find optimal values (for example, the gradient descent procedure used to tune the weights of neural networks is one method for obtaining a (local) optimum without calculating the derivative of the network&#8217;s error function directly, while a naive grid search, where we just try many different input combinations and then select the values with the best outcome, or more fancy approaches such as <a href="https://en.wikipedia.org/wiki/Particle_swarm_optimization" target="\_blank">particle swarm optimization</a>, can also be applied to functions that are non-differentiable).</span><br></p>
<div class="paragraph">
<p>Translated to RL terms, \(f\) would be the environment <em>in one particular state</em>, \(\mathbf{x}\) would be the action, and \(f(\mathbf{x})\) would be the immediate reward as a result of taking this action in the current state. However, since in RL setups the state of the environment changes with each action that is taken, this means the function \(f\) also changes in each step and an action that might have resulted in a high reward in the previous step could now mean &#8220;game over&#8221;. Furthermore, in RL we&#8217;re not too concerned about every single immediate reward, but instead we want to achieve long-term success, measured by the return (i.e., cumulative rewards), and an action with a low immediate reward might still pay off later.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Immediate rewards vs. long-term value of states</dt>
<dd>
<p>To make decisions that are good in the long run, we&#8217;re more interested in what being in a state means w.r.t. reaching the final goal instead of receiving immediate rewards:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/08_rl/rl_value3.png" alt="image" width="640">
</div>
<div class="title"><span class="small"><em>Left:</em> This is a simple "grid world", where an agent can move up, down, left, or right through the states. This small environment contains three terminal states (i.e., when the agent reaches one of them, the episode ends): Two states mean "game over" with an infinite negative reward, while reaching the state in the lower right corner means receiving a large positive immediate reward. When the agent resides in any of the other (reachable) states, it receives a small negative reward, which is meant to "motivate" the agent to go to the goal state as quickly as possible. However, knowing only the immediate reward for each state is not very helpful to decide which action to take next, since in most states, the reward for moving to any of the surrounding states or staying in place would be the same. Therefore, what the agent needs to learn in order to be able to choose an action in each state that has the potential of bringing it closer to the goal state, is the value of being in each state. <em>Right:</em> The value of a state is the expected return when starting from this state. Of course, the expected return is highly dependent on the agent&#8217;s policy \(\pi\) (i.e., the actions it takes), e.g., if the agent would always move to the left, then it would never be able to reach the goal, i.e., the expected return starting from any state (except the goal state itself) would always be negative. If we assume an optimal policy (i.e., the agent always takes the quickest way to the goal), then the value of each state corresponds to the ones shown in the graphic, i.e., for each state "100 minus the number of steps to reach the goal from here". Knowing these values, the agent can now very easily select the best next action in each state, by simply choosing that action, which brings it to the next reachable state with the highest value.</span></div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The value of a state \(s\) corresponds to the expected return \(G_t\) when starting from state \(s\):</p>
</div>
<div class="stemblock">
<div class="content">
\[V^\pi(s) = \mathbb{E} [G_t | S_t = s]\]
</div>
</div>
<div class="paragraph">
<p>The most naive way to calculate \(V^\pi(s)\) would be to let the agent start from this state several times (depending on how complex the environment is usually several thousand times), observe how each of the episodes play out, and then compute the average return that the agent had received in all these runs starting from state \(s\).</p>
</div>
<div class="paragraph">
<p>Similarly, we can calculate the expected return when executing action \(a\) in state \(s\):</p>
</div>
<div class="stemblock">
<div class="content">
\[Q^\pi(s, a) = \mathbb{E} [G_t | S_t = s, A_t = a]\]
</div>
</div>
<div class="paragraph">
<p>I.e., here again we could let the agent start from the state \(s\) many times, but this time the first action it takes in this state is always \(a\).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Exploration/Exploitation trade-off</dt>
<dd>
<p>Of course, it would be very inefficient to always just randomly try out actions in any given state and thereby risk a lot of predictable &#8220;game over&#8221;. Instead, we want to balance exploration and exploitation to keep updating our knowledge about the environment, but at the same time also maximize the rewards collected along the way. This is again inspired by human behavior:</p>
<div class="openblock">
<div class="content">
<div class="ulist none">
<ul class="none">
<li>
<p>&#8594; <strong><em>Exploration:</em></strong> Learn something about the environment (e.g., try a new restaurant).</p>
</li>
<li>
<p>&#8594; <strong><em>Exploitation:</em></strong> Use the collected knowledge to maximize your reward (e.g., eat somewhere you know you like the food).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>A very simple strategy to accomplish this is the <span class="underline"><em>Epsilon-Greedy Policy:</em></span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">initialize eps = <span class="integer">1</span>
<span class="keyword">for</span> step <span class="keyword">in</span> <span class="predefined">range</span>(max_steps):
    <span class="keyword">if</span> random(<span class="integer">0</span>, <span class="integer">1</span>) &gt; eps:
        pick best action (= exploitation)
    <span class="keyword">else</span>:
        pick random action (= exploration)
    <span class="predefined">reduce</span> eps</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1">Tabular RL: Q-Learning</dt>
<dd>
<p>This brings us to the simplest form of RL, tabular RL, where an agent has a finite set of actions to choose from and operates in an environment with a finite set of states (like the grid world from above). Here, we could simply compute the Q-value for each (state, action)-combination as described above, and save these values in a big table. This so-called Q-table then acts as a cheat sheet, since for each state the agent is in, it can just look up the Q-values for all of the available actions and then choose the action with the highest Q-value (when in exploitation-mode):</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/08_rl/rl_tabular3.png" alt="image" width="580">
</div>
</div>
</dd>
<dt class="hdlist1">Function Approximation: Deep Q-Learning</dt>
<dd>
<p>Unfortunately, almost no practical RL application operates in an environment consisting of a finite set of discrete states (and sometimes even the agent&#8217;s actions are not discrete, e.g., the steering wheel positions in a self-driving car&#8201;&#8212;&#8201;but this goes too far here). In video games, for example, each frame is a new state and depending on the complexity of the game, no two frames might be exactly alike. This is where Deep Q-Learning comes in:<br></p>
<div class="paragraph">
<p>Given a state \(s\) (represented by a feature vector \(\mathbf{x}_s\)), predict the Q-value of each action \(a_1 ... a_k\) with a neural network:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/08_rl/rl_dqn.png" alt="image" width="640">
</div>
</div>
<div class="paragraph">
<p>This can be seen as a direct extension of the tabular Q-learning: If we represented our states as one-hot encoded vectors and used a linear network with a single weight matrix that consisted of the Q-table we had constructed before, by multiplying the one-hot encoded vector with the Q-table, the network would &#8220;predict&#8221; the row containing the Q-values for all actions in this state.<br>
By using a more complex network together with meaningful feature representations for the states, deep Q-learning enables the agent to generalize to unseen states. However, just like in time series forecasting tasks, here again the feature representation of a state needs to include all the relevant information about the past, e.g., in video games (think: old pong game) the feature vector could contain the last four frames to additionally capture the direction of movement.</p>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Pros</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>RL works well for games:<br>
&#8594; Environment = Game = Simulation (i.e., no discrepancy between &#8220;real world&#8221; and simulation model).<br>
&#8594; Well defined reward function.<br>
&#8594; Utilize &#8220;self-play&#8221; for multi-player games, i.e., two RL agents playing against each other.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Careful</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Acting in the real world is too expensive &#8594; need accurate (simulation) model of the environment.</p>
</li>
<li>
<p>AIs love to cheat and exploit bugs in the simulation.</p>
</li>
<li>
<p>Difficult to design appropriate reward function (and RL will overfit it, resulting in unintended consequences).</p>
</li>
<li>
<p>Model-free RL is very sample inefficient (i.e., needs millions of iterations, which takes too long in real-time).</p>
</li>
<li>
<p>Agent is responsible for collecting its own experiences: bad policy &#8658; bad data &#8658; no improvement.</p>
</li>
<li>
<p>Deep RL: complex network architectures, very sensitive to hyperparameter choices<br>
&#8658; Hard to train &amp; get robust results &#8594; requires lots of tricks.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>&#8594; <em>Imitation learning</em> is often used instead of RL, which just means using supervised learning to train an agent to react similar to a human in some situation. Often, it is also easier to collect data from humans than to define a complicated reward function, e.g., humans drive around all the time, however, it is hard to define what would be considered &#8220;good driving&#8221; under lots of different circumstances. After the agent was pretrained on the human behavior, its policy can still be fine-tuned with an RL approach (e.g., this is how AlphaGo became better than a human Go master).</p>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>RL further reading + videos</strong></p>
</div>
<div class="paragraph">
<p><span class="underline">General theory:</span></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://medium.com/emergent-future/d195264329d0" target="\_blank">Simple Blog Series</a></p>
</li>
<li>
<p><a href="https://simoninithomas.github.io/deep-rl-course/" target="\_blank">Free RL course incl. programming examples</a></p>
</li>
<li>
<p><a href="https://www.davidsilver.uk/teaching/" target="\_blank">Lectures by David Silver</a> (from DeepMind)</p>
</li>
<li>
<p><a href="https://cs234.stanford.edu/" target="\_blank">Stanford RL course</a> (with <a href="https://www.youtube.com/playlist?list=PLoROMvodv4rOSOPzutgyCTapiGlY2Nd8u" target="\_blank">video lectures</a>)</p>
</li>
<li>
<p><a href="http://incompleteideas.net/book/RLbook2020.pdf" target="\_blank">Book about RL</a> (with lots of math)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="underline">Words of caution (recommended for everyone):</span></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.alexirpan.com/2018/02/14/rl-hard.html" target="\_blank">RL doesn&#8217;t work (yet)</a></p>
</li>
<li>
<p><a href="https://deepmind.google/discover/blog/specification-gaming-the-flip-side-of-ai-ingenuity/" target="\_blank">Unintended rewards</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="underline">RL in action:</span></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.youtube.com/watch?v=5GMDbStRgoc" target="\_blank">Playing Super Mario</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=rhNxt0VccsE" target="\_blank">Learning to walk</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=wL7tSgUpy8w" target="\_blank">Learning to drive a car</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/watch?v=iaF43Ze1oeI" target="\_blank">Robot arm data collection</a> (by Google)</p>
</li>
<li>
<p><a href="https://youtu.be/wRCAl9m3ce8?t=1493" target="\_blank">Playing video games</a> with Layer-wise Relevance Propagation (LRP) to show the evolution of strategy</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you&#8217;ve learned a lot about the machine learning (ML) theory, especially the different algorithms:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/01c_ml_overview/ml_algorithms.png" alt="image" width="840">
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;it is time for a reality check.</p>
</div>
<div class="paragraph">
<p><strong>Hype vs. Reality</strong></p>
</div>
<div class="paragraph">
<p>In the introduction, we&#8217;ve seen a lot of examples that contribute to the ML hype. However, especially when applying ML in the manufacturing industry, for example, the reality often looks quite different and not every idea might work out as hoped:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hype: <em>Big Data, Deep Learning</em></th>
<th class="tableblock halign-left valign-top">Reality:</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database with millions of examples</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">150 manual entries in an excel sheet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Homogeneous unstructured data (e.g., pixels, sound, text)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Measurements from different sources with different scales (e.g., temperature, flow, pressure sensors)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fancy deep learning architectures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Neural networks are tricky to train and even more difficult to explain<br>
&#8594; Need to understand and trust predictions to make business decisions</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
But it can be done! A good example comes from the startup alcemy, which uses ML to optimize the production of CO2-reduced cement. They describe how they overcame the above mentioned challenges in <a href="https://www.youtube.com/watch?v=lt-ABfIWv1M" target="\_blank">this talk</a>.
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">What if I <em>do</em> have Big Data?</dt>
<dd>
<p>Practical definition:<br>
<em>Big Data is what does not fit in your RAM anymore.</em></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Do you <em>really</em> have Big Data?<br>
Measurements from 100 sensors every second for one year:<br>
❌ \(100\times 365 \times 24 \times 60 \times 60 \times 64 \text{ bits} \approx 25\text{ gb}\)<br>
Process changes slowly &#8594; take hourly averages:<br>
✅ \(100\times 365 \times 24 \times 64 \text{ bits} \approx 7\text{ mb}\)</p>
</li>
<li>
<p>Get more RAM! (E.g., through a cloud service like AWS).</p>
</li>
<li>
<p>Use an ensemble method, i.e.,<br>
a) split the data in equal (RAM-sized) chunks,<br>
b) train a model on each chunk,<br>
c) combine the predictions of all models.</p>
<div class="paragraph">
<p>This is also what the &#8216;big data&#8217; libraries do internally, e.g., the MapReduce approach. These frameworks are especially useful when the data doesn&#8217;t fit onto a single hard drive anymore.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Machine Learning is just the tip of the iceberg</dt>
<dd>
<p>You were already warned that in their day-to-day operations, data scientists usually spend only about 10% of their time doing the fun machine learning stuff, while the bulk of their work consists of gathering and cleaning data. This is true for an individual ML project. If your goal is to become a data-driven enterprise that uses AI in production for a wide range of applications, there are some additional challenges that should be addressed&#8201;&#8212;&#8201;but which would typically not be the responsibility of a data scientist (alone):</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/09_ml_in_practice/iceberg.png" alt="image" width="640">
</div>
<div class="title"><span class="small">See also: Sculley, David, et al. &#8220;Hidden technical debt in machine learning systems.&#8221; Advances in Neural Information Processing Systems. 2015.</span></div>
</div>
<div class="paragraph">
<p>On the plus side, things like a centralized data infrastructure and clear governance process only need to be set up once and then all future ML projects will benefit from them.</p>
</div>
</dd>
<dt class="hdlist1">Domain knowledge is key!</dt>
<dd>
<p>In the introduction, you&#8217;ve seen the Venn diagram showing that ML lies at the intersection of math and computer science. However, this is actually not the complete picture. In the previous chapters, you&#8217;ve hopefully picked up on the fact that in order to build trustworthy models that use meaningful features to arrive at robust conclusions, it is necessary to combine ML with some domain knowledge and understanding of the business problems, what is then often referred to as Data Science:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/venn3.png" alt="image" width="680">
</div>
</div>
<div class="paragraph">
<p>As we will argue in the next section, it is unrealistic to expect an individual data scientist to be an expert in all three areas, and we therefore instead propose three data-related roles to divide responsibilities in an organization.</p>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Take Home Messages</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>ML is and will be transforming all areas of our lives incl. work.</p>
</li>
<li>
<p>ML has limitations:</p>
<div class="ulist">
<ul>
<li>
<p>Performance: Some problems are hard.</p>
</li>
<li>
<p>Data Quality &amp; Quantity: Garbage in, garbage out!</p>
</li>
<li>
<p>Causality &amp; Adversarial Attacks &#8658; Explainability!!</p>
</li>
</ul>
</div>
</li>
<li>
<p>Combine ML with subject matter expertise!</p>
</li>
<li>
<p>It&#8217;s an iterative process:</p>
<div class="ulist">
<ul>
<li>
<p>Don&#8217;t expect ML to work right away!</p>
</li>
<li>
<p>Monitor and update after initial release.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><span class="underline">Also:</span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be clear about what you want to do (inputs &amp; outputs; model type; evaluation metric).</p>
</li>
<li>
<p>Data preprocessing and feature engineering are at least as important as the &#8220;real&#8221; ML stuff.</p>
</li>
<li>
<p>Fancy deep learning methods might not work with the data in your excel sheet.</p>
</li>
<li>
<p>But linear models and decision trees are great too (with the right features).</p>
</li>
<li>
<p>Always be careful when evaluating your models; manually examine some errors.</p>
</li>
<li>
<p>KNOW YOUR DATA!</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ai_transformation_of_a_company">AI Transformation of a Company</h3>
<div class="paragraph">
<p>The famous ML researcher Andrew Ng has proposed a five-step process to transform your company into a data-driven enterprise capable of using AI in production to add value.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist left">
<dl>
<dt class="hdlist1">Five steps for a successful AI Transformation by Andrew Ng</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Execute pilot projects to gain momentum</p>
</li>
<li>
<p>Build an in-house AI team &amp; data infrastructure</p>
</li>
<li>
<p>Provide broad AI training (for all employees)</p>
</li>
<li>
<p>Develop an AI &amp; data strategy</p>
</li>
<li>
<p>Develop internal and external communications</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="underline">Recommended Materials:</span><br>
&#8594; <a href="https://de.coursera.org/learn/ai-for-everyone" target="\_blank">&#8220;AI for everyone&#8221; Coursera course</a><br>
&#8594; <a href="https://landing.ai/ai-transformation-playbook/" target="\_blank">AI Transformation Playbook</a><br></p>
</div>
</dd>
</dl>
</div>
<div class="paragraph text-center text-center">
<p><span class="image"><img src="images/09_ml_in_practice/01_Andrew_Ng.jpg" alt="image" width="140"></span><br>
<strong>Prof. Dr. Andrew Ng</strong><br>
<span class="small">Co-Founder Google Brain</span><br>
<span class="small">Vice President Baidu</span><br>
<span class="small">Co-Founder Coursera</span><br>
<span class="small">Professor @ Stanford University</span></p>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">[Step 1] Start with small pilot projects to understand the potential and challenges of using ML</dt>
<dd>
<p>Machine learning projects are unlike traditional software projects, where you&#8217;re usually certain that a solution at least exists and you only need to figure out an efficient way to get there. Instead, ML heavily relies on the available data. Even though it might theoretically be possible to solve your problem with ML, this might not be the case with the data you have at hand.
Before implementing some big AI initiative spanning the whole company, it is therefore strongly recommended that you start with several smaller pilot projects in order to get a better feeling for what it means to rely on an AI to solve your problems.<br>
When choosing a pilot project, the most important factor is not the Return on Investment (ROI) of the project, since here the experience with ML gained along the way should be the priority. However, it is important to choose a project that is <strong>technically feasible</strong>, i.e., which can be solved with existing ML algorithms and you don&#8217;t need years of research to develop your own fancy neural network architecture. Furthermore, you should have enough high-quality <strong>data available</strong> to get started, so you don&#8217;t spend months just on data preprocessing, e.g., due to the need to combine data from different sources within a poor data infrastructure.<br>
If you do not yet have the necessary AI talent in-house to tackle such a project, you can also partner with external consultants, which provide the ML expertise, while you supply the subject matter expertise to ensure the pilot project is a success.</p>
</dd>
<dt class="hdlist1">[Step 2] Set up a centralized AI team and data infrastructure to carry out bigger projects efficiently and effectively</dt>
<dd>
<p>We&#8217;ve already seen that in practice, it&#8217;s really about the intersection of Theory, Programming, and Domain Knowledge, i.e., Data Science. However, it is unlikely that you&#8217;ll find a single person that is truly competent in all three areas. Instead, people will always have a certain focus and we therefore propose three distinct roles, which also align very well with the three main steps for successfully executing an ML project:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/01b_intro_ml/venn7.png" alt="image" width="680">
</div>
<div class="title"><span class="small">While Data Strategists work in their respective departments to identify suitable problems that can benefit from ML, Data Scientist can experiment and develop prototypical solutions to these problems, which Data &amp; ML Engineers then get ready for production.</span></div>
</div>
<div class="paragraph">
<p>Ideally, data scientists and engineers should be in their own separate team (i.e., the &#8220;AI Team&#8221;) and work on projects from different departments like an in-house consultancy:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/09_ml_in_practice/ai_team_mitceo.png" alt="image" width="400">
</div>
<div class="title"><span class="small">[Adapted from: &#8220;AI for everyone&#8221; by Andrew Ng (coursera.org)]</span></div>
</div>
<div class="paragraph">
<p>This has several advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data scientists can discuss solutions with other ML experts &#8594; many problems will be similar from an algorithmic standpoint.</p>
</li>
<li>
<p>Combine data from the whole company for a holistic analysis.</p>
</li>
<li>
<p>Funding independent from individual business unit, e.g., necessary for the up front investment in data infrastructure, time required to keep up with new research, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As we&#8217;ve discussed in the introduction, about 90% of the time in an ML project is spent on data wrangling. Therefore, especially in the beginning, <strong>the AI team should contain more Data Engineers than Data Scientists</strong>, so they can build a solid data infrastructure, which will save Data Scientists lots of time and headaches later.</p>
</div>
</dd>
<dt class="hdlist1">[Step 3] Train other employees to recognize ML problems and establish a data-driven culture</dt>
<dd>
<p>While data scientists need to be intimately familiar with the algorithms they are using, other employees, especially data strategists and department leaders, should have some basic understanding of what ML is and is not capable of, such that they can identify possible ML problems and refer them to the AI team.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/09_ml_in_practice/ml_workshops.png" alt="image" width="840">
</div>
<div class="title"><span class="small">I have devised trainings at different levels for all audiences.</span></div>
</div>
</dd>
<dt class="hdlist1">[Step 4] Devise a cohesive strategy with long-term goals that result in a competitive advantage</dt>
<dd>
<p>Developing a strategy might be the first impulse of an executive when confronted with a new topic such as AI. However, since AI problems are so different from other kinds of projects, it really pays off to first gain some experience with this topic (i.e., start with step 1!). After you&#8217;ve successfully completed some pilot projects and set the wheels in motion to create an AI team as well as educate the other employees to get them on board, here are a few things to consider w.r.t. a companywide strategy to give you an advantage over your competition:</p>
<div class="ulist">
<ul>
<li>
<p>Create strategic data assets that are hard for your competition to replicate:</p>
<div class="ulist">
<ul>
<li>
<p>Long-term planning: Which data might be valuable in the future? &#8594; Start collecting it now!</p>
</li>
<li>
<p>Up-front investments: What infrastructure and processes are needed to make the data accessible to the right people?</p>
</li>
<li>
<p>How can you combine data from different divisions to enable the AI team to &#8220;connect the dots&#8221; and gain a unique edge over the competition?</p>
</li>
<li>
<p>What options do you have in terms of strategic data acquisition, e.g., in the form of &#8216;free&#8217; products, where users pay with their data (like what Google, Facebook, etc. are doing)?</p>
</li>
</ul>
</div>
</li>
<li>
<p>Build AI-powered features that are a unique selling point for your products:</p>
<div class="ulist">
<ul>
<li>
<p>Don&#8217;t try to recreate some off-the-shelf service that could be easily procured from an outside vendor, but use ML together with your unique subject matter expertise and data to build new features for your existing products to make them more appealing to your customers or open up new market segments.</p>
</li>
<li>
<p>How can you establish a virtuous cycle, where your AI attracts more users, which in turn generate more data, which can then be used to train the AI to become even better and thereby attracts even more users?</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/09_ml_in_practice/ai_cycle.png" alt="image" width="220">
</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">[Step 5] Communicate your success</dt>
<dd>
<p>After successfully implementing AI within the company, you should of course communicate your accomplishments. In addition to internal and external press releases, this also includes, for example, job listings, which will attract more qualified candidates if they are formulated from an informed standpoint instead of listing buzzwords.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_additional_resources">Additional Resources</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Exercises &amp; Cheat Sheet</dt>
<dd>
<p>If you haven&#8217;t already done so, have a look at:</p>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://github.com/cod3licious/ml_exercises" target="\_blank">programming exercises</a>, to get your hands dirty and apply what you&#8217;ve learned.</p>
</li>
<li>
<p>The <a href="https://franziskahorn.de/mlws_resources/cheatsheet.pdf" target="\_blank">cheat sheet</a>, which includes a step-by-step guide on how to solve a data science problem (incl. code snippets).</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebarblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Using ML in Production</dt>
<dd>
<p>If you want to learn more about how to use ML in production, including topics like:</p>
<div class="ulist">
<ul>
<li>
<p>deploying a learned model</p>
</li>
<li>
<p>detecting data &amp; concept drift</p>
</li>
<li>
<p>monitoring and retraining a model after deployment</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>then checkout the following resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the book <a href="https://www.oreilly.com/library/view/designing-machine-learning/9781098107956/">Designing Machine Learning Systems</a>&#8201;&#8212;&#8201;<em>highly recommended!</em></p>
</li>
<li>
<p>the Coursera specialization <a href="https://www.coursera.org/specializations/machine-learning-engineering-for-production-mlops" target="\_blank">Machine Learning Engineering for Production (MLOps)</a></p>
</li>
<li>
<p>the book <a href="https://www.oreilly.com/library/view/machine-learning-design/9781098115777/">Machine Learning Design Patterns</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Textbooks: theoretical background (i.e. math!)</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><em>Pattern Recognition and Machine Learning</em> by Christopher M. Bishop (2006)</p>
</li>
<li>
<p><em>Elements of Statistical Learning</em> by T. Hastie, R. Tibshirani, J. Friedman (2009)</p>
</li>
<li>
<p><em>Deep Learning</em> by I. Goodfellow, Y. Bengio, A. Courville (2016)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph text-center text-center">
<p><span class="image"><img src="images/09_ml_in_practice/book_bishop_2006.jpg" alt="image" width="188"></span>
<span class="image"><img src="images/09_ml_in_practice/book_hastie_2009.jpg" alt="image" width="188"></span>
<span class="image"><img src="images/09_ml_in_practice/book_deeplearning_2016.jpg" alt="image" width="188"></span></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Other Resources</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://scikit-learn.org/stable/user_guide.html" target="\_blank"><code>sklearn</code> User Guide</a></p>
</li>
<li>
<p><a href="https://deeplearning.ai/the-batch/" target="\_blank">DeepLearning.AI – The Batch Newsletter</a></p>
</li>
<li>
<p><a href="https://machinelearningmastery.com/" target="\_blank">Machine Learning Mastery</a> Tutorials &amp; more</p>
</li>
<li>
<p><a href="https://towardsdatascience.com/" target="\_blank">Towards Data Science Blog</a></p>
</li>
<li>
<p><a href="https://www.datacamp.com/community/data-science-cheatsheets" target="\_blank">Data Camp Cheat Sheets</a></p>
</li>
<li>
<p>Online Courses, e.g., <a href="https://www.coursera.org/" target="\_blank">Coursera</a> / <a href="https://www.udacity.com/" target="\_blank">Udacity</a> / <a href="https://www.udemy.com" target="\_blank">Udemy</a> / <a href="https://www.elementsofai.com/" target="\_blank">Elements of AI</a> / &#8230;&#8203;</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Connecting</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.meetup.com/" target="\_blank">Meetups</a> (e.g., search for PyData)</p>
</li>
<li>
<p><a href="https://pydata.org/" target="\_blank">PyData Conference</a> (e.g., in <a href="https://berlin.pydata.org/" target="\_blank">Berlin</a>)</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Getting your hands dirty</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.kaggle.com/" target="\_blank">Kaggle Competitions</a></p>
</li>
<li>
<p><a href="https://solveforgood.org/" target="\_blank">Data Science for Social Good</a></p>
</li>
<li>
<p><a href="https://correlaid.org/" target="\_blank">CorrelAid</a></p>
</li>
<li>
<p><a href="https://www.wildlife.ai/" target="\_blank">Wildlife Conservation</a></p>
</li>
<li>
<p><a href="https://www.climatechange.ai/" target="\_blank">Climate Change</a></p>
</li>
<li>
<p><a href="https://datasetsearch.research.google.com/" target="\_blank">Google Dataset Search</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<style type="text/css">
  footer{margin:0;padding:0;border:0;font:inherit;vertical-align:baseline;display:block}
  footer p{color:#f2f2f2}a{text-decoration:none;color:#0F79D0;text-shadow:none;transition:color 0.5s ease;transition:text-shadow 0.5s ease;-webkit-transition:color 0.5s ease;-webkit-transition:text-shadow 0.5s ease;-moz-transition:color 0.5s ease;-moz-transition:text-shadow 0.5s ease;-o-transition:color 0.5s ease;-o-transition:text-shadow 0.5s ease;-ms-transition:color 0.5s ease;-ms-transition:text-shadow 0.5s ease}
  footer a{color:#F2F2F2;text-decoration:underline}
  #footer{background:#212121}
  .outer{width:100%}.inner{position:relative;max-width:640px;padding:0px 0px;margin:0 auto}
 .toc-current{font-weight: bold;} .toc-root{font-family: "Source Sans Pro",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}
</style>

<!-- FOOTER  -->
<div id="footer" class="outer">
  <footer class="inner">
    <p><b>Book/Course Feedback: </b> <a href="https://forms.gle/Ccv5h5zQxwPjWtCS7" target="_blank" rel="nofollow">Full Feedback Survey</a> or <a href="https://forms.gle/qK8T5ALzgpiZaxd49" target="_blank" rel="nofollow">Short Comment</a><br></p>

    <p>Find me on <a href="https://github.com/cod3licious/" target="_blank" rel="nofollow">GitHub</a> and <a href="https://www.linkedin.com/in/franziska-horn/" target="_blank" rel="nofollow">LinkedIn</a><br>
      <a href="../index.html">Home</a> ~ <a href="mailto:hey@franziskahorn.de?Subject=ML%20book" target="_blank" rel="nofollow">Contact</a> ~ <a href="../impressum.html">Impressum</a></p>

      <!-- CC license -->
   <p xmlns:cc="http://creativecommons.org/ns#" >This work is licensed under <a href="https://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""></a></p>
  </footer>
</div>
</body>
</html>